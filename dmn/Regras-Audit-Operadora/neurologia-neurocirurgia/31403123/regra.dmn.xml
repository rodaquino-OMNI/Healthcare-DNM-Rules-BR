<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             id="Definitions_31403123" name="Neurolise_externa" targetNamespace="http://camunda.org/schema/1.0/dmn">
  <!--
    TUSS 31403123 - Exploração cirúrgica de nervo (neurólise externa)
    Versao: 3.1.0-LEAN-TIER2 (2026-02-08)
    Enriquecido com: Input 6 (ultimoProcedimentoDias), DUP/DOC/ESC waste rules

    Indicacoes Clinicas:
    - Compressão nervosa pós-traumática com déficit progressivo
    - Neuropatia compressiva refratária a tratamento conservador (>6 meses)
    - Neuroma em continuidade sintomático

    Referencias: SBNC 2024, RN ANS 465/2021
  -->
  <decision id="Decision_31403123" name="Indicacao para Neurolise externa">
    <decisionTable id="DecisionTable_31403123" hitPolicy="FIRST">
      <input id="Input_1" label="Diagnostico Principal">
        <inputExpression id="InputExpression_1" typeRef="string"><text>diagnosticoPrincipal</text></inputExpression>
        <inputValues id="InputValues_1">
          <text>"compressao_nervosa","neuroma","neuropatia_compressiva","outra"</text>
        </inputValues>
      </input>
      <input id="Input_2" label="Tempo Tratamento Conservador (meses)">
        <inputExpression id="InputExpression_2" typeRef="number"><text>tempoTratamentoConservador</text></inputExpression>
      </input>
      <input id="Input_3" label="ENMG Confirma Lesao">
        <inputExpression id="InputExpression_3" typeRef="boolean"><text>enmgConfirmaLesao</text></inputExpression>
      </input>
      <input id="Input_4" label="Laudo Neurologico">
        <inputExpression id="InputExpression_4" typeRef="boolean"><text>laudoNeurologico</text></inputExpression>
      </input>
      <input id="Input_5" label="Classificacao Evidencia">
        <inputExpression id="InputExpression_5" typeRef="string"><text>classificacaoEvidencia</text></inputExpression>
        <inputValues id="InputValues_5">
          <text>"Classe I","Classe IIa","Classe IIb","Classe III"</text>
        </inputValues>
      </input>
      <input id="Input_6" label="Exames Comprobatorios">
        <inputExpression id="InputExpression_6" typeRef="string"><text>examesComprobatorios</text></inputExpression>
        <inputValues id="InputValues_6">
          <text>"ENMG","RNM","USG","Completo","Parcial","SemImagem","Sem exames"</text>
        </inputValues>
      </input>
      <input id="Input_ultimoProcedimentoDias" label="Dias Desde Ultimo Procedimento" camunda:inputVariable="ultimoProcedimentoDias">
        <inputExpression id="InputExpression_ultimoProcedimentoDias" typeRef="integer">
          <text>ultimoProcedimentoDias</text>
        </inputExpression>
      </input>
      <output id="Output_1" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_1"><text>"Aprovado","Reprovado","Pendente"</text></outputValues>
      </output>
      <output id="Output_2" label="Observacao" name="observacao" typeRef="string"/>
      <output id="Output_3" label="Fundamentacao" name="fundamentacao" typeRef="string"/>
      <!-- Output 4: Alertas de Desperdicio -->
      <output id="Output_4" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues>
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_5" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues>
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- CONTRAINDICATIONS -->
      <rule id="Rule_Contraindicacao_SemENMG">
        <inputEntry id="IE_1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_1_3"><text>false</text></inputEntry>
        <inputEntry id="IE_1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_1_5"><text>-</text></inputEntry>
        <inputEntry id="IE_1_6"><text>-</text></inputEntry>
        <inputEntry id="IE_1_7"><text>-</text></inputEntry>
        <outputEntry id="OE_1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_1_2"><text>"ENMG não confirma lesão nervosa. Exame eletrofisiológico obrigatório."</text></outputEntry>
        <outputEntry id="OE_1_3"><text>"SBNC 2024"</text></outputEntry>
        <outputEntry id="OE_Rule_Contraindicacao_SemENMG_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Rule_Contraindicacao_SemENMG_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- WASTE RULES -->
      <rule id="Rule_31403123_DUP_NervoPerif">
        <description>DUP: Cirurgia de nervo periferico repetida em menos de 180 dias</description>
        <inputEntry id="IE_31403123_DUP_1"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DUP_2"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DUP_3"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DUP_4"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DUP_5"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DUP_6"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DUP_7"><text>&lt; 180</text></inputEntry>
        <outputEntry id="OE_31403123_DUP_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_31403123_DUP_2"><text>"Cirurgia de nervo periferico repetida em menos de 180 dias. Aguardar recuperacao neural"</text></outputEntry>
        <outputEntry id="OE_31403123_DUP_3"><text>"SBN 2023 - Intervalo minimo 180 dias para reavaliar neurolise/neurorrafia"</text></outputEntry>
        <outputEntry id="OE_31403123_DUP_4"><text>"DUP"</text></outputEntry>
        <outputEntry id="OE_31403123_DUP_5"><text>"AGUARDAR_PRAZO"</text></outputEntry>
      </rule>

      <rule id="Rule_31403123_DOC_ENMG">
        <description>DOC: Cirurgia sem ENMG previa</description>
        <inputEntry id="IE_31403123_DOC_1"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DOC_2"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DOC_3"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DOC_4"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_DOC_5"><text>"Classe I","Classe IIa"</text></inputEntry>
        <inputEntry id="IE_31403123_DOC_6"><text>"SemImagem","Sem exames"</text></inputEntry>
        <inputEntry id="IE_31403123_DOC_7"><text>-</text></inputEntry>
        <outputEntry id="OE_31403123_DOC_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_31403123_DOC_2"><text>"ENMG obrigatoria para documentar lesao neural antes de cirurgia"</text></outputEntry>
        <outputEntry id="OE_31403123_DOC_3"><text>"SBN 2023, ANS RN 465/2021 - ENMG obrigatoria para cirurgia de nervo periferico"</text></outputEntry>
        <outputEntry id="OE_31403123_DOC_4"><text>"DOC"</text></outputEntry>
        <outputEntry id="OE_31403123_DOC_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_31403123_ESC_Conservador">
        <description>ESC: Cirurgia sem tratamento conservador previo</description>
        <inputEntry id="IE_31403123_ESC_1"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_ESC_2"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_ESC_3"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_ESC_4"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_ESC_5"><text>"Classe IIa","Classe IIb"</text></inputEntry>
        <inputEntry id="IE_31403123_ESC_6"><text>-</text></inputEntry>
        <inputEntry id="IE_31403123_ESC_7"><text>-</text></inputEntry>
        <outputEntry id="OE_31403123_ESC_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_31403123_ESC_2"><text>"Documentar falha de tratamento conservador (imobilizacao, fisioterapia, corticoide)"</text></outputEntry>
        <outputEntry id="OE_31403123_ESC_3"><text>"SBN 2023, AAN 2024 - Tratamento conservador 4-12 semanas antes de cirurgia"</text></outputEntry>
        <outputEntry id="OE_31403123_ESC_4"><text>"ESC"</text></outputEntry>
        <outputEntry id="OE_31403123_ESC_5"><text>"SUGERIR_ALTERNATIVA"</text></outputEntry>
      </rule>

      <!-- APPROVALS -->
      <rule id="Rule_Aprovado_CompressaoNervosa">
        <inputEntry id="IE_2_1"><text>"compressao_nervosa","neuropatia_compressiva"</text></inputEntry>
        <inputEntry id="IE_2_2"><text>&gt;= 6</text></inputEntry>
        <inputEntry id="IE_2_3"><text>true</text></inputEntry>
        <inputEntry id="IE_2_4"><text>true</text></inputEntry>
        <inputEntry id="IE_2_5"><text>-</text></inputEntry>
        <inputEntry id="IE_2_6"><text>-</text></inputEntry>
        <inputEntry id="IE_2_7"><text>-</text></inputEntry>
        <outputEntry id="OE_2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_2_2"><text>"Compressão nervosa confirmada por ENMG, refratária a 6+ meses de tratamento. Neurólise externa indicada."</text></outputEntry>
        <outputEntry id="OE_2_3"><text>"SBNC 2024 + RN ANS 465/2021"</text></outputEntry>
        <outputEntry id="OE_Rule_Aprovado_CompressaoNervosa_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_Aprovado_CompressaoNervosa_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- FALLBACK RULE -->
      <rule id="Rule_Fallback_31403123">
        <inputEntry id="IE_3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_3_5"><text>-</text></inputEntry>
        <inputEntry id="IE_3_6"><text>-</text></inputEntry>
        <inputEntry id="IE_3_7"><text>-</text></inputEntry>
        <outputEntry id="OE_3_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_3_2"><text>"Requer avaliação por neurocirurgião e auditor médico."</text></outputEntry>
        <outputEntry id="OE_3_3"><text>"Análise caso a caso conforme RN ANS 465/2021"</text></outputEntry>
        <outputEntry id="OE_Rule_Fallback_31403123_4"><text>"DOC"</text></outputEntry>
        <outputEntry id="OE_Rule_Fallback_31403123_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
