<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_40808270"
             name="Teste Ergometrico/Esforco"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    TUSS 40808270 - Teste Ergometrico/Esforco
    Versao: 3.0.0 (2026-02-07)
    Especialidade: Cardiologia
    Categoria: Metodos Diagnosticos Cardiovasculares

    Indicacoes Clinicas (DUT ANS 2024):
    - Diagnostico de doenca arterial coronaria (DAC) em probabilidade intermediaria (15-85%)
    - Avaliacao capacidade funcional e resposta ao exercicio
    - Investigacao de arritmias induzidas por esforco
    - Pos-revascularizacao miocardica (>2 anos ou sintomas novos)
    - Pre-operatorio cirurgias nao cardiacas em pacientes risco intermediario
    - Prescricao de exercicio fisico em pacientes com fatores de risco cardiovascular

    Contraindicacoes:
    - ECG basal que impede interpretacao ST: BRE completo, Sindrome WPW, marca-passo ventricular
    - DAC com probabilidade pre-teste alta (>85%) - indicar cateterismo ou imagem direto
    - IAM agudo <48 horas
    - Angina instavel
    - Arritmias ventriculares complexas nao controladas
    - Estenose aortica severa sintomatica
    - Insuficiencia cardiaca descompensada

    Documentacao Obrigatoria:
    - Relatorio clinico detalhado com indicacao do teste
    - ECG de repouso 12 derivacoes recente (<30 dias)
    - Historico de fatores de risco cardiovascular
    - Medicacoes em uso (especialmente betabloqueadores, nitratos)
    - Avaliacao de capacidade de exercicio (funcional)

    Referencias Normativas:
    - SBC Diretriz Teste Ergometrico 2023
    - ESC Guidelines CCS 2019 (Chronic Coronary Syndromes)
    - ACC/AHA Exercise Testing Guidelines 2021
    - RDC ANS n.465/2021 Art.17 - Cobertura obrigatoria
  -->

  <decision id="Decision_40808270" name="Criterios de Autorizacao - Teste Ergometrico">
    <decisionTable id="DecisionTable_40808270" hitPolicy="FIRST">

      <!-- Input 1: Condicao Paciente -->
      <input id="Input_condicaoPaciente" label="Condicao Paciente">
        <inputExpression id="InputExpr_condicaoPaciente" typeRef="string">
          <text>condicaoPaciente</text>
        </inputExpression>
        <inputValues id="InputValues_condicaoPaciente">
          <text>"DAC_Probabilidade_Intermediaria","Avaliacao_Capacidade_Funcional","Pre_Exercicio_Fisico","Pos_ICP_CABG","Arritmia_Esforco"</text>
        </inputValues>
      </input>

      <!-- Input 2: Historico Clinico -->
      <input id="Input_historicoClinico" label="Historico Clinico">
        <inputExpression id="InputExpr_historicoClinico" typeRef="string">
          <text>historicoClinico</text>
        </inputExpression>
        <inputValues id="InputValues_historicoClinico">
          <text>"Assintomatico_Risco","Dor_Toracica_Atipica","Pos_Revascularizacao","Avaliacao_Terapeutica","Pre_Cirurgia_Nao_Cardiaca"</text>
        </inputValues>
      </input>

      <!-- Input 3: ECG Basal -->
      <input id="Input_ecgBasal" label="ECG Basal">
        <inputExpression id="InputExpr_ecgBasal" typeRef="string">
          <text>ecgBasal</text>
        </inputExpression>
        <inputValues id="InputValues_ecgBasal">
          <text>"Normal","BRE","WPW","Marca_Passo","Alteracao_ST_Basal"</text>
        </inputValues>
      </input>

      <!-- Input 4: Probabilidade Pre-Teste DAC -->
      <input id="Input_probabilidadePreTesteDac" label="Probabilidade Pre-Teste DAC">
        <inputExpression id="InputExpr_probabilidadePreTesteDac" typeRef="string">
          <text>probabilidadePreTesteDac</text>
        </inputExpression>
        <inputValues id="InputValues_probabilidadePreTesteDac">
          <text>"Baixa_15","Intermediaria_15_85","Alta_85","Nao_Aplicavel"</text>
        </inputValues>
      </input>

      <!-- Input 5: Capaz Exercicio -->
      <input id="Input_capazExercicio" label="Capaz de Realizar Exercicio">
        <inputExpression id="InputExpr_capazExercicio" typeRef="boolean">
          <text>capazExercicio</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao Legal/Tecnica" name="fundamentacao" typeRef="string" />
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdício" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <output id="Output_acaoRecomendada" label="Ação Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- ============================================== -->
      <!-- CONTRAINDICATION RULES (FIRST PRIORITY)       -->
      <!-- ============================================== -->

      <rule id="Rule_40808270_Contraindicacao_1">
        <description>Contraindicacao - ECG basal impede interpretacao segmento ST (BRE, WPW, marca-passo)</description>
        <inputEntry id="IE_Contra1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra1_3"><text>"BRE","WPW","Marca_Passo"</text></inputEntry>
        <inputEntry id="IE_Contra1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Contra1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Contra1_2"><text>"ECG basal impede interpretacao segmento ST - indicar metodo imagem (cintilografia miocardica ou ecocardiograma de estresse)"</text></outputEntry>
        <outputEntry id="OE_Contra1_3"><text>"SBC Teste Ergometrico 2023 - BRE completo, WPW e marca-passo ventricular impedem analise ST, preferir imagem para isquemia"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Contraindicacao_1_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Contraindicacao_1_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_40808270_Contraindicacao_2">
        <description>Contraindicacao - DAC alta probabilidade (>85%) indicar cateterismo ou imagem direto</description>
        <inputEntry id="IE_Contra2_1"><text>"DAC_Probabilidade_Intermediaria"</text></inputEntry>
        <inputEntry id="IE_Contra2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra2_4"><text>"Alta_85"</text></inputEntry>
        <inputEntry id="IE_Contra2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Contra2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Contra2_2"><text>"DAC alta probabilidade (>85%) - pular teste ergometrico e indicar cateterismo direto ou imagem (angiotomografia/cintilografia)"</text></outputEntry>
        <outputEntry id="OE_Contra2_3"><text>"ESC CCS 2019 - Probabilidade alta >85% cateterismo direto Classe I, teste ergometrico tem baixo valor incremental"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Contraindicacao_2_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Contraindicacao_2_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APPROVAL RULES (AFTER CONTRAINDICATIONS)      -->
      <!-- ============================================== -->

      <rule id="Rule_40808270_Aprovacao_1">
        <description>Aprovacao - DAC probabilidade intermediaria 15-85% com ECG normal - Classe I</description>
        <inputEntry id="IE_Aprov1_1"><text>"DAC_Probabilidade_Intermediaria"</text></inputEntry>
        <inputEntry id="IE_Aprov1_2"><text>"Dor_Toracica_Atipica"</text></inputEntry>
        <inputEntry id="IE_Aprov1_3"><text>"Normal"</text></inputEntry>
        <inputEntry id="IE_Aprov1_4"><text>"Intermediaria_15_85"</text></inputEntry>
        <inputEntry id="IE_Aprov1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov1_2"><text>"Teste ergometrico indicado para DAC com probabilidade intermediaria 15-85% - recomendacao Classe I (nivel evidencia A)"</text></outputEntry>
        <outputEntry id="OE_Aprov1_3"><text>"ACC/AHA 2021 - Teste ergometrico apropriado para probabilidade intermediaria com ECG basal normal e capacidade de exercicio preservada"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_1_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_1_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_40808270_Aprovacao_2">
        <description>Aprovacao - Pos-revascularizacao miocardica >2 anos ou sintomas novos - Classe IIa</description>
        <inputEntry id="IE_Aprov2_1"><text>"Pos_ICP_CABG"</text></inputEntry>
        <inputEntry id="IE_Aprov2_2"><text>"Pos_Revascularizacao"</text></inputEntry>
        <inputEntry id="IE_Aprov2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov2_2"><text>"Teste ergometrico indicado pos-revascularizacao miocardica >2 anos ou sintomas novos - recomendacao Classe IIa (nivel evidencia C)"</text></outputEntry>
        <outputEntry id="OE_Aprov2_3"><text>"SBC Teste Ergometrico 2023 - Razoavel pos-revascularizacao >2 anos ou novos sintomas para avaliar isquemia residual ou progressao doenca"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_2_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_2_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_40808270_Aprovacao_3">
        <description>Aprovacao - Avaliacao capacidade funcional objetiva - Classe I</description>
        <inputEntry id="IE_Aprov3_1"><text>"Avaliacao_Capacidade_Funcional"</text></inputEntry>
        <inputEntry id="IE_Aprov3_2"><text>"Avaliacao_Terapeutica"</text></inputEntry>
        <inputEntry id="IE_Aprov3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov3_4"><text>"Nao_Aplicavel"</text></inputEntry>
        <inputEntry id="IE_Aprov3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov3_2"><text>"Teste ergometrico indicado avaliacao capacidade funcional objetiva - recomendacao Classe I (nivel evidencia B)"</text></outputEntry>
        <outputEntry id="OE_Aprov3_3"><text>"ESC CCS 2019 - Teste ergometrico Classe I para avaliacao capacidade funcional objetiva e resposta hemodinamica ao exercicio"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_3_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_3_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_40808270_Aprovacao_4">
        <description>Aprovacao - Pre-exercicio fisico em sedentarios com fatores de risco - Classe IIa</description>
        <inputEntry id="IE_Aprov4_1"><text>"Pre_Exercicio_Fisico"</text></inputEntry>
        <inputEntry id="IE_Aprov4_2"><text>"Assintomatico_Risco"</text></inputEntry>
        <inputEntry id="IE_Aprov4_3"><text>"Normal"</text></inputEntry>
        <inputEntry id="IE_Aprov4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov4_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov4_2"><text>"Teste ergometrico indicado pre-exercicio fisico vigoroso em sedentarios com fatores risco cardiovascular - recomendacao Classe IIa (nivel evidencia C)"</text></outputEntry>
        <outputEntry id="OE_Aprov4_3"><text>"SBC Teste Ergometrico 2023 - Razoavel pre-exercicio em sedentarios >40 anos com multiplos fatores risco para estratificar seguranca"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_4_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_4_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_40808270_Aprovacao_5">
        <description>Aprovacao - Pre-operatorio cirurgia nao cardiaca risco intermediario - Classe IIa</description>
        <inputEntry id="IE_Aprov5_1"><text>"DAC_Probabilidade_Intermediaria"</text></inputEntry>
        <inputEntry id="IE_Aprov5_2"><text>"Pre_Cirurgia_Nao_Cardiaca"</text></inputEntry>
        <inputEntry id="IE_Aprov5_3"><text>"Normal"</text></inputEntry>
        <inputEntry id="IE_Aprov5_4"><text>"Intermediaria_15_85"</text></inputEntry>
        <inputEntry id="IE_Aprov5_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov5_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov5_2"><text>"Teste ergometrico indicado pre-operatorio cirurgia nao cardiaca risco intermediario - recomendacao Classe IIa (nivel evidencia B)"</text></outputEntry>
        <outputEntry id="OE_Aprov5_3"><text>"ACC/AHA 2021 - Teste ergometrico razoavel pre-operatorio em pacientes com capacidade funcional desconhecida ou <4 METs"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_5_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_40808270_Aprovacao_5_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- FALLBACK RULE - Casos nao cobertos            -->
      <!-- ============================================== -->
      <rule id="Rule_Fallback_40808270">
        <description>Regra padrao - Casos nao cobertos requerem analise manual por auditor medico especializado em cardiologia</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Dados incompletos para decisao automatizada - documentar indicacao clinica, ECG basal 12 derivacoes, capacidade de exercicio e fatores de risco cardiovascular"</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Documentacao obrigatoria completa: relatorio clinico detalhado, ECG repouso 12 derivacoes recente (<30 dias), historico fatores risco, medicacoes em uso, avaliacao funcional. Auditor medico cardiologista acionado para analise individualizada."</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Fallback_40808270_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Fallback_40808270_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
