<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20180521/DC/"
             id="Definitions_40402150"
             name="Plasma quarentenado"
             targetNamespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ═══════════════════════════════════════════════════════════════════════════
    TUSS 40402150 - Plasma quarentenado
    Versao: 3.0.0 (2026-02-07)
    Especialidade: Hemoterapia / THERAPEUTIC_INTERVENTIONS

    ═══════════════════════════════════════════════════════════════════════════
    INDICACOES (Quando APROVAR):
    ═══════════════════════════════════════════════════════════════════════════
    - Diagnóstico funcional/base documentado
    - Objetivo terapêutico/indicação clínica especificado
    - Documentação técnica completa
    - Critérios clínicos atendidos conforme protocolo

    ═══════════════════════════════════════════════════════════════════════════
    CONTRAINDICACOES (Quando REPROVAR):
    ═══════════════════════════════════════════════════════════════════════════
    - Ausência de diagnóstico documentado
    - Indicação clínica não especificada ou inadequada
    - Documentação técnica incompleta
    - Critérios de segurança não atendidos

    ═══════════════════════════════════════════════════════════════════════════
    REFERENCIAS NORMATIVAS:
    ═══════════════════════════════════════════════════════════════════════════
    - ANVISA RDC 34/2014, TUSS 2024
    - Diretrizes técnicas da especialidade
    ═══════════════════════════════════════════════════════════════════════════
  -->

  <decision id="Decision_40402150" name="Indicação para Plasma quarentenado">
    <decisionTable id="DecisionTable_40402150" hitPolicy="FIRST">

      <!-- INPUT DEFINITIONS -->

      <input id="Input_1" label="Diagnóstico Base (CID-10)">
        <inputExpression id="InputExpression_1" typeRef="string">
          <text>diagnosticoBase</text>
        </inputExpression>
      </input>

      <input id="Input_2" label="Tipo de Hemocomponente">
        <inputExpression id="InputExpression_2" typeRef="string">
          <text>tipoHemocomponente</text>
        </inputExpression>
      </input>

      <input id="Input_3" label="Indicação Transfusional">
        <inputExpression id="InputExpression_3" typeRef="string">
          <text>indicacaoTransfusional</text>
        </inputExpression>
      </input>

      <input id="Input_4" label="Provas de Compatibilidade Realizadas">
        <inputExpression id="InputExpression_4" typeRef="boolean">
          <text>provasCompatibilidade</text>
        </inputExpression>
      </input>

      <!-- OUTPUT DEFINITIONS -->
      <output id="Output_1" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_1">
          <text>"Aprovado", "Reprovado", "Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_2" label="Observacao" name="observacao" typeRef="string"/>

      <output id="Output_3" label="Fundamentacao" name="fundamentacao" typeRef="string"/>
      <!-- Output 4: Alertas de Desperdicio -->
      <output id="Output_4" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues>
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_5" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues>
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- CONTRAINDICATION RULES -->

      <rule id="Rule_Contraindicacao_1">
        <description>Ausência de diagnóstico base</description>
        <inputEntry id="InputEntry_C1_1">
          <text>"Ausente", "Nao Documentado"</text>
        </inputEntry>
        <inputEntry id="InputEntry_C1_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_C1_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_C1_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_C1_1">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_C1_2">
          <text>"Diagnóstico base ausente. CID-10 obrigatório para hemoterapia."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_C1_3">
          <text>"ANVISA RDC 34/2014 Art. 124 - Diagnóstico obrigatório"</text>
        </outputEntry>
        <outputEntry id="OE_Rule_Contraindicacao_1_4"><text>"DOC"</text></outputEntry>
        <outputEntry id="OE_Rule_Contraindicacao_1_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraindicacao_2">
        <description>Tipo de hemocomponente incompatível com indicação</description>
        <inputEntry id="InputEntry_C2_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_C2_2">
          <text>"Incompativel", "Nao Especificado"</text>
        </inputEntry>
        <inputEntry id="InputEntry_C2_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_C2_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_C2_1">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_C2_2">
          <text>"Tipo de hemocomponente incompatível ou não especificado."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_C2_3">
          <text>"ANVISA RDC 34/2014 - Compatibilidade obrigatória"</text>
        </outputEntry>
        <outputEntry id="OE_Rule_Contraindicacao_2_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Rule_Contraindicacao_2_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraindicacao_3">
        <description>Provas de compatibilidade não realizadas</description>
        <inputEntry id="InputEntry_C3_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_C3_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_C3_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_C3_4">
          <text>false</text>
        </inputEntry>
        <outputEntry id="OutputEntry_C3_1">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_C3_2">
          <text>"Provas de compatibilidade pré-transfusional obrigatórias."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_C3_3">
          <text>"ANVISA RDC 34/2014 Art. 126 - Provas obrigatórias"</text>
        </outputEntry>
        <outputEntry id="OE_Rule_Contraindicacao_3_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Rule_Contraindicacao_3_5"><text>"NEGAR"</text></outputEntry>
      </rule>


      <!-- APPROVAL RULES -->

      <rule id="Rule_Aprovado_1">
        <description>Transfusão com documentação completa</description>
        <inputEntry id="InputEntry_A1_1">
          <text>not("Ausente"), not("Nao Documentado")</text>
        </inputEntry>
        <inputEntry id="InputEntry_A1_2">
          <text>not("Incompativel"), not("Nao Especificado")</text>
        </inputEntry>
        <inputEntry id="InputEntry_A1_3">
          <text>not("Ausente")</text>
        </inputEntry>
        <inputEntry id="InputEntry_A1_4">
          <text>true</text>
        </inputEntry>
        <outputEntry id="OutputEntry_A1_1">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A1_2">
          <text>"Transfusão autorizada. Critérios ANVISA atendidos."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A1_3">
          <text>"ANVISA RDC 34/2014 - Procedimento hemoterapêutico autorizado"</text>
        </outputEntry>
        <outputEntry id="OE_Rule_Aprovado_1_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_Aprovado_1_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_2">
        <description>Critérios básicos de indicação atendidos</description>
        <inputEntry id="InputEntry_A2_1">
          <text>not("Ausente")</text>
        </inputEntry>
        <inputEntry id="InputEntry_A2_2">
          <text>not("Incompativel")</text>
        </inputEntry>
        <inputEntry id="InputEntry_A2_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_A2_4">
          <text>true</text>
        </inputEntry>
        <outputEntry id="OutputEntry_A2_1">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A2_2">
          <text>"Autorizado. Indicação transfusional documentada."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A2_3">
          <text>"ANVISA RDC 34/2014 - Critérios mínimos atendidos"</text>
        </outputEntry>
        <outputEntry id="OE_Rule_Aprovado_2_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_Aprovado_2_5"><text>"APROVAR"</text></outputEntry>
      </rule>


      <!-- FALLBACK RULE -->
      <rule id="Rule_Fallback_40402150">
        <description>Regra padrão - Criterios automaticos nao satisfeitos</description>
        <inputEntry id="InputEntry_F_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_F_1">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_2">
          <text>"Aguardando avaliação manual por auditor médico. Verificar critérios clínicos e documentação."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_3">
          <text>"Análise manual necessária - critérios automáticos não satisfeitos"</text>
        </outputEntry>
        <outputEntry id="OE_Rule_Fallback_40402150_4"><text>"DOC"</text></outputEntry>
        <outputEntry id="OE_Rule_Fallback_40402150_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram id="DMNDiagram_40402150">
      <dmndi:DMNShape id="DMNShape_Decision_40402150" dmnElementRef="Decision_40402150">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>

</definitions>