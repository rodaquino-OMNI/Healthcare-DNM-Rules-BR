<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_30602050"
             name="Reconstrução Mamária Pós-Mastectomia"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    TUSS 30602050 - Reconstrução mamária pós-mastectomia
    Versao: 3.0.0 (2026-02-07)
    Especialidade: Cirurgia Plastica - Reconstrução
    Categoria: Procedimentos Cirurgicos Reparadores

    Indicacoes Clinicas (Lei 12.802/2013 + DUT ANS 2024):
    - Reconstrução imediata ou tardia apos mastectomia por cancer de mama (C50)
    - Reconstrução apos mastectomia profilatica em portador BRCA+
    - Direito garantido por Lei 12.802/2013 (cobertura obrigatoria)
    - Inclui simetrização da mama contralateral quando necessario

    Contraindicacoes Absolutas:
    - CID-10 nao oncologica e nao BRCA+ (apenas estetica)
    - Paciente com risco cirurgico ASA V
    - Ausencia de documentacao medica obrigatoria
    - Infeccao ativa da regiao mamaria

    Documentacao Obrigatoria:
    - Diagnostico confirmado (CID-10 C50.x ou Z40.x)
    - Laudo de indicacao cirurgica com historico oncologico
    - Classificacao de risco cirurgico (ASA I-IV)
    - Termo de consentimento informado assinado
    - Fotografias clinicas pre-operatorias

    Referencias Normativas:
    - Lei 12.802/2013 - Reconstrução Mamária Obrigatoria
    - DUT ANS 2024 - Diretrizes de Utilizacao para Procedimentos Cirurgicos
    - RN 465/2021 - Rol de Procedimentos e Eventos em Saude
    - SBCP 2024 - Reconstrução Mamária Oncologica
  -->

  <decision id="Decision_30602050" name="Criterios de Autorizacao - Reconstrução Mamária Pós-Mastectomia">
    <decisionTable id="DecisionTable_30602050" hitPolicy="FIRST">

      <!-- Input 1: Diagnostico CID-10 -->
      <input id="Input_diagnostico" label="Diagnostico CID-10">
        <inputExpression id="InputExpr_diagnostico" typeRef="string">
          <text>diagnostico</text>
        </inputExpression>
        <inputValues id="InputValues_diagnostico">
          <text>"C50.0","C50.1","C50.2","C50.3","C50.4","C50.5","C50.6","C50.8","C50.9","D05.0","D05.1","Z40.0","Z40.1"</text>
        </inputValues>
      </input>

      <!-- Input 2: Tipo de Mastectomia -->
      <input id="Input_tipoMastectomia" label="Tipo de Mastectomia Realizada">
        <inputExpression id="InputExpr_tipoMastectomia" typeRef="string">
          <text>tipoMastectomia</text>
        </inputExpression>
        <inputValues id="InputValues_tipoMastectomia">
          <text>"total","parcial","profilatica","nao_aplicavel"</text>
        </inputValues>
      </input>

      <!-- Input 3: Tratamento Oncologico Completo -->
      <input id="Input_tratOncol" label="Tratamento Oncologico Completo (se aplicavel)">
        <inputExpression id="InputExpr_tratOncol" typeRef="boolean">
          <text>tratamentoOncologicoCompleto</text>
        </inputExpression>
      </input>

      <!-- Input 4: Risco Cirurgico (ASA) -->
      <input id="Input_riscoCirurgico" label="Classificacao de Risco Cirurgico (ASA)">
        <inputExpression id="InputExpr_riscoCirurgico" typeRef="string">
          <text>riscoCirurgico</text>
        </inputExpression>
        <inputValues id="InputValues_riscoCirurgico">
          <text>"ASA_I","ASA_II","ASA_III","ASA_IV","ASA_V"</text>
        </inputValues>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao Cirurgica Anexado">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao Legal/Tecnica" name="fundamentacao" typeRef="string" />

      <output id="Output_alertasDesperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues>
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <output id="Output_acaoRecomendada" name="acaoRecomendada" typeRef="string">
        <outputValues>
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ============================================== -->
      <!-- CONTRAINDICATION RULES (FIRST PRIORITY)       -->
      <!-- ============================================== -->

      <rule id="Rule_30602050_Contraindicacao_CIDNaoOncol">
        <description>Contraindicacao - CID nao oncologica (exclusivamente estetica)</description>
        <inputEntry id="IE_Contra1_1"><text>not(starts with(diagnostico, "C50") or starts with(diagnostico, "D05") or starts with(diagnostico, "Z40"))</text></inputEntry>
        <inputEntry id="IE_Contra1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Contra1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Contra1_2"><text>"Reconstrução mamária exclusivamente estetica nao eh coberta. Lei 12.802/2013 restringe a casos oncologicos ou profilaticos BRCA+."</text></outputEntry>
        <outputEntry id="OE_Contra1_3"><text>"Lei 12.802/2013 Art. 1º - Cobertura restrita a oncologia e profilaxia"</text></outputEntry>
      </rule>

      <rule id="Rule_30602050_Contraindicacao_RiscoProibitivo">
        <description>Contraindicacao - Risco cirurgico ASA V</description>
        <inputEntry id="IE_Contra2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra2_4"><text>"ASA_V"</text></inputEntry>
        <inputEntry id="IE_Contra2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Contra2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Contra2_2"><text>"Paciente ASA V apresenta risco cirurgico proibitivo. Reconstrução mamária contraindicada exceto extrema urgencia."</text></outputEntry>
        <outputEntry id="OE_Contra2_3"><text>"ASA Classification Guidelines - Risco Cirurgico Proibitivo"</text></outputEntry>
      </rule>

      <rule id="Rule_30602050_Contraindicacao_SemLaudo">
        <description>Contraindicacao - Laudo de indicacao ausente</description>
        <inputEntry id="IE_Contra3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Contra3_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Contra3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Contra3_2"><text>"Laudo de indicacao cirurgica eh documentacao obrigatoria. Deve descrever historico oncologico, tipo de mastectomia e razao clinica para reconstrução."</text></outputEntry>
        <outputEntry id="OE_Contra3_3"><text>"RN 465/2021 Art. 5 - Documentacao Minima Obrigatoria"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APPROVAL RULES (AFTER CONTRAINDICATIONS)      -->
      <!-- ============================================== -->

      <rule id="Rule_30602050_Aprovacao_Oncologica">
        <description>Aprovacao - Reconstrução apos mastectomia oncologica</description>
        <inputEntry id="IE_Aprov1_1"><text>starts with(diagnostico, "C50") or starts with(diagnostico, "D05")</text></inputEntry>
        <inputEntry id="IE_Aprov1_2"><text>"total","parcial"</text></inputEntry>
        <inputEntry id="IE_Aprov1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov1_4"><text>"ASA_I","ASA_II","ASA_III","ASA_IV"</text></inputEntry>
        <inputEntry id="IE_Aprov1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov1_2"><text>"Reconstrução mamária apos mastectomia oncologica. Direito garantido por Lei 12.802/2013. Pode ser imediata ou tardia conforme caso clinico."</text></outputEntry>
        <outputEntry id="OE_Aprov1_3"><text>"Lei 12.802/2013 Art. 1º e 2º - Reconstrução Mamária Obrigatoria"</text></outputEntry>
      </rule>

      <rule id="Rule_30602050_Aprovacao_Profilatica">
        <description>Aprovacao - Reconstrução apos mastectomia profilatica BRCA+</description>
        <inputEntry id="IE_Aprov2_1"><text>starts with(diagnostico, "Z40")</text></inputEntry>
        <inputEntry id="IE_Aprov2_2"><text>"profilatica"</text></inputEntry>
        <inputEntry id="IE_Aprov2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov2_4"><text>"ASA_I","ASA_II","ASA_III"</text></inputEntry>
        <inputEntry id="IE_Aprov2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov2_2"><text>"Reconstrução apos mastectomia profilatica (BRCA1/BRCA2 positivo). Direito garantido por Lei 12.802/2013 para reducao de risco."</text></outputEntry>
        <outputEntry id="OE_Aprov2_3"><text>"Lei 12.802/2013 - Cobertura para Mastectomia Profilatica"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- FALLBACK RULE - Casos nao cobertos            -->
      <!-- ============================================== -->
      <rule id="Rule_Fallback_30602050">
        <description>Regra padrao - Casos nao cobertos requerem analise manual por auditor medico especializado</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso requer analise manual por auditor medico especializado - criterios de autorizacao automatica nao foram atendidos."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Processo de auditoria medica especializada conforme RN 428/2017"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
