<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             id="Definitions_30805090"
             name="Procedimento Anatomopatológico TUSS 30805090"
             targetNamespace="http://camunda.org/schema/1.0/dmn">
  <!-- TUSS 3.08.05.09-0 - Procedimento Anatomopatológico TUSS 30805090
       Versao: 2.1.0 (2026-02-07)

       Indicacoes Clinicas (DUT/ANS):
       Analise histopatologica conforme indicacao medica

       Contraindicacoes:
       Material inadequado, especime sem fixação

       Classificacao: Sistema TNM / OMS 2022
       Tipos de Especime Validos: "especime_biopsia","especime_ressecao","especime_citologia"

       Referencias:
       - ANS/TUSS 2024
       - Sociedade Brasileira de Patologia
       - OMS 2022 - Classificação de Tumores / Sociedade Brasileira de Patologia

       Observacoes:
       - Validacao de tipo de especime obrigatoria
       - Classificacao histopatologica seguindo Sistema TNM / OMS 2022
       - Justificativa clinica documentada
       - Prazo de liberacao: 7-10 dias úteis
  -->

  <decision id="Decision_30805090" name="Indicacao para Procedimento Anatomopatológico TUSS 30805090">
    <decisionTable id="DecisionTable_30805090" hitPolicy="FIRST">

      <!-- Input 1: Specimen Status -->
      <input id="Input_1" label="Status do Especime">
        <inputExpression id="InputExpression_1" typeRef="string">
          <text>especimeStatus</text>
        </inputExpression>
      </input>

      <!-- Input 2: Specimen Type -->
      <input id="Input_2" label="Tipo de Especime">
        <inputExpression id="InputExpression_2" typeRef="string">
          <text>tipoEspecime</text>
        </inputExpression>
      </input>

      <!-- Input 3: Suspected Diagnosis -->
      <input id="Input_3" label="Diagnostico Suspeita">
        <inputExpression id="InputExpression_3" typeRef="string">
          <text>diagnosticoSuspeita</text>
        </inputExpression>
      </input>

      <!-- Input 4: Medical Justification -->
      <input id="Input_4" label="Justificativa Medica">
        <inputExpression id="InputExpression_4" typeRef="boolean">
          <text>justificativaMedica</text>
        </inputExpression>
      </input>

      <!-- Output 1: Result -->
      <output id="Output_1" label="Resultado" name="resultado" typeRef="string">
        <outputValues>
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Clinical Observation -->
      <output id="Output_2" label="Observacao" name="observacao" typeRef="string"/>

      <!-- Output 3: Clinical Foundation -->
      <output id="Output_3" label="Fundamentacao" name="fundamentacao" typeRef="string"/>
      <!-- Output 4: Waste Alerts -->
      <output id="Output_alertasDesperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues>
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Recommended Action -->
      <output id="Output_acaoRecomendada" name="acaoRecomendada" typeRef="string">
        <outputValues>
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- CONTRAINDICATIONS SECTION -->
      <rule id="Rule_Contraindicacao_EspecimeInvalido">
        <description>Especime inadequado ou fragmentado incorretamente</description>
        <inputEntry id="InputEntry_Contra_1_1"><text>"inadequado"</text></inputEntry>
        <inputEntry id="InputEntry_Contra_1_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Contra_1_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Contra_1_4"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_Contra_1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_Contra_1_2"><text>"Especime nao atende aos criterios de aceitacao laboratorial para Procedimento Anatomopatológico TUSS 30805090."</text></outputEntry>
        <outputEntry id="OutputEntry_Contra_1_3"><text>"Material inadequado conforme Sociedade Brasileira de Patologia - requisitos minimos de qualidade de especime. Material inadequado, especime sem fixação"</text></outputEntry>
        <outputEntry id="InputEntry_Contra_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="InputEntry_Contra_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraindicacao_SemIdentificacao">
        <description>Especime sem identificacao adequada</description>
        <inputEntry id="InputEntry_Contra_2_1"><text>"nao_identificado"</text></inputEntry>
        <inputEntry id="InputEntry_Contra_2_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Contra_2_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Contra_2_4"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_Contra_2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_Contra_2_2"><text>"Especime sem identificacao adequada conforme requisitos de rastreabilidade RDC 302/2005 ANVISA."</text></outputEntry>
        <outputEntry id="OutputEntry_Contra_2_3"><text>"Nao conformidade com RDC 302/2005 ANVISA - rastreabilidade de amostras biologicas. Risco de troca de amostras."</text></outputEntry>
        <outputEntry id="InputEntry_Contra_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="InputEntry_Contra_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraindicacao_TipoIncompativel">
        <description>Tipo de especime nao compativel com procedimento solicitado</description>
        <inputEntry id="InputEntry_Contra_3_1"><text>"adequado"</text></inputEntry>
        <inputEntry id="InputEntry_Contra_3_2"><text>"sangue_total","urina","fezes"</text></inputEntry>
        <inputEntry id="InputEntry_Contra_3_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Contra_3_4"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_Contra_3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_Contra_3_2"><text>"Tipo de especime incompativel com o procedimento anatomopatologico Procedimento Anatomopatológico TUSS 30805090."</text></outputEntry>
        <outputEntry id="OutputEntry_Contra_3_3"><text>"Especime fornecido nao e adequado para analise de Procedimento Anatomopatológico TUSS 30805090. Tipos validos: "especime_biopsia","especime_ressecao","especime_citologia". Protocolo tecnico SBP."</text></outputEntry>
        <outputEntry id="InputEntry_Contra_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="InputEntry_Contra_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraindicacao_SemJustificativa">
        <description>Ausencia de justificativa medica clinica</description>
        <inputEntry id="InputEntry_Contra_4_1"><text>"adequado"</text></inputEntry>
        <inputEntry id="InputEntry_Contra_4_2"><text>"especime_biopsia","especime_ressecao","especime_citologia"</text></inputEntry>
        <inputEntry id="InputEntry_Contra_4_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Contra_4_4"><text>false</text></inputEntry>
        <outputEntry id="OutputEntry_Contra_4_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_Contra_4_2"><text>"Ausencia de justificativa clinica documentada para solicitacao do exame anatomopatologico."</text></outputEntry>
        <outputEntry id="OutputEntry_Contra_4_3"><text>"ANS Resolucao Normativa 465/2021 Art. 16 - Necessaria justificativa clinica para procedimentos de alta complexidade. Indicacoes: Analise histopatologica conforme indicacao medica"</text></outputEntry>
        <outputEntry id="InputEntry_Contra_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="InputEntry_Contra_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- APPROVAL SECTION -->
      <rule id="Rule_Aprovado_IndicacaoClinica">
        <description>Especime adequado com indicacao clinica documentada</description>
        <inputEntry id="InputEntry_Aprov_1_1"><text>"adequado"</text></inputEntry>
        <inputEntry id="InputEntry_Aprov_1_2"><text>"especime_biopsia","especime_ressecao","especime_citologia"</text></inputEntry>
        <inputEntry id="InputEntry_Aprov_1_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Aprov_1_4"><text>true</text></inputEntry>
        <outputEntry id="OutputEntry_Aprov_1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_Aprov_1_2"><text>"Procedimento anatomopatologico autorizado. Especime atende aos criterios de aceitacao laboratorial e indicacao clinica documentada."</text></outputEntry>
        <outputEntry id="OutputEntry_Aprov_1_3"><text>"Remuneracao conforme tabela ANS/TUSS 3.08.05.09-0. Classificacao seguindo Sistema TNM / OMS 2022. Prazo de liberacao: 7-10 dias úteis. Indicacoes: Analise histopatologica conforme indicacao medica"</text></outputEntry>
        <outputEntry id="InputEntry_Aprov_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="InputEntry_Aprov_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- FALLBACK RULE - MUST BE LAST -->
      <rule id="Rule_Fallback_30805090">
        <description>Dados insuficientes para decisao automatica - requer analise manual</description>
        <inputEntry id="InputEntry_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_4"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OutputEntry_Fallback_2"><text>"Requer analise manual por auditor medico qualificado em Anatomia Patologica."</text></outputEntry>
        <outputEntry id="OutputEntry_Fallback_3"><text>"Documentacao incompleta ou criterios nao claramente definidos. Encaminhar para comite tecnico de analise de glosas. Classificacao: Sistema TNM / OMS 2022"</text></outputEntry>
        <outputEntry id="Rule_4"><text>"DOC"</text></outputEntry>
        <outputEntry id="Rule_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
