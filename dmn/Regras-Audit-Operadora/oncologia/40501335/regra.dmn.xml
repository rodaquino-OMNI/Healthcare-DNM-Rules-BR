<?xml version="1.0" encoding="UTF-8"?>
<!--
  ONQ-DRUG-010: Rucaparib Eligibility Criteria
  TUSS: 40501335
  Versao: 3.1.0-LEAN-TIER2 (2026-02-08)
  Especialidade: Oncologia

  ============================================================================
  INDICACOES CLINICAS:
  ============================================================================
  - Ovario BRCA+ recorrente: manutencao pos-platina (ARIEL3)
  - Prostata mCRPC BRCA+: pos-terapia hormonal (TRITON2/3)
  - Requer teste BRCA germinativo ou somatico

  ============================================================================
  REFERENCIAS NORMATIVAS:
  ============================================================================
  - ARIEL3 (ovarian maintenance)
  - TRITON2/TRITON3 (mCRPC)
  - NCCN Prostate Cancer, NCCN Ovarian Cancer
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_ONQ_DRUG_010" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.14.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.2.0">
  <decision id="Decision_ONQ_DRUG_010" name="ONQ-DRUG-010: Rucaparib Eligibility Criteria [LEAN TIER-2]">
    <decisionTable id="DecisionTable_ONQ_DRUG_010" hitPolicy="FIRST">
      <input id="Input_tumor_type" label="Tumor Type">
        <inputExpression id="InputExpression_tumor_type" typeRef="string">
          <text>tumorType</text>
        </inputExpression>
      </input>
      <input id="Input_brca_status" label="BRCA Status">
        <inputExpression id="InputExpression_brca_status" typeRef="string">
          <text>brcaStatus</text>
        </inputExpression>
      </input>
      <input id="Input_platinum_response" label="Platinum Response">
        <inputExpression id="InputExpression_platinum_response" typeRef="string">
          <text>platinumResponse</text>
        </inputExpression>
      </input>
      <input id="Input_prior_ht" label="Prior Hormonal Therapy (Prostate)">
        <inputExpression id="InputExpression_prior_ht" typeRef="boolean">
          <text>priorHormonalTherapy</text>
        </inputExpression>
      </input>
      <!-- Input: Dias desde ultimo procedimento (DUP detection) -->
      <input id="Input_ultimoProcedimentoDias" label="Dias Desde Ultimo Procedimento">
        <inputExpression id="InputExpression_ultimoProcedimentoDias" typeRef="number">
          <text>ultimoProcedimentoDias</text>
        </inputExpression>
      </input>

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" label="Observacao" name="observacao" typeRef="string" />
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>
      <rule id="DecisionRule_reject_brca_wt">
        <description>Reject BRCA wild-type</description>
        <inputEntry id="InputEntry_tumor_type_wt">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_brca_status_wt">
          <text>"wild_type","negative","not_tested"</text>
        </inputEntry>
        <inputEntry id="InputEntry_platinum_response_wt">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_ht_wt">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_reject_brca_wt_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_wt">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_wt">
          <text>"Rucaparibe requer BRCA mutado; BRCA wild-type sem indicacao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_wt">
          <text>"ARIEL3/TRITON: beneficio restrito a BRCA+; aprovar teste se nao realizado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_wt">
          <text>"DOC"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_wt">
          <text>"NEGAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_reject_non_approved_tumor">
        <description>Reject non-approved tumor types</description>
        <inputEntry id="InputEntry_tumor_type_non">
          <text>not("ovarian","fallopian_tube","peritoneal","prostate","mCRPC")</text>
        </inputEntry>
        <inputEntry id="InputEntry_brca_status_non">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_platinum_response_non">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_ht_non">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_reject_non_approved_tumor_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_non">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_non">
          <text>"Rucaparibe: apenas ovario/trompa/peritonio ou prostata mCRPC"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_non">
          <text>"Indicacoes aprovadas: ARIEL3 (ovario) e TRITON (prostata). Outras neoplasias off-label"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_non">
          <text>"PROT"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_non">
          <text>"NEGAR"</text>
        </outputEntry>
      </rule>

      <!-- WASTE DETECTION: ESC -->
      <rule id="Rule_40501335_ESC">
        <description>ESC - Rucaparib sem teste BRCA documentado</description>
        <inputEntry id="IE_ESC_40501335_1"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501335_2"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501335_3"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501335_4"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501335_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_ESC_40501335_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_ESC_40501335_observacao"><text>"Rucaparib sem teste BRCA documentado"</text></outputEntry>
        <outputEntry id="OE_ESC_40501335_fundamentacao"><text>"NCCN Ovarian 2024: Rucaparib requer BRCA mutado germinativo ou somatico confirmado"</text></outputEntry>
        <outputEntry id="OE_ESC_40501335_alertasDesperdicio"><text>"ESC"</text></outputEntry>
        <outputEntry id="OE_ESC_40501335_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- WASTE DETECTION: FREQ -->
      <rule id="Rule_40501335_FREQ">
        <description>FREQ - Verificar frequencia dispensacao medicamento oral oncologico. Ciclo 28 dias padr</description>
        <inputEntry id="IE_FREQ_40501335_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FREQ_40501335_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FREQ_40501335_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FREQ_40501335_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FREQ_40501335_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_FREQ_40501335_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FREQ_40501335_observacao"><text>"Verificar frequencia dispensacao medicamento oral oncologico. Ciclo 28 dias padrao"</text></outputEntry>
        <outputEntry id="OE_FREQ_40501335_fundamentacao"><text>"ANS RN 465/2021, SBOC 2023: Dispensacao oral oncologico ciclo 28 dias, max 3 ciclos por autorizacao"</text></outputEntry>
        <outputEntry id="OE_FREQ_40501335_alertasDesperdicio"><text>"FREQ"</text></outputEntry>
        <outputEntry id="OE_FREQ_40501335_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="DecisionRule_approve_ovarian">
        <description>Approve ovarian BRCA+ platinum-sensitive</description>
        <inputEntry id="InputEntry_tumor_type_ov">
          <text>"ovarian","fallopian_tube","peritoneal"</text>
        </inputEntry>
        <inputEntry id="InputEntry_brca_status_ov">
          <text>"BRCA1_positive","BRCA2_positive","gBRCA","sBRCA"</text>
        </inputEntry>
        <inputEntry id="InputEntry_platinum_response_ov">
          <text>"CR","PR","platinum_sensitive"</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_ht_ov">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_ovarian_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_ov">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_ov">
          <text>"Rucaparibe aprovado: ovario BRCA+ manutencao pos-resposta a platina"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_ov">
          <text>"ARIEL3 BRCA+: PFS 16.6 vs 5.4m; manutencao ate progressao ou toxicidade"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_ov">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_ov">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_approve_prostate">
        <description>Approve prostate mCRPC BRCA+</description>
        <inputEntry id="InputEntry_tumor_type_pros">
          <text>"prostate","mCRPC"</text>
        </inputEntry>
        <inputEntry id="InputEntry_brca_status_pros">
          <text>"BRCA1_positive","BRCA2_positive"</text>
        </inputEntry>
        <inputEntry id="InputEntry_platinum_response_pros">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_ht_pros">
          <text>true</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_prostate_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_pros">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_pros">
          <text>"Rucaparibe aprovado: mCRPC BRCA+ pos-terapia hormonal"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_pros">
          <text>"TRITON2: ORR 43.5% em BRCA+; TRITON3: PFS superior a segunda linha hormonal"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_pros">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_pros">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_pending_prostate_no_ht">
        <description>Pending prostate without prior HT</description>
        <inputEntry id="InputEntry_tumor_type_no_ht">
          <text>"prostate","mCRPC"</text>
        </inputEntry>
        <inputEntry id="InputEntry_brca_status_no_ht">
          <text>"BRCA1_positive","BRCA2_positive"</text>
        </inputEntry>
        <inputEntry id="InputEntry_platinum_response_no_ht">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_ht_no_ht">
          <text>false</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_pending_prostate_no_ht_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_no_ht">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_no_ht">
          <text>"Prostata BRCA+: iniciar terapia hormonal antes de PARPi"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_no_ht">
          <text>"TRITON: populacao pos-enzalutamida/abiraterona; PARPi nao e 1L para mCRPC"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_no_ht">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_no_ht">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_fallback">
        <description>Fallback rule</description>
        <inputEntry id="InputEntry_tumor_type_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_brca_status_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_platinum_response_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_ht_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_fallback_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_fallback">
          <text>"Dados insuficientes para avaliacao de rucaparibe"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_fallback">
          <text>"Necessario: tipo tumoral, status BRCA, resposta a platina ou terapia hormonal previa"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_fallback">
          <text>"DOC"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_fallback">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_ONQ_DRUG_010">
        <dc:Bounds height="80" width="180" x="160" y="100" />
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
