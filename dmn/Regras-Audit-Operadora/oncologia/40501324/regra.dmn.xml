<?xml version="1.0" encoding="UTF-8"?>
<!--
  ONQ-IMG-009: Colonoscopy Surveillance
  TUSS: 40501324
  Versao: 3.1.0-LEAN-TIER2 (2026-02-08)
  Especialidade: Oncologia/Gastroenterologia

  ============================================================================
  INDICACOES CLINICAS (NCCN/ASCO):
  ============================================================================
  - Ano 1: Colonoscopia 1 ano apos resseccao (se nao feita pre-op completa)
  - Anos 3-5: Se normal no ano 1, repetir em 3 anos, depois cada 5 anos
  - Adenomas avancados: Repetir em 1 ano

  ============================================================================
  CRITERIOS DE INTERVALO:
  ============================================================================
  - Normal: Repetir em 3 anos, depois cada 5 anos
  - Polipos hiperplasicos: 5 anos
  - Adenoma tubular 1-2 (pequeno): 3 anos
  - Adenoma avancado (>=10mm, viloso, DAG): 1 ano
  - Multiplos adenomas (>=10): 1 ano

  ============================================================================
  DOCUMENTACAO OBRIGATORIA:
  ============================================================================
  - Laudo de colonoscopia anterior com achados
  - Laudo anatomopatologico de polipos
  - Data da ultima colonoscopia

  ============================================================================
  REFERENCIAS NORMATIVAS:
  ============================================================================
  - NCCN Colorectal Cancer Screening/Surveillance 2024
  - ASCO Post-Polypectomy Surveillance Guidelines
  - US Multi-Society Task Force on Colorectal Cancer
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_ONQ_IMG_009" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.14.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.2.0">
  <decision id="Decision_ONQ_IMG_009" name="ONQ-IMG-009: Colonoscopy Surveillance [LEAN TIER-2]">
    <decisionTable id="DecisionTable_ONQ_IMG_009" hitPolicy="FIRST">
      <input id="Input_colon_cancer_history" label="Colon Cancer History">
        <inputExpression id="InputExpression_colon_cancer_history" typeRef="boolean">
          <text>colonCancerHistory</text>
        </inputExpression>
      </input>
      <input id="Input_years_since_surgery" label="Years Since Surgery/Last Colonoscopy">
        <inputExpression id="InputExpression_years_since_surgery" typeRef="number">
          <text>yearsSinceLastColonoscopy</text>
        </inputExpression>
      </input>
      <input id="Input_prior_findings" label="Prior Colonoscopy Findings">
        <inputExpression id="InputExpression_prior_findings" typeRef="string">
          <text>priorFindings</text>
        </inputExpression>
      </input>
      <input id="Input_lynch_syndrome" label="Lynch Syndrome">
        <inputExpression id="InputExpression_lynch_syndrome" typeRef="boolean">
          <text>lynchSyndrome</text>
        </inputExpression>
      </input>
      <!-- Input: Dias desde ultimo procedimento (DUP detection) -->
      <input id="Input_ultimoProcedimentoDias" label="Dias Desde Ultimo Procedimento">
        <inputExpression id="InputExpression_ultimoProcedimentoDias" typeRef="number">
          <text>ultimoProcedimentoDias</text>
        </inputExpression>
      </input>

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" label="Observacao" name="observacao" typeRef="string" />
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />
      <!-- Output 4: Alertas de Desperdicio - Anti-Waste Intelligence -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>
      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>
      <rule id="DecisionRule_approve_year1">
        <description>Approve colonoscopy at 1 year post-resection</description>
        <inputEntry id="InputEntry_colon_cancer_history_y1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_years_since_surgery_y1">
          <text>&gt;= 1</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_findings_y1">
          <text>"no_prior_complete","incomplete_preop"</text>
        </inputEntry>
        <inputEntry id="InputEntry_lynch_syndrome_y1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_year1_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_y1">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_y1">
          <text>"Colonoscopia aprovada: 1 ano pos-resseccao (vigilancia padrao)"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_y1">
          <text>"NCCN: colonoscopia 1 ano pos-op obrigatoria para avaliar anastomose e lesoes metacronas"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_year1_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_year1_acaoRecomendada">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_approve_lynch">
        <description>Approve annual colonoscopy for Lynch syndrome</description>
        <inputEntry id="InputEntry_colon_cancer_history_lynch">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_years_since_surgery_lynch">
          <text>&gt;= 1</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_findings_lynch">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_lynch_syndrome_lynch">
          <text>true</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_lynch_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_lynch">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_lynch">
          <text>"Colonoscopia anual aprovada para Sindrome de Lynch (alto risco CCR)"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_lynch">
          <text>"Lynch: colonoscopia anual a partir dos 20-25 anos; risco vitalicio 50-80% CCR"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_lynch_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_lynch_acaoRecomendada">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_approve_advanced_adenoma">
        <description>Approve colonoscopy at 1 year for advanced adenoma</description>
        <inputEntry id="InputEntry_colon_cancer_history_adv">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_years_since_surgery_adv">
          <text>&gt;= 1</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_findings_adv">
          <text>"advanced_adenoma","villous","high_grade_dysplasia","multiple_adenomas"</text>
        </inputEntry>
        <inputEntry id="InputEntry_lynch_syndrome_adv">
          <text>false</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_advanced_adenoma_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_adv">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_adv">
          <text>"Colonoscopia aprovada em 1 ano: adenoma avancado requer vigilancia intensiva"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_adv">
          <text>"Adenomas avancados (>=10mm, vilosos, DAG) tem risco &gt;5% de CCR em 3 anos; repetir em 1 ano"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_advanced_adenoma_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_advanced_adenoma_acaoRecomendada">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_approve_normal_3yr">
        <description>Approve colonoscopy at 3 years after normal exam</description>
        <inputEntry id="InputEntry_colon_cancer_history_normal">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_years_since_surgery_normal">
          <text>&gt;= 3</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_findings_normal">
          <text>"normal","hyperplastic_polyps_only"</text>
        </inputEntry>
        <inputEntry id="InputEntry_lynch_syndrome_normal">
          <text>false</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_normal_3yr_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_normal">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_normal">
          <text>"Colonoscopia aprovada: 3 anos desde colonoscopia normal pos-CCR"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_normal">
          <text>"NCCN: se ano 1 normal, repetir em 3 anos; depois cada 5 anos se continuar normal"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_normal_3yr_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_normal_3yr_acaoRecomendada">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_reject_too_soon_normal">
        <description>Reject if interval too short after normal colonoscopy</description>
        <inputEntry id="InputEntry_colon_cancer_history_soon">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_years_since_surgery_soon">
          <text>&lt; 3</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_findings_soon">
          <text>"normal","hyperplastic_polyps_only"</text>
        </inputEntry>
        <inputEntry id="InputEntry_lynch_syndrome_soon">
          <text>false</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_reject_too_soon_normal_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_soon">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_soon">
          <text>"Colonoscopia recusada: intervalo &lt;3 anos apos exame normal"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_soon">
          <text>"Colonoscopia normal: proximo exame em 3 anos (exceto sintomas novos)"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_reject_too_soon_normal_alertasDesperdicio">
          <text>"FREQ"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_reject_too_soon_normal_acaoRecomendada">
          <text>"NEGAR"</text>
        </outputEntry>
      </rule>

      <!-- WASTE DETECTION: DUP -->
      <rule id="Rule_40501324_DUP">
        <description>DUP - Colonoscopia vigilancia repetida em menos de 365 dias</description>
        <inputEntry id="IE_DUP_40501324_1"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_40501324_2"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_40501324_3"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_40501324_4"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_40501324_ultimo"><text>&lt; 365</text></inputEntry>
        <outputEntry id="OE_DUP_40501324_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_DUP_40501324_observacao"><text>"Colonoscopia vigilancia repetida em menos de 365 dias"</text></outputEntry>
        <outputEntry id="OE_DUP_40501324_fundamentacao"><text>"NCCN Colorectal 2024: Colonoscopia vigilancia anual (1o ano), depois a cada 3 anos"</text></outputEntry>
        <outputEntry id="OE_DUP_40501324_alertasDesperdicio"><text>"DUP"</text></outputEntry>
        <outputEntry id="OE_DUP_40501324_acaoRecomendada"><text>"AGUARDAR_PRAZO"</text></outputEntry>
      </rule>

      <rule id="DecisionRule_pending_symptoms">
        <description>Pending if new symptoms present</description>
        <inputEntry id="InputEntry_colon_cancer_history_pend">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_years_since_surgery_pend">
          <text>&lt; 3</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_findings_pend">
          <text>"normal"</text>
        </inputEntry>
        <inputEntry id="InputEntry_lynch_syndrome_pend">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_pending_symptoms_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_pend">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_pend">
          <text>"Intervalo reduzido: justificar com sintomas novos (sangramento, alteracao habito intestinal)"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_pend">
          <text>"Antecipacao requer justificativa clinica: sintomas sugestivos de recidiva ou segundo tumor"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_pending_symptoms_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_pending_symptoms_acaoRecomendada">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_fallback">
        <description>Fallback rule for incomplete data</description>
        <inputEntry id="InputEntry_colon_cancer_history_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_years_since_surgery_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_prior_findings_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_lynch_syndrome_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_fallback_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_fallback">
          <text>"Dados insuficientes para definir intervalo de colonoscopia"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_fallback">
          <text>"Necessario: historico CCR, data ultima colonoscopia, achados previos, Lynch"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_fallback_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_fallback_acaoRecomendada">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_ONQ_IMG_009">
        <dc:Bounds height="80" width="180" x="160" y="100" />
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
