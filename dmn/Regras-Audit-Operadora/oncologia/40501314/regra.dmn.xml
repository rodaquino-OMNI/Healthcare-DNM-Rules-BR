<?xml version="1.0" encoding="UTF-8"?>
<!--
  ONQ-LINE-008: Clinical Trial Referral Criteria
  TUSS: 40501314
  Versao: 3.1.0-LEAN-TIER2 (2026-02-08)
  Especialidade: Oncologia

  ============================================================================
  INDICACOES CLINICAS:
  ============================================================================
  - Terapia padrao esgotada (>=2 linhas sem opcao aprovada)
  - Performance status adequado (ECOG 0-2)
  - Funcao organica adequada para participacao em estudo

  ============================================================================
  CRITERIOS PARA ENCAMINHAMENTO PRECOCE:
  ============================================================================
  - Tumores raros sem terapia padrao aprovada
  - Biomarcadores com drogas em desenvolvimento (ex: KRAS G12C)
  - Doenca refrataria primaria

  ============================================================================
  DOCUMENTACAO OBRIGATORIA:
  ============================================================================
  - Historico de tratamentos previos com datas e respostas
  - Exames de imagem e laboratoriais recentes
  - Perfil molecular do tumor (se disponivel)

  ============================================================================
  REFERENCIAS NORMATIVAS:
  ============================================================================
  - ASCO Clinical Trial Enrollment Guidelines 2024
  - SBOC Recomendacoes de Ensaios Clinicos
  - CEP/CONEP Resolucao 466/2012
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_ONQ_LINE_008" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.14.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.2.0">
  <decision id="Decision_ONQ_LINE_008" name="ONQ-LINE-008: Clinical Trial Referral Criteria [LEAN TIER-2]">
    <decisionTable id="DecisionTable_ONQ_LINE_008" hitPolicy="FIRST">
      <input id="Input_standard_options" label="Standard Options Status">
        <inputExpression id="InputExpression_standard_options" typeRef="string">
          <text>standardOptionsStatus</text>
        </inputExpression>
      </input>
      <input id="Input_ecog_ps" label="ECOG Performance Status">
        <inputExpression id="InputExpression_ecog_ps" typeRef="number">
          <text>ecogPS</text>
        </inputExpression>
      </input>
      <input id="Input_organ_function" label="Organ Function Adequate">
        <inputExpression id="InputExpression_organ_function" typeRef="boolean">
          <text>organFunctionAdequate</text>
        </inputExpression>
      </input>
      <input id="Input_tumor_rarity" label="Tumor Rarity Category">
        <inputExpression id="InputExpression_tumor_rarity" typeRef="string">
          <text>tumorRarity</text>
        </inputExpression>
      </input>
      <!-- Input: Dias desde ultimo procedimento (DUP detection) -->
      <input id="Input_ultimoProcedimentoDias" label="Dias Desde Ultimo Procedimento">
        <inputExpression id="InputExpression_ultimoProcedimentoDias" typeRef="number">
          <text>ultimoProcedimentoDias</text>
        </inputExpression>
      </input>

      <input id="Input_ultimoProcedimentoDias" label="Dias Desde Ultimo Procedimento">
        <inputExpression id="InputExpression_ultimoProcedimentoDias" typeRef="number">
          <text>ultimoProcedimentoDias</text>
        </inputExpression>
      </input>
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" label="Observacao" name="observacao" typeRef="string" />
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />
      <!-- Output 4: Alertas de Desperdicio - Anti-Waste Intelligence -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>
      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>
      <rule id="DecisionRule_reject_poor_ps">
        <description>Reject referral for patients with poor performance status</description>
        <inputEntry id="InputEntry_standard_options_reject">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_ecog_ps_reject">
          <text>[3..4]</text>
        </inputEntry>
        <inputEntry id="InputEntry_organ_function_reject">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_tumor_rarity_reject">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_reject_poor_ps_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_DecisionRule_reject_poor_ps_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OutputEntry_resultado_reject">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_reject">
          <text>"ECOG 3-4: inelegivel para maioria dos ensaios clinicos. Foco em cuidados paliativos"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_reject">
          <text>"Criterios de inclusao padrao de ensaios fase I-III exigem ECOG 0-2 por seguranca"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_reject_poor_ps_alertasDesperdicio">
          <text>"PROT"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_reject_poor_ps_acaoRecomendada">
          <text>"NEGAR"</text>
        </outputEntry>
      </rule>
      <rule id="Rule_40501314_ESC_escalonamento">
        <description>ESC - Escalonamento inadequado sem falha linha anterior documentada</description>
        <inputEntry id="IE_ESC_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_ESC_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_ESC_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_ESC_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_ESC_5">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_ESC_6">
          <text>-</text>
        </inputEntry>

        <outputEntry id="OE_ESC_resultado">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OE_ESC_observacao">
          <text>"Documentar falha/intolerancia linha terapeutica anterior antes de escalonar"</text>
        </outputEntry>
        <outputEntry id="OE_ESC_fundamentacao">
          <text>"NCCN/CONITEC 2024: Step therapy obrigatoria - documentar falha antes de progredir para proxima linha"</text>
        </outputEntry>
        <outputEntry id="OE_ESC_alertasDesperdicio">
          <text>"ESC"</text>
        </outputEntry>
        <outputEntry id="OE_ESC_acaoRecomendada">
          <text>"SUGERIR_ALTERNATIVA"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_reject_organ_dysfunction">
        <description>Reject if significant organ dysfunction</description>
        <inputEntry id="InputEntry_standard_options_organ">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_ecog_ps_organ">
          <text>[0..2]</text>
        </inputEntry>
        <inputEntry id="InputEntry_organ_function_organ">
          <text>false</text>
        </inputEntry>
        <inputEntry id="InputEntry_tumor_rarity_organ">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_reject_organ_dysfunction_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_DecisionRule_reject_organ_dysfunction_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OutputEntry_resultado_organ">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_organ">
          <text>"Disfuncao organica significativa: inelegivel para ensaios com drogas experimentais"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_organ">
          <text>"Ensaios fase I-II exigem funcao hepatica/renal/cardiaca dentro de limites para avaliacao de toxicidade"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_reject_organ_dysfunction_alertasDesperdicio">
          <text>"PROT"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_reject_organ_dysfunction_acaoRecomendada">
          <text>"NEGAR"</text>
        </outputEntry>
      </rule>

      <!-- WASTE DETECTION: ESC -->
      <rule id="Rule_40501314_ESC">
        <description>ESC - Encaminhamento trial clinico sem documentacao criterios inclusao</description>
        <inputEntry id="IE_ESC_40501314_1"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501314_2"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501314_3"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501314_4"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501314_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_Rule_40501314_ESC_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OE_ESC_40501314_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_ESC_40501314_observacao"><text>"Encaminhamento trial clinico sem documentacao criterios inclusao"</text></outputEntry>
        <outputEntry id="OE_ESC_40501314_fundamentacao"><text>"ANVISA/CEP: Trial clinico requer criterios inclusao/exclusao documentados"</text></outputEntry>
        <outputEntry id="OE_ESC_40501314_alertasDesperdicio"><text>"ESC"</text></outputEntry>
        <outputEntry id="OE_ESC_40501314_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="DecisionRule_approve_exhausted">
        <description>Approve referral when standard options exhausted</description>
        <inputEntry id="InputEntry_standard_options_exhaust">
          <text>"exhausted"</text>
        </inputEntry>
        <inputEntry id="InputEntry_ecog_ps_exhaust">
          <text>[0..2]</text>
        </inputEntry>
        <inputEntry id="InputEntry_organ_function_exhaust">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_tumor_rarity_exhaust">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_exhausted_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_DecisionRule_approve_exhausted_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OutputEntry_resultado_exhaust">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_exhaust">
          <text>"Encaminhamento aprovado: terapia padrao esgotada, ECOG 0-2, funcao organica adequada"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_exhaust">
          <text>"Ensaios clinicos sao opcao terapeutica legitima apos falha de terapias padrao per ASCO guidelines"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_exhausted_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_exhausted_acaoRecomendada">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_approve_rare_tumor">
        <description>Approve early referral for rare tumors</description>
        <inputEntry id="InputEntry_standard_options_rare">
          <text>"limited","none"</text>
        </inputEntry>
        <inputEntry id="InputEntry_ecog_ps_rare">
          <text>[0..2]</text>
        </inputEntry>
        <inputEntry id="InputEntry_organ_function_rare">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_tumor_rarity_rare">
          <text>"rare","ultra_rare"</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_rare_tumor_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_DecisionRule_approve_rare_tumor_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OutputEntry_resultado_rare">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_rare">
          <text>"Encaminhamento precoce aprovado para tumor raro sem terapia padrao estabelecida"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_rare">
          <text>"Tumores raros (&lt;6/100.000/ano) frequentemente carecem de terapia aprovada; ensaios sao primeira linha"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_rare_tumor_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_rare_tumor_acaoRecomendada">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_approve_actionable_biomarker">
        <description>Approve referral for actionable biomarkers in development</description>
        <inputEntry id="InputEntry_standard_options_bio">
          <text>"available_but_biomarker_trial"</text>
        </inputEntry>
        <inputEntry id="InputEntry_ecog_ps_bio">
          <text>[0..1]</text>
        </inputEntry>
        <inputEntry id="InputEntry_organ_function_bio">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_tumor_rarity_bio">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_actionable_biomarker_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_DecisionRule_approve_actionable_biomarker_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OutputEntry_resultado_bio">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_bio">
          <text>"Encaminhamento aprovado: biomarcador acionavel com droga em desenvolvimento disponivel"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_bio">
          <text>"Drogas alvo em ensaios (ex: KRAS G12C, HER2 mutado) podem oferecer beneficio superior a terapia padrao"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_actionable_biomarker_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_approve_actionable_biomarker_acaoRecomendada">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_pending_ecog2">
        <description>Pending review for ECOG 2 patients</description>
        <inputEntry id="InputEntry_standard_options_pending">
          <text>"exhausted"</text>
        </inputEntry>
        <inputEntry id="InputEntry_ecog_ps_pending">
          <text>2</text>
        </inputEntry>
        <inputEntry id="InputEntry_organ_function_pending">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_tumor_rarity_pending">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_pending_ecog2_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_DecisionRule_pending_ecog2_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OutputEntry_resultado_pending">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_pending">
          <text>"ECOG 2: elegibilidade depende do protocolo especifico. Consultar centro de pesquisa"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_pending">
          <text>"Alguns protocolos aceitam ECOG 2; avaliar criterios de inclusao do estudo especifico"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_pending_ecog2_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_pending_ecog2_acaoRecomendada">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_pending_standard_available">
        <description>Pending if standard options still available</description>
        <inputEntry id="InputEntry_standard_options_avail">
          <text>"available"</text>
        </inputEntry>
        <inputEntry id="InputEntry_ecog_ps_avail">
          <text>[0..2]</text>
        </inputEntry>
        <inputEntry id="InputEntry_organ_function_avail">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_tumor_rarity_avail">
          <text>"common"</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_pending_standard_available_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_DecisionRule_pending_standard_available_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OutputEntry_resultado_avail">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_avail">
          <text>"Terapias padrao disponiveis: ensaio clinico opcional. Discutir preferencias com paciente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_avail">
          <text>"Ensaios clinicos podem ser considerados mesmo com opcoes padrao, especialmente se potencial curativo"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_pending_standard_available_alertasDesperdicio">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_pending_standard_available_acaoRecomendada">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_fallback">
        <description>Fallback rule for incomplete data</description>
        <inputEntry id="InputEntry_standard_options_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_ecog_ps_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_organ_function_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_tumor_rarity_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_fallback_ultimo"><text>-</text></inputEntry>
                <inputEntry id="IE_DecisionRule_fallback_ultimo">
          <text>-</text>
        </inputEntry>
<outputEntry id="OutputEntry_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_fallback">
          <text>"Dados insuficientes para avaliacao de elegibilidade para ensaio clinico"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_fallback">
          <text>"Necessario: historico terapeutico, ECOG, funcao organica, raridade do tumor"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_fallback_alertasDesperdicio">
          <text>"DOC"</text>
        </outputEntry>
        <outputEntry id="OE_DecisionRule_fallback_acaoRecomendada">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_ONQ_LINE_008">
        <dc:Bounds height="80" width="180" x="160" y="100" />
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
