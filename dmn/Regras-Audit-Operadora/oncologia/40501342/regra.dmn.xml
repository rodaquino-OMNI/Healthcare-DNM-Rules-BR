<?xml version="1.0" encoding="UTF-8"?>
<!--
  ONQ-DRUG-017: Osimertinib Sequencing
  TUSS: 40501342
  Versao: 3.1.0-LEAN-TIER2 (2026-02-08)
  Especialidade: Oncologia

  ============================================================================
  INDICACOES CLINICAS:
  ============================================================================
  - CPNPC EGFR+: 1L preferido (FLAURA - OS superior)
  - T790M+: 2L pos-TKI 1G/2G (AURA3)
  - Adjuvante: IB-IIIA EGFR+ (ADAURA)
  - Biopsia liquida aceitavel para T790M

  ============================================================================
  REFERENCIAS NORMATIVAS:
  ============================================================================
  - FLAURA (1L EGFR+)
  - AURA3 (2L T790M+)
  - ADAURA (adjuvant)
  - NCCN NSCLC 2024, ESMO NSCLC 2024
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_ONQ_DRUG_017" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.14.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.2.0">
  <decision id="Decision_ONQ_DRUG_017" name="ONQ-DRUG-017: Osimertinib Sequencing [LEAN TIER-2]">
    <decisionTable id="DecisionTable_ONQ_DRUG_017" hitPolicy="FIRST">
      <input id="Input_egfr_status" label="EGFR Mutation Status">
        <inputExpression id="InputExpression_egfr_status" typeRef="string">
          <text>egfrStatus</text>
        </inputExpression>
      </input>
      <input id="Input_t790m" label="T790M Status">
        <inputExpression id="InputExpression_t790m" typeRef="string">
          <text>t790mStatus</text>
        </inputExpression>
      </input>
      <input id="Input_line" label="Treatment Line">
        <inputExpression id="InputExpression_line" typeRef="number">
          <text>treatmentLine</text>
        </inputExpression>
      </input>
      <input id="Input_setting" label="Treatment Setting">
        <inputExpression id="InputExpression_setting" typeRef="string">
          <text>treatmentSetting</text>
        </inputExpression>
      </input>
      <!-- Input: Dias desde ultimo procedimento (DUP detection) -->
      <input id="Input_ultimoProcedimentoDias" label="Dias Desde Ultimo Procedimento">
        <inputExpression id="InputExpression_ultimoProcedimentoDias" typeRef="number">
          <text>ultimoProcedimentoDias</text>
        </inputExpression>
      </input>

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" label="Observacao" name="observacao" typeRef="string" />
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>
      <rule id="DecisionRule_reject_egfr_wt">
        <description>Reject EGFR wild-type</description>
        <inputEntry id="InputEntry_egfr_status_wt">
          <text>"wild_type","negative","not_tested"</text>
        </inputEntry>
        <inputEntry id="InputEntry_t790m_wt">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_line_wt">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_setting_wt">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_reject_egfr_wt_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_wt">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_wt">
          <text>"EGFR wild-type: osimertinibe nao indicado. Tratar com quimio ou IO"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_wt">
          <text>"FLAURA/AURA: apenas EGFR mutado; EGFR-wt sem beneficio de TKI"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_wt">
          <text>"PROT"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_wt">
          <text>"NEGAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_approve_1l">
        <description>Approve 1L EGFR+</description>
        <inputEntry id="InputEntry_egfr_status_1l">
          <text>"exon19_del","L858R","EGFR_positive"</text>
        </inputEntry>
        <inputEntry id="InputEntry_t790m_1l">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_line_1l">
          <text>1</text>
        </inputEntry>
        <inputEntry id="InputEntry_setting_1l">
          <text>"metastatic","advanced"</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_1l_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_1l">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_1l">
          <text>"Osimertinibe 1L aprovado: CPNPC EGFR+ avancado - tratamento preferido"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_1l">
          <text>"FLAURA: OS 38.6 vs 31.8m; PFS 18.9 vs 10.2m. Superior a erlotinibe/gefitinibe"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_1l">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_1l">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_approve_2l_t790m">
        <description>Approve 2L if T790M+</description>
        <inputEntry id="InputEntry_egfr_status_2l">
          <text>"exon19_del","L858R","EGFR_positive"</text>
        </inputEntry>
        <inputEntry id="InputEntry_t790m_2l">
          <text>"positive","T790M+"</text>
        </inputEntry>
        <inputEntry id="InputEntry_line_2l">
          <text>>= 2</text>
        </inputEntry>
        <inputEntry id="InputEntry_setting_2l">
          <text>"metastatic","advanced"</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_2l_t790m_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_2l">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_2l">
          <text>"Osimertinibe 2L aprovado: T790M+ pos-progressao em TKI 1G/2G"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_2l">
          <text>"AURA3: PFS 10.1 vs 4.4m; biopsia liquida aceitavel para T790M"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_2l">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_2l">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_reject_2l_t790m_neg">
        <description>Reject 2L if T790M negative</description>
        <inputEntry id="InputEntry_egfr_status_neg">
          <text>"exon19_del","L858R","EGFR_positive"</text>
        </inputEntry>
        <inputEntry id="InputEntry_t790m_neg">
          <text>"negative","not_detected"</text>
        </inputEntry>
        <inputEntry id="InputEntry_line_neg">
          <text>>= 2</text>
        </inputEntry>
        <inputEntry id="InputEntry_setting_neg">
          <text>"metastatic","advanced"</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_reject_2l_t790m_neg_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_neg">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_neg">
          <text>"T790M negativo: osimertinibe 2L nao indicado. Tratar com quimio +/- beva"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_neg">
          <text>"AURA3: beneficio restrito a T790M+; outros mecanismos de resistencia nao respondem"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_neg">
          <text>"PROT"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_neg">
          <text>"NEGAR"</text>
        </outputEntry>
      </rule>

      <!-- WASTE DETECTION: ESC -->
      <rule id="Rule_40501342_ESC">
        <description>ESC - Osimertinib 2L sem teste T790M documentado</description>
        <inputEntry id="IE_ESC_40501342_1"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501342_2"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501342_3"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501342_4"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_40501342_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_ESC_40501342_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_ESC_40501342_observacao"><text>"Osimertinib 2L sem teste T790M documentado"</text></outputEntry>
        <outputEntry id="OE_ESC_40501342_fundamentacao"><text>"NCCN NSCLC 2024: Osimertinib 2L requer T790M+ confirmado. 1L: EGFR mut qualquer"</text></outputEntry>
        <outputEntry id="OE_ESC_40501342_alertasDesperdicio"><text>"ESC"</text></outputEntry>
        <outputEntry id="OE_ESC_40501342_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- WASTE DETECTION: FREQ -->
      <rule id="Rule_40501342_FREQ">
        <description>FREQ - Verificar frequencia dispensacao medicamento oral oncologico. Ciclo 28 dias padr</description>
        <inputEntry id="IE_FREQ_40501342_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FREQ_40501342_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FREQ_40501342_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FREQ_40501342_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FREQ_40501342_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_FREQ_40501342_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FREQ_40501342_observacao"><text>"Verificar frequencia dispensacao medicamento oral oncologico. Ciclo 28 dias padrao"</text></outputEntry>
        <outputEntry id="OE_FREQ_40501342_fundamentacao"><text>"ANS RN 465/2021, SBOC 2023: Dispensacao oral oncologico ciclo 28 dias, max 3 ciclos por autorizacao"</text></outputEntry>
        <outputEntry id="OE_FREQ_40501342_alertasDesperdicio"><text>"FREQ"</text></outputEntry>
        <outputEntry id="OE_FREQ_40501342_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="DecisionRule_approve_adjuvant">
        <description>Approve adjuvant</description>
        <inputEntry id="InputEntry_egfr_status_adj">
          <text>"exon19_del","L858R","EGFR_positive"</text>
        </inputEntry>
        <inputEntry id="InputEntry_t790m_adj">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_line_adj">
          <text>1</text>
        </inputEntry>
        <inputEntry id="InputEntry_setting_adj">
          <text>"adjuvant","adjuvante"</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_approve_adjuvant_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_adj">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_adj">
          <text>"Osimertinibe adjuvante aprovado: CPNPC IB-IIIA EGFR+ ressecado. 3 anos"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_adj">
          <text>"ADAURA: DFS 90% vs 44% aos 2 anos; OS beneficio confirmado. Duracao 3 anos"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_adj">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_adj">
          <text>"APROVAR"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_pending_uncommon">
        <description>Pending for uncommon EGFR mutations</description>
        <inputEntry id="InputEntry_egfr_status_unc">
          <text>"exon20_ins","S768I","G719X","L861Q"</text>
        </inputEntry>
        <inputEntry id="InputEntry_t790m_unc">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_line_unc">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_setting_unc">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_pending_uncommon_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_unc">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_unc">
          <text>"Mutacao EGFR incomum: osimertinibe pode ter atividade reduzida. Avaliar caso a caso"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_unc">
          <text>"Exon20 ins: resistentes a TKI; S768I/G719X/L861Q: afatinibe pode ser alternativa"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_unc">
          <text>"NENHUM"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_unc">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
      <rule id="DecisionRule_fallback">
        <description>Fallback rule</description>
        <inputEntry id="InputEntry_egfr_status_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_t790m_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_line_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_setting_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="IE_DecisionRule_fallback_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_observacao_fallback">
          <text>"Dados insuficientes para avaliacao de osimertinibe"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_fundamentacao_fallback">
          <text>"Necessario: status EGFR, T790M (se 2L), linha de tratamento, contexto (metastatico/adjuvante)"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_alertasDesperdicio_fallback">
          <text>"DOC"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_acaoRecomendada_fallback">
          <text>"SOLICITAR_INFO"</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_ONQ_DRUG_017">
        <dc:Bounds height="80" width="180" x="160" y="100" />
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
