<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_30801031"
             name="Terapia Alvo Molecular"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    TUSS 30801031 - Terapia Alvo Molecular (Targeted Therapy)
    Versao: 3.1.0-LEAN-TIER2 (2026-02-08)
    Especialidade: Oncologia
    Categoria: Terapia Alvo

    Indicacoes Clinicas (NCCN/ESMO 2024):
    - NSCLC com EGFR mutado (osimertinib, erlotinib, gefitinib)
    - NSCLC com ALK rearranjo (alectinib, lorlatinib, crizotinib)
    - NSCLC com ROS1, RET, MET, BRAF, NTRK
    - Mama HER2+ (trastuzumab, pertuzumab, T-DM1, T-DXd)
    - GIST c-KIT/PDGFRA (imatinib, sunitinib)
    - Melanoma BRAF V600 (vemurafenib + cobimetinib)

    Contraindicacoes:
    - Mutacao alvo ausente (teste molecular negativo)
    - Intolerancia grave previa ao mesmo alvo
    - Disfuncao hepatica/renal grave (especifico por droga)
    - Interacoes medicamentosas graves nao manejÃ¡veis

    Documentacao Obrigatoria:
    - Diagnostico histopatologico
    - Teste molecular/genetico comprovando mutacao alvo
    - Estadiamento atual
    - Funcao hepatica e renal
    - Termo de consentimento informado

    Referencias Normativas:
    - NCCN Guidelines por tipo tumoral (2024)
    - ESMO Clinical Practice Guidelines (2024)
    - CONITEC/ANS incorporacoes
    - ANS RN 465/2021 - Rol de Procedimentos
    - DUT ANS 2024
  -->

  <decision id="Decision_30801031" name="Criterios de Autorizacao - Terapia Alvo Molecular [LEAN TIER-2]">
    <decisionTable id="DecisionTable_30801031" hitPolicy="FIRST">

      <!-- Input 1: Condicao Paciente -->
      <input id="Input_condicaoPaciente" label="Condicao Clinica do Paciente">
        <inputExpression id="InputExpr_condicaoPaciente" typeRef="string">
          <text>condicaoPaciente</text>
        </inputExpression>
        <inputValues id="InputValues_condicaoPaciente">
          <text>"NSCLC EGFR mutado","NSCLC ALK rearranjo","NSCLC ROS1/RET/NTRK","Mama HER2 positivo","GIST KIT/PDGFRA","Melanoma BRAF V600","Mutacao alvo ausente","Outra"</text>
        </inputValues>
      </input>

      <!-- Input 2: Historico Clinico -->
      <input id="Input_historicoClinico" label="Historico Clinico Documentado">
        <inputExpression id="InputExpr_historicoClinico" typeRef="string">
          <text>historicoClinico</text>
        </inputExpression>
        <inputValues id="InputValues_historicoClinico">
          <text>"Adequado","Incompleto","NaoDocumentado"</text>
        </inputValues>
      </input>

      <!-- Input 3: Classe Indicacao -->
      <input id="Input_classeIndicacao" label="Classe de Indicacao (NCCN/ESMO)">
        <inputExpression id="InputExpr_classeIndicacao" typeRef="string">
          <text>classeIndicacao</text>
        </inputExpression>
        <inputValues id="InputValues_classeIndicacao">
          <text>"Categoria 1","Categoria 2A","Categoria 2B","Categoria 3"</text>
        </inputValues>
      </input>

      <!-- Input 4: Exames Comprobatorios -->
      <input id="Input_examesComprobatorios" label="Teste Molecular Comprobatorio">
        <inputExpression id="InputExpr_examesComprobatorios" typeRef="string">
          <text>examesComprobatorios</text>
        </inputExpression>
        <inputValues id="InputValues_examesComprobatorios">
          <text>"Mutacao confirmada NGS/PCR","Mutacao confirmada FISH/IHC","Teste molecular pendente","Teste molecular negativo","Nao realizado"</text>
        </inputValues>
      </input>

      <!-- Input 5: Expectativa de Vida -->
      <input id="Input_expectativaVida" label="Expectativa de Vida Superior a 1 Ano">
        <inputExpression id="InputExpr_expectativaVida" typeRef="boolean">
          <text>expectativaVidaSuperior1Ano</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <!-- Input: Dias desde ultimo procedimento (DUP detection) -->
      <input id="Input_ultimoProcedimentoDias" label="Dias Desde Ultimo Procedimento">
        <inputExpression id="InputExpression_ultimoProcedimentoDias" typeRef="number">
          <text>ultimoProcedimentoDias</text>
        </inputExpression>
      </input>

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao Legal/Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas de Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio"><text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text></outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada"><text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text></outputValues>
      </output>

      <!-- REPROVACAO RULES -->
      <rule id="Rule_30801031_Reprovacao_1">
        <description>Reprovacao - Mutacao alvo ausente</description>
        <inputEntry id="IE_Rep1_1"><text>"Mutacao alvo ausente"</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <inputEntry id="IE_Rule_30801031_Reprovacao_1_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Mutacao alvo nao detectada. Terapia alvo nao indicada sem biomarcador preditivo. Considerar quimioterapia ou imunoterapia conforme perfil"</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"NCCN/ESMO 2024 - Terapia alvo requer mutacao driver confirmada"</text></outputEntry>
        <outputEntry id="OE_Rep1_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Rep1_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_30801031_Reprovacao_2">
        <description>Reprovacao - Teste molecular negativo</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>"Teste molecular negativo"</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <inputEntry id="IE_Rule_30801031_Reprovacao_2_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Teste molecular realizado e negativo para mutacao alvo. Terapia alvo nao indicada. Rever opcoes terapeuticas alternativas"</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"Medicina de Precisao - Tratamento baseado em biomarcador"</text></outputEntry>
        <outputEntry id="OE_Rep2_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Rep2_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- WASTE DETECTION: DUP -->
      <rule id="Rule_30801031_DUP">
        <description>DUP - Dose terapia alvo molecular repetida em menos de 14 dias</description>
        <inputEntry id="IE_DUP_30801031_1"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_30801031_2"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_30801031_3"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_30801031_4"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_30801031_5"><text>-</text></inputEntry>
        <inputEntry id="IE_DUP_30801031_ultimo"><text>&lt; 14</text></inputEntry>
        <outputEntry id="OE_DUP_30801031_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_DUP_30801031_observacao"><text>"Dose terapia alvo molecular repetida em menos de 14 dias"</text></outputEntry>
        <outputEntry id="OE_DUP_30801031_fundamentacao"><text>"NCCN 2024: Terapia alvo - intervalo minimo conforme bula/protocolo"</text></outputEntry>
        <outputEntry id="OE_DUP_30801031_alertasDesperdicio"><text>"DUP"</text></outputEntry>
        <outputEntry id="OE_DUP_30801031_acaoRecomendada"><text>"AGUARDAR_PRAZO"</text></outputEntry>
      </rule>

      <!-- WASTE DETECTION: ESC -->
      <rule id="Rule_30801031_ESC">
        <description>ESC - Terapia alvo molecular sem teste molecular prerequisito documentado</description>
        <inputEntry id="IE_ESC_30801031_1"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_30801031_2"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_30801031_3"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_30801031_4"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_30801031_5"><text>-</text></inputEntry>
        <inputEntry id="IE_ESC_30801031_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_ESC_30801031_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_ESC_30801031_observacao"><text>"Terapia alvo molecular sem teste molecular prerequisito documentado"</text></outputEntry>
        <outputEntry id="OE_ESC_30801031_fundamentacao"><text>"NCCN 2024: NGS/PCR obrigatorio antes de iniciar TKI ou anticorpo alvo-dirigido"</text></outputEntry>
        <outputEntry id="OE_ESC_30801031_alertasDesperdicio"><text>"ESC"</text></outputEntry>
        <outputEntry id="OE_ESC_30801031_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>


      <!-- APROVACAO RULES -->
      <rule id="Rule_30801031_Aprovacao_1">
        <description>Aprovacao - NSCLC EGFR mutado primeira linha</description>
        <inputEntry id="IE_Aprov1_1"><text>"NSCLC EGFR mutado"</text></inputEntry>
        <inputEntry id="IE_Aprov1_2"><text>"Adequado"</text></inputEntry>
        <inputEntry id="IE_Aprov1_3"><text>"Categoria 1"</text></inputEntry>
        <inputEntry id="IE_Aprov1_4"><text>"Mutacao confirmada NGS/PCR"</text></inputEntry>
        <inputEntry id="IE_Aprov1_5"><text>true</text></inputEntry>
        <inputEntry id="IE_Rule_30801031_Aprovacao_1_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov1_2"><text>"NSCLC com mutacao EGFR confirmada. Osimertinib primeira linha preferencial (FLAURA). PFS mediana 18.9 meses, OS 38.6 meses"</text></outputEntry>
        <outputEntry id="OE_Aprov1_3"><text>"FLAURA, NCCN NSCLC 2024 Categoria 1, CONITEC incorporado"</text></outputEntry>
        <outputEntry id="OE_Aprov1_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprov1_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_30801031_Aprovacao_2">
        <description>Aprovacao - NSCLC ALK rearranjo</description>
        <inputEntry id="IE_Aprov2_1"><text>"NSCLC ALK rearranjo"</text></inputEntry>
        <inputEntry id="IE_Aprov2_2"><text>"Adequado"</text></inputEntry>
        <inputEntry id="IE_Aprov2_3"><text>"Categoria 1"</text></inputEntry>
        <inputEntry id="IE_Aprov2_4"><text>"Mutacao confirmada NGS/PCR","Mutacao confirmada FISH/IHC"</text></inputEntry>
        <inputEntry id="IE_Aprov2_5"><text>true</text></inputEntry>
        <inputEntry id="IE_Rule_30801031_Aprovacao_2_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov2_2"><text>"NSCLC ALK positivo confirmado. Alectinib primeira linha preferencial (ALEX). Lorlatinib alternativa. PFS mediana 34.8 meses"</text></outputEntry>
        <outputEntry id="OE_Aprov2_3"><text>"ALEX, CROWN, NCCN NSCLC 2024 Categoria 1"</text></outputEntry>
        <outputEntry id="OE_Aprov2_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprov2_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_30801031_Aprovacao_3">
        <description>Aprovacao - Mama HER2 positivo</description>
        <inputEntry id="IE_Aprov3_1"><text>"Mama HER2 positivo"</text></inputEntry>
        <inputEntry id="IE_Aprov3_2"><text>"Adequado"</text></inputEntry>
        <inputEntry id="IE_Aprov3_3"><text>"Categoria 1"</text></inputEntry>
        <inputEntry id="IE_Aprov3_4"><text>"Mutacao confirmada FISH/IHC"</text></inputEntry>
        <inputEntry id="IE_Aprov3_5"><text>true</text></inputEntry>
        <inputEntry id="IE_Rule_30801031_Aprovacao_3_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov3_2"><text>"Cancer de mama HER2 positivo (IHC 3+ ou FISH amplificado). Trastuzumab + pertuzumab + taxano primeira linha. T-DXd segunda linha"</text></outputEntry>
        <outputEntry id="OE_Aprov3_3"><text>"CLEOPATRA, DESTINY-Breast03, NCCN Breast 2024 Categoria 1"</text></outputEntry>
        <outputEntry id="OE_Aprov3_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprov3_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_30801031_Aprovacao_4">
        <description>Aprovacao - GIST KIT/PDGFRA positivo</description>
        <inputEntry id="IE_Aprov4_1"><text>"GIST KIT/PDGFRA"</text></inputEntry>
        <inputEntry id="IE_Aprov4_2"><text>"Adequado"</text></inputEntry>
        <inputEntry id="IE_Aprov4_3"><text>"Categoria 1"</text></inputEntry>
        <inputEntry id="IE_Aprov4_4"><text>"Mutacao confirmada NGS/PCR"</text></inputEntry>
        <inputEntry id="IE_Aprov4_5"><text>-</text></inputEntry>
        <inputEntry id="IE_Rule_30801031_Aprovacao_4_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov4_2"><text>"GIST com mutacao KIT ou PDGFRA. Imatinib primeira linha (400mg/d). Avapritinib se PDGFRA D842V. Beneficio de sobrevida comprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov4_3"><text>"NCCN GIST 2024, ESMO GIST Guidelines"</text></outputEntry>
        <outputEntry id="OE_Aprov4_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprov4_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_30801031_Aprovacao_5">
        <description>Aprovacao - Melanoma BRAF V600 mutado</description>
        <inputEntry id="IE_Aprov5_1"><text>"Melanoma BRAF V600"</text></inputEntry>
        <inputEntry id="IE_Aprov5_2"><text>"Adequado"</text></inputEntry>
        <inputEntry id="IE_Aprov5_3"><text>"Categoria 1"</text></inputEntry>
        <inputEntry id="IE_Aprov5_4"><text>"Mutacao confirmada NGS/PCR"</text></inputEntry>
        <inputEntry id="IE_Aprov5_5"><text>true</text></inputEntry>
        <inputEntry id="IE_Rule_30801031_Aprovacao_5_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov5_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov5_2"><text>"Melanoma com mutacao BRAF V600E/K. Combinacao BRAF + MEK inibidor (dabrafenib + trametinib ou encorafenib + binimetinib). ORR 60-70%"</text></outputEntry>
        <outputEntry id="OE_Aprov5_3"><text>"COMBI-d, COMBI-v, COLUMBUS, NCCN Melanoma 2024"</text></outputEntry>
        <outputEntry id="OE_Aprov5_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprov5_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- PENDENTE RULE -->
      <rule id="Rule_30801031_Pendente_1">
        <description>Pendente - Teste molecular pendente</description>
        <inputEntry id="IE_Pend1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>"Teste molecular pendente","Nao realizado"</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>-</text></inputEntry>
        <inputEntry id="IE_Rule_30801031_Pendente_1_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Aguardando resultado de teste molecular. Solicitar NGS/PCR ou FISH/IHC conforme tipo tumoral antes da autorizacao"</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"NCCN/ESMO 2024 - Teste molecular obrigatorio para terapia alvo"</text></outputEntry>
        <outputEntry id="OE_Pend1_4"><text>"DOC"</text></outputEntry>
        <outputEntry id="OE_Pend1_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- FALLBACK -->
      <rule id="Rule_Fallback_30801031">
        <description>Regra padrao - analise manual por auditor medico</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <inputEntry id="IE_Rule_Fallback_30801031_ultimo"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso requer analise manual por auditor medico oncologista. Teste molecular e estadiamento completos podem ser solicitados"</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria medica conforme RN 428/2017 e DUT ANS 2024"</text></outputEntry>
        <outputEntry id="OE_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
