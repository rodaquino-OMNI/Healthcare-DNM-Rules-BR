<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_DUP_010"
             name="Prevencao de Duplicidade - Honorarios Equipe Cirurgica"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    DUP-010 - Prevencao de Duplicidade de Honorarios de Equipe Cirurgica
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Controle de Desperdicio
    Categoria: Duplicate Procedure Prevention

    Objetivo:
    - Detectar cobranca duplicada de honorarios em mesma cirurgia
    - Validar composicao adequada de equipe cirurgica
    - Aplicar percentuais corretos para auxiliares

    Indicacoes para Bloqueio:
    - Mesmo profissional cobrando como cirurgiao e auxiliar
    - Numero de auxiliares incompativel com porte cirurgico
    - Honorarios duplicados para mesma funcao

    Excecoes Permitidas:
    - Cirurgias de grande porte com equipe extensa
    - Procedimentos combinados com equipes distintas
    - Troca de equipe durante procedimento (documentada)

    Referencias Normativas:
    - CBHPM - Tabela de Honorarios 2023
    - ANS - RN 465/2021 - Composicao de Equipe
    - CFM - Resolucao sobre Equipes Cirurgicas
  -->

  <decision id="Decision_DUP_010" name="Prevencao Duplicidade - Honorarios Equipe Cirurgica">
    <decisionTable id="DecisionTable_DUP_010" hitPolicy="FIRST">

      <!-- Input 1: Duplicidade de profissional detectada -->
      <input id="Input_duplicidadeProfissionalDetectada" label="Mesmo Profissional em Multiplas Funcoes">
        <inputExpression id="InputExpr_duplicidadeProfissionalDetectada" typeRef="boolean">
          <text>duplicidadeProfissionalDetectada</text>
        </inputExpression>
      </input>

      <!-- Input 2: Numero auxiliares compativel porte -->
      <input id="Input_auxiliaresCompativelPorte" label="Numero de Auxiliares Compativel com Porte Cirurgico">
        <inputExpression id="InputExpr_auxiliaresCompativelPorte" typeRef="boolean">
          <text>auxiliaresCompativelPorte</text>
        </inputExpression>
      </input>

      <!-- Input 3: Procedimento combinado equipes distintas -->
      <input id="Input_procedimentoCombinado" label="Procedimento Combinado com Equipes Distintas">
        <inputExpression id="InputExpr_procedimentoCombinado" typeRef="boolean">
          <text>procedimentoCombinado</text>
        </inputExpression>
      </input>

      <!-- Input 4: Grande porte documentado -->
      <input id="Input_grandePorteDocumentado" label="Cirurgia de Grande Porte Documentada">
        <inputExpression id="InputExpr_grandePorteDocumentado" typeRef="boolean">
          <text>grandePorteDocumentado</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao Legal" name="fundamentacao" typeRef="string" />
      <!-- Output 4: Alertas de Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- ============================================== -->
      <!-- REPROVADO: Duplicidade de profissional        -->
      <!-- ============================================== -->
      <rule id="Rule_DUP_010_Reprovado_DuplicidadeProfissional">
        <description>Reprovado - Mesmo profissional cobrando multiplas funcoes</description>
        <inputEntry id="IE_Rep1_1"><text>true</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Honorario bloqueado - Mesmo profissional identificado em multiplas funcoes na mesma cirurgia. Vedada dupla cobranca."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"CBHPM 2023; CFM Resolucao Equipes Cirurgicas"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Reprovado_DuplicidadeProfissional_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Reprovado_DuplicidadeProfissional_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- REPROVADO: Auxiliares incompativel porte      -->
      <!-- ============================================== -->
      <rule id="Rule_DUP_010_Reprovado_AuxiliaresExcesso">
        <description>Reprovado - Numero de auxiliares incompativel com porte cirurgico</description>
        <inputEntry id="IE_Rep2_1"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Equipe cirurgica incompativel com porte do procedimento. Numero de auxiliares excede o permitido pela tabela CBHPM."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"CBHPM 2023 - Composicao de Equipe"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Reprovado_AuxiliaresExcesso_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Reprovado_AuxiliaresExcesso_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APROVADO: Procedimento combinado              -->
      <!-- ============================================== -->
      <rule id="Rule_DUP_010_Aprovado_Combinado">
        <description>Aprovado - Procedimento combinado justifica equipes distintas</description>
        <inputEntry id="IE_Aprov1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov1_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Aprov1_4"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov1_2"><text>"Honorarios autorizados - Procedimento combinado com equipes de especialidades distintas."</text></outputEntry>
        <outputEntry id="OE_Aprov1_3"><text>"Procedimento combinado - Equipes distintas permitidas"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Aprovado_Combinado_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Aprovado_Combinado_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APROVADO: Grande porte com equipe extensa     -->
      <!-- ============================================== -->
      <rule id="Rule_DUP_010_Aprovado_GrandePorte">
        <description>Aprovado - Cirurgia de grande porte justifica equipe ampliada</description>
        <inputEntry id="IE_Aprov2_1"><text>false</text></inputEntry>
        <inputEntry id="IE_Aprov2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov2_4"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov2_2"><text>"Honorarios autorizados - Cirurgia de grande porte com equipe compativel documentada."</text></outputEntry>
        <outputEntry id="OE_Aprov2_3"><text>"CBHPM - Grande porte permite equipe ampliada"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Aprovado_GrandePorte_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Aprovado_GrandePorte_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APROVADO: Equipe regular                      -->
      <!-- ============================================== -->
      <rule id="Rule_DUP_010_Aprovado_EquipeRegular">
        <description>Aprovado - Composicao de equipe adequada</description>
        <inputEntry id="IE_Aprov3_1"><text>false</text></inputEntry>
        <inputEntry id="IE_Aprov3_2"><text>true</text></inputEntry>
        <inputEntry id="IE_Aprov3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov3_4"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov3_2"><text>"Honorarios autorizados - Composicao de equipe cirurgica adequada ao porte do procedimento."</text></outputEntry>
        <outputEntry id="OE_Aprov3_3"><text>"Verificacao de equipe - OK"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Aprovado_EquipeRegular_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Aprovado_EquipeRegular_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- PENDENTE: Fallback                            -->
      <!-- ============================================== -->
      <rule id="Rule_DUP_010_Pendente_Fallback">
        <description>Pendente - Requer analise manual por auditor</description>
        <inputEntry id="IE_Pend_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend_4"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend_2"><text>"Caso requer analise manual por auditor para validacao de composicao de equipe cirurgica."</text></outputEntry>
        <outputEntry id="OE_Pend_3"><text>"Auditoria de honorarios - Processo manual"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Pendente_Fallback_4"><text>"DOC"</text></outputEntry>
        <outputEntry id="OE_Rule_DUP_010_Pendente_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
