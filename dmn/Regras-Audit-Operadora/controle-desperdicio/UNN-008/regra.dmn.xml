<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_UNN_008"
             name="Prevencao de Procedimento Desnecessario - Cateterismo para Angina Estavel"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    UNN-008 - Prevencao de Procedimento Desnecessario - Cateterismo para Angina Estavel
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Controle de Desperdicio
    Categoria: Unnecessary Procedure Prevention

    Objetivo:
    - Evitar cateterismo cardiaco invasivo como primeiro exame em angina estavel
    - Priorizar estratificacao de risco nao invasiva
    - Seguir diretriz ISCHEMIA Trial para manejo de DAC estavel

    Indicacoes para Bloqueio (Choosing Wisely):
    - Angina estavel CCS I-II sem teste funcional previo
    - Ausencia de evidencia de isquemia moderada a grave
    - Paciente compensado sem sinais de alto risco

    Excecoes Permitidas:
    - Sindrome coronariana aguda
    - Isquemia moderada a grave em teste nao invasivo (>10% VE)
    - Angina refrataria ao tratamento clinico otimizado
    - Insuficiencia cardiaca com FEVE reduzida

    Referencias Normativas:
    - ABM Choosing Wisely Brasil 2024 - Cardiologia
    - ACC/AHA Coronary Revascularization Guidelines 2023
    - ISCHEMIA Trial - NEJM 2020
  -->

  <decision id="Decision_UNN_008" name="Prevencao Desnecessario - Cateterismo para Angina Estavel">
    <decisionTable id="DecisionTable_UNN_008" hitPolicy="FIRST">

      <!-- Input 1: Angina estavel sem teste funcional -->
      <input id="Input_anginaEstavelSemTesteFuncional" label="Angina Estavel sem Teste Funcional Previo">
        <inputExpression id="InputExpr_anginaEstavelSemTesteFuncional" typeRef="boolean">
          <text>anginaEstavelSemTesteFuncional</text>
        </inputExpression>
      </input>

      <!-- Input 2: Isquemia moderada a grave documentada -->
      <input id="Input_isquemiaModeradaGrave" label="Isquemia Moderada a Grave em Teste Nao Invasivo">
        <inputExpression id="InputExpr_isquemiaModeradaGrave" typeRef="boolean">
          <text>isquemiaModeradaGrave</text>
        </inputExpression>
      </input>

      <!-- Input 3: Sindrome coronariana aguda -->
      <input id="Input_sindromeCoronarianaAguda" label="Sindrome Coronariana Aguda (SCA)">
        <inputExpression id="InputExpr_sindromeCoronarianaAguda" typeRef="boolean">
          <text>sindromeCoronarianaAguda</text>
        </inputExpression>
      </input>

      <!-- Input 4: Angina refrataria a tratamento otimizado -->
      <input id="Input_anginaRefrataria" label="Angina Refrataria ao Tratamento Clinico Otimizado">
        <inputExpression id="InputExpr_anginaRefrataria" typeRef="boolean">
          <text>anginaRefrataria</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao Legal" name="fundamentacao" typeRef="string" />
      <!-- Output 4: Alertas de Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- ============================================== -->
      <!-- REPROVADO: Angina estavel sem estratificacao  -->
      <!-- ============================================== -->
      <rule id="Rule_UNN_008_Reprovado_SemEstratificacao">
        <description>Reprovado - Cateterismo sem estratificacao de risco nao invasiva</description>
        <inputEntry id="IE_Rep1_1"><text>true</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Cateterismo nao indicado como primeiro exame em angina estavel. Realizar primeiro estratificacao nao invasiva (teste ergometrico, cintilografia, angioTC). Estudo ISCHEMIA nao mostrou beneficio de revascularizacao rotineira."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ABM Choosing Wisely 2024; ISCHEMIA Trial NEJM 2020"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Reprovado_SemEstratificacao_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Reprovado_SemEstratificacao_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APROVADO: SCA                                 -->
      <!-- ============================================== -->
      <rule id="Rule_UNN_008_Aprovado_SCA">
        <description>Aprovado - Sindrome coronariana aguda requer cateterismo</description>
        <inputEntry id="IE_Aprov1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov1_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Aprov1_4"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov1_2"><text>"Cateterismo autorizado - Sindrome coronariana aguda tem indicacao de estratificacao invasiva."</text></outputEntry>
        <outputEntry id="OE_Aprov1_3"><text>"SCA - Estratificacao invasiva indicada"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Aprovado_SCA_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Aprovado_SCA_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APROVADO: Isquemia moderada a grave           -->
      <!-- ============================================== -->
      <rule id="Rule_UNN_008_Aprovado_IsquemiaGrave">
        <description>Aprovado - Isquemia moderada a grave em teste nao invasivo</description>
        <inputEntry id="IE_Aprov2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov2_2"><text>true</text></inputEntry>
        <inputEntry id="IE_Aprov2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov2_4"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov2_2"><text>"Cateterismo autorizado - Isquemia moderada a grave (maior que 10% VE) identificada em teste nao invasivo."</text></outputEntry>
        <outputEntry id="OE_Aprov2_3"><text>"Isquemia significativa - ACC/AHA Guidelines 2023"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Aprovado_IsquemiaGrave_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Aprovado_IsquemiaGrave_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APROVADO: Angina refrataria                   -->
      <!-- ============================================== -->
      <rule id="Rule_UNN_008_Aprovado_Refrataria">
        <description>Aprovado - Angina refrataria ao tratamento clinico otimizado</description>
        <inputEntry id="IE_Aprov3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov3_4"><text>true</text></inputEntry>
        <outputEntry id="OE_Aprov3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov3_2"><text>"Cateterismo autorizado - Angina refrataria apesar de tratamento clinico otimizado documentado."</text></outputEntry>
        <outputEntry id="OE_Aprov3_3"><text>"Angina refrataria - Indicacao de cateterismo"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Aprovado_Refrataria_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Aprovado_Refrataria_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- APROVADO: Nao e angina estavel sem teste      -->
      <!-- ============================================== -->
      <rule id="Rule_UNN_008_Aprovado_ComTeste">
        <description>Aprovado - Paciente com teste funcional previo ou indicacao direta</description>
        <inputEntry id="IE_Aprov4_1"><text>false</text></inputEntry>
        <inputEntry id="IE_Aprov4_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Aprov4_4"><text>-</text></inputEntry>
        <outputEntry id="OE_Aprov4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Aprov4_2"><text>"Cateterismo autorizado - Estratificacao nao invasiva previa ou outra indicacao aceita."</text></outputEntry>
        <outputEntry id="OE_Aprov4_3"><text>"Estratificacao completa - Indicacao aceita"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Aprovado_ComTeste_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Aprovado_ComTeste_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ============================================== -->
      <!-- PENDENTE: Fallback                            -->
      <!-- ============================================== -->
      <rule id="Rule_UNN_008_Pendente_Fallback">
        <description>Pendente - Requer analise manual por auditor</description>
        <inputEntry id="IE_Pend_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend_4"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend_2"><text>"Caso requer analise manual por auditor cardiologico para avaliacao de indicacao de cateterismo."</text></outputEntry>
        <outputEntry id="OE_Pend_3"><text>"Auditoria cardiologica - Processo manual"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Pendente_Fallback_4"><text>"DOC"</text></outputEntry>
        <outputEntry id="OE_Rule_UNN_008_Pendente_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
