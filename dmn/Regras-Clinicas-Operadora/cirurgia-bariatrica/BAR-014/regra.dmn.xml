<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_BAR014"
             name="Balao Intragastrico"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    TUSS: BAR-014
    Procedimento: Balao Intragastrico (BIG) - Implante e Remocao
    Especialidade: Cirurgia Bariatrica / Endoscopia
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES CLINICAS (SBCBM 2022, ASGE 2020):
    - IMC 30-40 com comorbidades para preparo pre-bariatrica
    - IMC 27-30 com comorbidades para tratamento clinico
    - Preparo pre-operatorio para super-obesos (IMC >50)
    - Pacientes sem indicacao cirurgica ou que recusam cirurgia

    DURACAO MAXIMA:
    - 6 meses (maioria dos dispositivos)
    - 12 meses (dispositivos especificos)

    REFERENCIAS TECNICAS:
    - SBCBM 2022 - Terapeutica Endoscopica da Obesidade
    - ASGE Position Statement on BIG 2020
    - IFSO Endoscopic Guidelines 2021

    ===============================================================================
  -->

  <decision id="Decision_BAR014" name="Regra Clinica - Balao Intragastrico">
    <decisionTable id="DecisionTable_BAR014" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_indicacaoBalao" label="Indicacao do Balao" camunda:inputVariable="indicacaoBalao">
        <inputExpression id="InputExpression_indicacaoBalao" typeRef="string">
          <text>indicacaoBalao</text>
        </inputExpression>
        <inputValues id="InputValues_indicacaoBalao">
          <text>"PreparoPreBariatrica","TratamentoClinico","PreparoSuperObeso","RecusaCirurgia","PonteBridge"</text>
        </inputValues>
      </input>

      <input id="Input_imcAtual" label="IMC Atual" camunda:inputVariable="imcAtual">
        <inputExpression id="InputExpression_imcAtual" typeRef="number">
          <text>imcAtual</text>
        </inputExpression>
      </input>

      <input id="Input_comorbidades" label="Comorbidades Presentes" camunda:inputVariable="comorbidades">
        <inputExpression id="InputExpression_comorbidades" typeRef="string">
          <text>comorbidades</text>
        </inputExpression>
        <inputValues id="InputValues_comorbidades">
          <text>"Multiplas","DM2","HAS","Dislipidemia","ApneiaSono","Nenhuma"</text>
        </inputValues>
      </input>

      <input id="Input_cirurgiaGastricaPrevia" label="Cirurgia Gastrica Previa" camunda:inputVariable="cirurgiaGastricaPrevia">
        <inputExpression id="InputExpression_cirurgiaGastricaPrevia" typeRef="boolean">
          <text>cirurgiaGastricaPrevia</text>
        </inputExpression>
      </input>

      <input id="Input_acompanhamentoNutricional" label="Acompanhamento Nutricional" camunda:inputVariable="acompanhamentoNutricional">
        <inputExpression id="InputExpression_acompanhamentoNutricional" typeRef="string">
          <text>acompanhamentoNutricional</text>
        </inputExpression>
        <inputValues id="InputValues_acompanhamentoNutricional">
          <text>"Garantido","Parcial","NaoGarantido"</text>
        </inputValues>
      </input>

      <!-- ========== OUTPUTS (3 - Padrao TIER-1) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== RULES ========== -->

      <!-- CONTRAINDICACOES -->
      <rule id="Rule_Contraind_CirurgiaGastricaPrevia">
        <description>Contraindicacao: Cirurgia gastrica previa</description>
        <inputEntry id="InputEntry_CG_1"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_CG_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_CG_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_CG_4"><text>true</text></inputEntry>
        <inputEntry id="InputEntry_CG_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_CG_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_CG_observacao"><text>"Cirurgia gastrica previa e contraindicacao para balao intragastrico"</text></outputEntry>
        <outputEntry id="OutputEntry_CG_fundamentacao"><text>"ASGE 2020 - BIG contraindicado em anatomia gastrica alterada"</text></outputEntry>
      <outputEntry id="OE_Contraind_CirurgiaGastricaPrevia_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Contraind_CirurgiaGastricaPrevia_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraind_IMCBaixo">
        <description>Contraindicacao: IMC muito baixo para BIG</description>
        <inputEntry id="InputEntry_IB_1"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_IB_2"><text>&lt; 27</text></inputEntry>
        <inputEntry id="InputEntry_IB_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_IB_4"><text>false</text></inputEntry>
        <inputEntry id="InputEntry_IB_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_IB_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_IB_observacao"><text>"IMC &lt;27 - balao intragastrico nao indicado"</text></outputEntry>
        <outputEntry id="OutputEntry_IB_fundamentacao"><text>"SBCBM 2022, ASGE 2020 - BIG indicado para IMC minimo de 27 com comorbidades"</text></outputEntry>
      <outputEntry id="OE_Contraind_IMCBaixo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Contraind_IMCBaixo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraind_SemAcompanhamento">
        <description>Contraindicacao: Sem garantia de acompanhamento</description>
        <inputEntry id="InputEntry_SA_1"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_SA_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_SA_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_SA_4"><text>false</text></inputEntry>
        <inputEntry id="InputEntry_SA_5"><text>"NaoGarantido"</text></inputEntry>
        <outputEntry id="OutputEntry_SA_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_SA_observacao"><text>"Acompanhamento nutricional obrigatorio durante periodo do balao"</text></outputEntry>
        <outputEntry id="OutputEntry_SA_fundamentacao"><text>"SBCBM 2022 - BIG sem acompanhamento tem taxa de sucesso muito baixa"</text></outputEntry>
      <outputEntry id="OE_Contraind_SemAcompanhamento_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Contraind_SemAcompanhamento_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- APROVACOES -->
      <rule id="Rule_Aprovado_PreparoSuperObeso">
        <description>Aprovado: Preparo pre-op para super-obeso</description>
        <inputEntry id="InputEntry_PS_1"><text>"PreparoSuperObeso","PreparoPreBariatrica"</text></inputEntry>
        <inputEntry id="InputEntry_PS_2"><text>&gt;= 50</text></inputEntry>
        <inputEntry id="InputEntry_PS_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_PS_4"><text>false</text></inputEntry>
        <inputEntry id="InputEntry_PS_5"><text>"Garantido"</text></inputEntry>
        <outputEntry id="OutputEntry_PS_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_PS_observacao"><text>"Super-obesidade - balao como ponte para cirurgia bariatrica definitiva"</text></outputEntry>
        <outputEntry id="OutputEntry_PS_fundamentacao"><text>"SBCBM 2022, IFSO 2021 - BIG reduz risco cirurgico em super-obesos antes de cirurgia definitiva"</text></outputEntry>
      <outputEntry id="OE_Aprovado_PreparoSuperObeso_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_PreparoSuperObeso_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_PreparoBariatrica">
        <description>Aprovado: Preparo pre-bariatrica</description>
        <inputEntry id="InputEntry_PB_1"><text>"PreparoPreBariatrica","PonteBridge"</text></inputEntry>
        <inputEntry id="InputEntry_PB_2"><text>[40..50]</text></inputEntry>
        <inputEntry id="InputEntry_PB_3"><text>"Multiplas"</text></inputEntry>
        <inputEntry id="InputEntry_PB_4"><text>false</text></inputEntry>
        <inputEntry id="InputEntry_PB_5"><text>"Garantido"</text></inputEntry>
        <outputEntry id="OutputEntry_PB_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_PB_observacao"><text>"Obesidade grau III com multiplas comorbidades - BIG para otimizacao pre-cirurgica"</text></outputEntry>
        <outputEntry id="OutputEntry_PB_fundamentacao"><text>"SBCBM 2022 - Perda de 10-15% do peso melhora condicoes cirurgicas"</text></outputEntry>
      <outputEntry id="OE_Aprovado_PreparoBariatrica_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_PreparoBariatrica_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_TratamentoClinico">
        <description>Aprovado: Tratamento clinico IMC 27-40</description>
        <inputEntry id="InputEntry_TC_1"><text>"TratamentoClinico","RecusaCirurgia"</text></inputEntry>
        <inputEntry id="InputEntry_TC_2"><text>[27..40]</text></inputEntry>
        <inputEntry id="InputEntry_TC_3"><text>not("Nenhuma")</text></inputEntry>
        <inputEntry id="InputEntry_TC_4"><text>false</text></inputEntry>
        <inputEntry id="InputEntry_TC_5"><text>"Garantido"</text></inputEntry>
        <outputEntry id="OutputEntry_TC_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_TC_observacao"><text>"Obesidade grau I-II com comorbidades - BIG como tratamento clinico"</text></outputEntry>
        <outputEntry id="OutputEntry_TC_fundamentacao"><text>"ASGE 2020, SBCBM 2022 - BIG indicado para obesidade com comorbidades em pacientes nao-cirurgicos"</text></outputEntry>
      <outputEntry id="OE_Aprovado_TratamentoClinico_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_TratamentoClinico_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REPROVACOES -->
      <rule id="Rule_Reprovado_SemComorbidades">
        <description>Reprovado: Obesidade sem comorbidades IMC &lt;35</description>
        <inputEntry id="InputEntry_SC_1"><text>"TratamentoClinico"</text></inputEntry>
        <inputEntry id="InputEntry_SC_2"><text>[27..35]</text></inputEntry>
        <inputEntry id="InputEntry_SC_3"><text>"Nenhuma"</text></inputEntry>
        <inputEntry id="InputEntry_SC_4"><text>false</text></inputEntry>
        <inputEntry id="InputEntry_SC_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_SC_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_SC_observacao"><text>"IMC 27-35 sem comorbidades - tratamento conservador indicado"</text></outputEntry>
        <outputEntry id="OutputEntry_SC_fundamentacao"><text>"SBCBM 2022 - BIG requer comorbidades para indicacao em IMC &lt;35"</text></outputEntry>
      <outputEntry id="OE_Reprovado_SemComorbidades_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_SemComorbidades_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- PENDENTE -->
      <rule id="Rule_Pendente_AcompanhamentoParcial">
        <description>Pendente: Acompanhamento parcial garantido</description>
        <inputEntry id="InputEntry_AP_1"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AP_2"><text>&gt;= 27</text></inputEntry>
        <inputEntry id="InputEntry_AP_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AP_4"><text>false</text></inputEntry>
        <inputEntry id="InputEntry_AP_5"><text>"Parcial"</text></inputEntry>
        <outputEntry id="OutputEntry_AP_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OutputEntry_AP_observacao"><text>"Garantir acompanhamento nutricional completo durante periodo do balao"</text></outputEntry>
        <outputEntry id="OutputEntry_AP_fundamentacao"><text>"SBCBM 2022 - Sucesso do BIG depende de acompanhamento multidisciplinar intensivo"</text></outputEntry>
      <outputEntry id="OE_Pendente_AcompanhamentoParcial_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Pendente_AcompanhamentoParcial_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- FALLBACK RULE -->
      <rule id="Rule_Fallback_BAR014">
        <description>Regra padrao - Analise adicional necessaria</description>
        <inputEntry id="InputEntry_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_Fallback_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OutputEntry_Fallback_observacao"><text>"Avaliar indicacao especifica com equipe de endoscopia bariatrica"</text></outputEntry>
        <outputEntry id="OutputEntry_Fallback_fundamentacao"><text>"ASGE 2020, SBCBM 2022 - Indicacao de BIG requer avaliacao individualizada"</text></outputEntry>
      <outputEntry id="OE_Fallback_BAR014_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_BAR014_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
