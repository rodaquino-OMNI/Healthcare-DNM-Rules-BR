<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_BAR010"
             name="Hernia Incisional Pos-Bariatrica"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    TUSS: BAR-010
    Procedimento: Correcao de Hernia Incisional Pos-Cirurgia Bariatrica
    Especialidade: Cirurgia Bariatrica / Cirurgia Geral
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES CLINICAS (SBCBM 2022, EHS 2020):
    - Hernia incisional sintomatica
    - Defeito >2cm com risco de encarceramento
    - Hernia encarcerada ou estrangulada (urgencia)
    - Dor cronica relacionada a hernia

    CLASSIFICACAO EHS:
    - Pequena: <4cm
    - Media: 4-10cm
    - Grande: >10cm

    REFERENCIAS TECNICAS:
    - SBCBM 2022 - Complicacoes Pos-Operatorias
    - EHS (European Hernia Society) Guidelines 2020
    - SAGES Ventral Hernia Guidelines 2019

    ===============================================================================
  -->

  <decision id="Decision_BAR010" name="Regra Clinica - Hernia Incisional Pos-Bariatrica">
    <decisionTable id="DecisionTable_BAR010" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_apresentacaoHernia" label="Apresentacao da Hernia" camunda:inputVariable="apresentacaoHernia">
        <inputExpression id="InputExpression_apresentacaoHernia" typeRef="string">
          <text>apresentacaoHernia</text>
        </inputExpression>
        <inputValues id="InputValues_apresentacaoHernia">
          <text>"Estrangulada","Encarcerada","Sintomatica","Assintomatica"</text>
        </inputValues>
      </input>

      <input id="Input_tamanhoDefeito" label="Tamanho do Defeito (cm)" camunda:inputVariable="tamanhoDefeito">
        <inputExpression id="InputExpression_tamanhoDefeito" typeRef="number">
          <text>tamanhoDefeito</text>
        </inputExpression>
      </input>

      <input id="Input_imcAtual" label="IMC Atual" camunda:inputVariable="imcAtual">
        <inputExpression id="InputExpression_imcAtual" typeRef="number">
          <text>imcAtual</text>
        </inputExpression>
      </input>

      <input id="Input_pesoEstavel" label="Peso Estavel (meses)" camunda:inputVariable="pesoEstavel">
        <inputExpression id="InputExpression_pesoEstavel" typeRef="number">
          <text>pesoEstavel</text>
        </inputExpression>
      </input>

      <input id="Input_comorbidadesControladas" label="Comorbidades Controladas" camunda:inputVariable="comorbidadesControladas">
        <inputExpression id="InputExpression_comorbidadesControladas" typeRef="boolean">
          <text>comorbidadesControladas</text>
        </inputExpression>
      </input>

      <!-- ========== OUTPUTS (3 - Padrao TIER-1) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== RULES ========== -->

      <!-- APROVACOES EMERGENCIAIS -->
      <rule id="Rule_Aprovado_Estrangulada">
        <description>Aprovado Emergencial: Hernia estrangulada</description>
        <inputEntry id="InputEntry_EST_1"><text>"Estrangulada"</text></inputEntry>
        <inputEntry id="InputEntry_EST_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_EST_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_EST_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_EST_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_EST_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_EST_observacao"><text>"EMERGENCIA - Hernia estrangulada requer cirurgia imediata pelo risco de necrose intestinal"</text></outputEntry>
        <outputEntry id="OutputEntry_EST_fundamentacao"><text>"EHS 2020, SAGES 2019 - Estrangulamento e emergencia cirurgica absoluta"</text></outputEntry>
      <outputEntry id="OE_Aprovado_Estrangulada_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_Estrangulada_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_Encarcerada">
        <description>Aprovado Urgente: Hernia encarcerada</description>
        <inputEntry id="InputEntry_ENC_1"><text>"Encarcerada"</text></inputEntry>
        <inputEntry id="InputEntry_ENC_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_ENC_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_ENC_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_ENC_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_ENC_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_ENC_observacao"><text>"URGENTE - Hernia encarcerada com risco de progressao para estrangulamento"</text></outputEntry>
        <outputEntry id="OutputEntry_ENC_fundamentacao"><text>"EHS 2020 - Encarceramento requer reducao e correcao urgente"</text></outputEntry>
      <outputEntry id="OE_Aprovado_Encarcerada_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_Encarcerada_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- APROVACOES ELETIVAS -->
      <rule id="Rule_Aprovado_Sintomatica_Grande">
        <description>Aprovado: Hernia sintomatica grande com peso estavel</description>
        <inputEntry id="InputEntry_SG_1"><text>"Sintomatica"</text></inputEntry>
        <inputEntry id="InputEntry_SG_2"><text>&gt;= 10</text></inputEntry>
        <inputEntry id="InputEntry_SG_3"><text>&lt;= 35</text></inputEntry>
        <inputEntry id="InputEntry_SG_4"><text>&gt;= 6</text></inputEntry>
        <inputEntry id="InputEntry_SG_5"><text>true</text></inputEntry>
        <outputEntry id="OutputEntry_SG_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_SG_observacao"><text>"Hernia incisional grande (&gt;10cm) sintomatica - correcao com tela indicada"</text></outputEntry>
        <outputEntry id="OutputEntry_SG_fundamentacao"><text>"EHS 2020, SBCBM 2022 - Hernias grandes requerem correcao com reforco protetico"</text></outputEntry>
      <outputEntry id="OE_Aprovado_Sintomatica_Grande_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_Sintomatica_Grande_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_Sintomatica_Media">
        <description>Aprovado: Hernia sintomatica media com bom preparo</description>
        <inputEntry id="InputEntry_SM_1"><text>"Sintomatica"</text></inputEntry>
        <inputEntry id="InputEntry_SM_2"><text>[4..10]</text></inputEntry>
        <inputEntry id="InputEntry_SM_3"><text>&lt;= 35</text></inputEntry>
        <inputEntry id="InputEntry_SM_4"><text>&gt;= 6</text></inputEntry>
        <inputEntry id="InputEntry_SM_5"><text>true</text></inputEntry>
        <outputEntry id="OutputEntry_SM_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_SM_observacao"><text>"Hernia incisional media (4-10cm) sintomatica - correcao eletiva indicada"</text></outputEntry>
        <outputEntry id="OutputEntry_SM_fundamentacao"><text>"EHS 2020, SAGES 2019 - Hernia sintomatica media tem indicacao de correcao eletiva"</text></outputEntry>
      <outputEntry id="OE_Aprovado_Sintomatica_Media_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_Sintomatica_Media_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_Sintomatica_Pequena">
        <description>Aprovado: Hernia sintomatica pequena</description>
        <inputEntry id="InputEntry_SP_1"><text>"Sintomatica"</text></inputEntry>
        <inputEntry id="InputEntry_SP_2"><text>&lt; 4</text></inputEntry>
        <inputEntry id="InputEntry_SP_3"><text>&lt;= 32</text></inputEntry>
        <inputEntry id="InputEntry_SP_4"><text>&gt;= 12</text></inputEntry>
        <inputEntry id="InputEntry_SP_5"><text>true</text></inputEntry>
        <outputEntry id="OutputEntry_SP_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_SP_observacao"><text>"Hernia pequena (&lt;4cm) sintomatica com peso otimizado - correcao indicada"</text></outputEntry>
        <outputEntry id="OutputEntry_SP_fundamentacao"><text>"SBCBM 2022 - Hernia pequena em paciente bariatrico com peso estabilizado pode ser corrigida"</text></outputEntry>
      <outputEntry id="OE_Aprovado_Sintomatica_Pequena_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_Sintomatica_Pequena_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- CONTRAINDICACOES -->
      <rule id="Rule_Contraind_IMCMuitoAlto">
        <description>Contraindicacao: IMC muito elevado para cirurgia eletiva</description>
        <inputEntry id="InputEntry_IMC_1"><text>"Sintomatica","Assintomatica"</text></inputEntry>
        <inputEntry id="InputEntry_IMC_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_IMC_3"><text>&gt; 40</text></inputEntry>
        <inputEntry id="InputEntry_IMC_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_IMC_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_IMC_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_IMC_observacao"><text>"IMC &gt;40 - aguardar perda de peso adicional antes de correcao eletiva"</text></outputEntry>
        <outputEntry id="OutputEntry_IMC_fundamentacao"><text>"EHS 2020, SBCBM 2022 - IMC elevado aumenta risco de recidiva e complicacoes"</text></outputEntry>
      <outputEntry id="OE_Contraind_IMCMuitoAlto_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Contraind_IMCMuitoAlto_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraind_PesoInstavel">
        <description>Contraindicacao: Peso ainda instavel</description>
        <inputEntry id="InputEntry_PI_1"><text>"Sintomatica","Assintomatica"</text></inputEntry>
        <inputEntry id="InputEntry_PI_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_PI_3"><text>[32..40]</text></inputEntry>
        <inputEntry id="InputEntry_PI_4"><text>&lt; 6</text></inputEntry>
        <inputEntry id="InputEntry_PI_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_PI_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_PI_observacao"><text>"Peso instavel - aguardar minimo 6 meses de estabilidade ponderal"</text></outputEntry>
        <outputEntry id="OutputEntry_PI_fundamentacao"><text>"SBCBM 2022 - Estabilidade ponderal reduz tensao na parede abdominal e risco de recidiva"</text></outputEntry>
      <outputEntry id="OE_Contraind_PesoInstavel_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Contraind_PesoInstavel_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Contraind_Assintomatica_Pequena">
        <description>Contraindicacao: Hernia assintomatica pequena</description>
        <inputEntry id="InputEntry_AP_1"><text>"Assintomatica"</text></inputEntry>
        <inputEntry id="InputEntry_AP_2"><text>&lt; 2</text></inputEntry>
        <inputEntry id="InputEntry_AP_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AP_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AP_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_AP_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_AP_observacao"><text>"Hernia assintomatica pequena (&lt;2cm) - observacao clinica, sem indicacao cirurgica"</text></outputEntry>
        <outputEntry id="OutputEntry_AP_fundamentacao"><text>"EHS 2020 - Hernias assintomaticas pequenas podem ser manejadas conservadoramente"</text></outputEntry>
      <outputEntry id="OE_Contraind_Assintomatica_Pequena_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Contraind_Assintomatica_Pequena_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- PENDENTE -->
      <rule id="Rule_Pendente_ComorbidadesNaoControladas">
        <description>Pendente: Comorbidades nao otimizadas</description>
        <inputEntry id="InputEntry_CNC_1"><text>"Sintomatica"</text></inputEntry>
        <inputEntry id="InputEntry_CNC_2"><text>&gt;= 4</text></inputEntry>
        <inputEntry id="InputEntry_CNC_3"><text>&lt;= 35</text></inputEntry>
        <inputEntry id="InputEntry_CNC_4"><text>&gt;= 6</text></inputEntry>
        <inputEntry id="InputEntry_CNC_5"><text>false</text></inputEntry>
        <outputEntry id="OutputEntry_CNC_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OutputEntry_CNC_observacao"><text>"Otimizar controle de diabetes, hipertensao e outras comorbidades antes da cirurgia"</text></outputEntry>
        <outputEntry id="OutputEntry_CNC_fundamentacao"><text>"EHS 2020 - Controle de comorbidades reduz risco de complicacoes pos-operatorias"</text></outputEntry>
      <outputEntry id="OE_Pendente_ComorbidadesNaoControladas_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Pendente_ComorbidadesNaoControladas_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- FALLBACK RULE -->
      <rule id="Rule_Fallback_BAR010">
        <description>Regra padrao - Analise adicional necessaria</description>
        <inputEntry id="InputEntry_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_Fallback_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OutputEntry_Fallback_observacao"><text>"Caso requer avaliacao individualizada por cirurgiao de parede abdominal"</text></outputEntry>
        <outputEntry id="OutputEntry_Fallback_fundamentacao"><text>"EHS 2020, SBCBM 2022 - Hernias complexas pos-bariatrica requerem planejamento especializado"</text></outputEntry>
      <outputEntry id="OE_Fallback_BAR010_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_BAR010_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
