<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_REC011"
             name="Reconstrucao Genitalia"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    TUSS: REC-011
    Procedimento: Reconstrucao de Genitalia
    Especialidade: Cirurgia Reconstrutiva / Urologia / Cirurgia Plastica
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES CLINICAS (SBU 2022, SBCP 2022, CFM 2023):
    - Reconstrucao pos-trauma genital
    - Reconstrucao pos-resseccao oncologica
    - Hipospadia complexa
    - Extrofia vesical
    - Cirurgia de afirmacao de genero (conforme CFM)

    CONSIDERACOES:
    - Impacto funcional: urinario e sexual
    - Impacto psicologico significativo
    - Equipe multidisciplinar necessaria

    REFERENCIAS TECNICAS:
    - SBU 2022 - Urologia Reconstrutiva
    - SBCP 2022 - Reconstrucao Genital
    - CFM 2265/2019 - Cirurgia de Afirmacao de Genero
    - EAU 2023 - Urological Trauma Guidelines

    ===============================================================================
  -->

  <decision id="Decision_REC011" name="Regra Clinica - Reconstrucao Genitalia">
    <decisionTable id="DecisionTable_REC011" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_indicacaoReconstrucao" label="Indicacao da Reconstrucao" camunda:inputVariable="indicacaoReconstrucao">
        <inputExpression id="InputExpression_indicacaoReconstrucao" typeRef="string">
          <text>indicacaoReconstrucao</text>
        </inputExpression>
        <inputValues id="InputValues_indicacaoReconstrucao">
          <text>"TraumaGenital","ResseccaoOncologica","HipospadiaComplexa","ExtrofiaVesical","AfirmacaoGenero","MalformacaoCongenita"</text>
        </inputValues>
      </input>

      <input id="Input_sexoBiologico" label="Sexo Biologico" camunda:inputVariable="sexoBiologico">
        <inputExpression id="InputExpression_sexoBiologico" typeRef="string">
          <text>sexoBiologico</text>
        </inputExpression>
        <inputValues id="InputValues_sexoBiologico">
          <text>"Masculino","Feminino","Intersexo"</text>
        </inputValues>
      </input>

      <input id="Input_idadePaciente" label="Idade do Paciente (anos)" camunda:inputVariable="idadePaciente">
        <inputExpression id="InputExpression_idadePaciente" typeRef="number">
          <text>idadePaciente</text>
        </inputExpression>
      </input>

      <input id="Input_avaliacaoMultidisciplinar" label="Avaliacao Multidisciplinar" camunda:inputVariable="avaliacaoMultidisciplinar">
        <inputExpression id="InputExpression_avaliacaoMultidisciplinar" typeRef="string">
          <text>avaliacaoMultidisciplinar</text>
        </inputExpression>
        <inputValues id="InputValues_avaliacaoMultidisciplinar">
          <text>"CompletaAprovada","EmAndamento","NaoRealizada"</text>
        </inputValues>
      </input>

      <input id="Input_procedimentoProposto" label="Procedimento Proposto" camunda:inputVariable="procedimentoProposto">
        <inputExpression id="InputExpression_procedimentoProposto" typeRef="string">
          <text>procedimentoProposto</text>
        </inputExpression>
        <inputValues id="InputValues_procedimentoProposto">
          <text>"Uretroplastia","Faloplastia","Vaginoplastia","ReconstrucaoPeniana","ReconstrucaoEscrotal","ReconstrucaoVulvar"</text>
        </inputValues>
      </input>

      <!-- ========== OUTPUTS (3 - Padrao TIER-1) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== RULES ========== -->

      <!-- APROVACOES URGENTES -->
      <rule id="Rule_Aprovado_TraumaGenitalAgudo">
        <description>Aprovado Urgente: Trauma genital agudo</description>
        <inputEntry id="InputEntry_TGA_1"><text>"TraumaGenital"</text></inputEntry>
        <inputEntry id="InputEntry_TGA_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_TGA_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_TGA_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_TGA_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_TGA_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_TGA_observacao"><text>"URGENTE - Trauma genital requer exploracao e reconstrucao imediata"</text></outputEntry>
        <outputEntry id="OutputEntry_TGA_fundamentacao"><text>"EAU 2023, SBU 2022 - Trauma genital e urgencia urologica"</text></outputEntry>
      <outputEntry id="OE_Aprovado_TraumaGenitalAgudo_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_TraumaGenitalAgudo_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- APROVACOES ELETIVAS - POS-ONCOLOGICO -->
      <rule id="Rule_Aprovado_PosResseccaoOncologica">
        <description>Aprovado: Reconstrucao pos-resseccao oncologica</description>
        <inputEntry id="InputEntry_PRO_1"><text>"ResseccaoOncologica"</text></inputEntry>
        <inputEntry id="InputEntry_PRO_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_PRO_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_PRO_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_PRO_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_PRO_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_PRO_observacao"><text>"Reconstrucao genital apos resseccao oncologica - funcional e psicologica"</text></outputEntry>
        <outputEntry id="OutputEntry_PRO_fundamentacao"><text>"SBCP 2022, SBU 2022 - Reconstrucao pos-oncologica e parte do tratamento"</text></outputEntry>
      <outputEntry id="OE_Aprovado_PosResseccaoOncologica_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_PosResseccaoOncologica_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- APROVACOES - MALFORMACOES -->
      <rule id="Rule_Aprovado_HipospadiaComplexa">
        <description>Aprovado: Hipospadia complexa</description>
        <inputEntry id="InputEntry_HC_1"><text>"HipospadiaComplexa"</text></inputEntry>
        <inputEntry id="InputEntry_HC_2"><text>"Masculino"</text></inputEntry>
        <inputEntry id="InputEntry_HC_3"><text>&gt;= 1</text></inputEntry>
        <inputEntry id="InputEntry_HC_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_HC_5"><text>"Uretroplastia"</text></inputEntry>
        <outputEntry id="OutputEntry_HC_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_HC_observacao"><text>"Correcao de hipospadia para funcao urinaria e desenvolvimento normal"</text></outputEntry>
        <outputEntry id="OutputEntry_HC_fundamentacao"><text>"SBU 2022 - Hipospadia deve ser corrigida idealmente entre 6-18 meses"</text></outputEntry>
      <outputEntry id="OE_Aprovado_HipospadiaComplexa_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_HipospadiaComplexa_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_ExtrofiaVesical">
        <description>Aprovado: Reconstrucao em extrofia vesical</description>
        <inputEntry id="InputEntry_EV_1"><text>"ExtrofiaVesical"</text></inputEntry>
        <inputEntry id="InputEntry_EV_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_EV_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_EV_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_EV_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_EV_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_EV_observacao"><text>"Reconstrucao em extrofia vesical - tratamento multistagio"</text></outputEntry>
        <outputEntry id="OutputEntry_EV_fundamentacao"><text>"SBU 2022 - Extrofia requer reconstrucao em centro especializado"</text></outputEntry>
      <outputEntry id="OE_Aprovado_ExtrofiaVesical_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_ExtrofiaVesical_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- APROVACOES - AFIRMACAO DE GENERO (CFM) -->
      <rule id="Rule_Aprovado_AfirmacaoGeneroCompleto">
        <description>Aprovado: Cirurgia de afirmacao de genero com protocolo completo</description>
        <inputEntry id="InputEntry_AGC_1"><text>"AfirmacaoGenero"</text></inputEntry>
        <inputEntry id="InputEntry_AGC_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AGC_3"><text>&gt;= 21</text></inputEntry>
        <inputEntry id="InputEntry_AGC_4"><text>"CompletaAprovada"</text></inputEntry>
        <inputEntry id="InputEntry_AGC_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_AGC_resultado"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_AGC_observacao"><text>"Cirurgia de afirmacao de genero - protocolo CFM cumprido integralmente"</text></outputEntry>
        <outputEntry id="OutputEntry_AGC_fundamentacao"><text>"CFM 2265/2019 - Cirurgia apos 2 anos de acompanhamento e idade minima 21 anos"</text></outputEntry>
      <outputEntry id="OE_Aprovado_AfirmacaoGeneroCompleto_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_AfirmacaoGeneroCompleto_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REPROVACOES -->
      <rule id="Rule_Reprovado_AfirmacaoGeneroIdade">
        <description>Reprovado: Afirmacao de genero - idade insuficiente</description>
        <inputEntry id="InputEntry_AGI_1"><text>"AfirmacaoGenero"</text></inputEntry>
        <inputEntry id="InputEntry_AGI_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AGI_3"><text>&lt; 21</text></inputEntry>
        <inputEntry id="InputEntry_AGI_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AGI_5"><text>"Faloplastia","Vaginoplastia"</text></inputEntry>
        <outputEntry id="OutputEntry_AGI_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_AGI_observacao"><text>"Idade minima 21 anos para procedimentos irreversiveis de afirmacao de genero"</text></outputEntry>
        <outputEntry id="OutputEntry_AGI_fundamentacao"><text>"CFM 2265/2019 - Cirurgias genitais so apos 21 anos"</text></outputEntry>
      <outputEntry id="OE_Reprovado_AfirmacaoGeneroIdade_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_AfirmacaoGeneroIdade_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_AfirmacaoGeneroSemProtocolo">
        <description>Reprovado: Afirmacao de genero sem acompanhamento</description>
        <inputEntry id="InputEntry_AGSP_1"><text>"AfirmacaoGenero"</text></inputEntry>
        <inputEntry id="InputEntry_AGSP_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AGSP_3"><text>&gt;= 21</text></inputEntry>
        <inputEntry id="InputEntry_AGSP_4"><text>"NaoRealizada"</text></inputEntry>
        <inputEntry id="InputEntry_AGSP_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_AGSP_resultado"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OutputEntry_AGSP_observacao"><text>"Obrigatorio acompanhamento multidisciplinar por minimo 2 anos"</text></outputEntry>
        <outputEntry id="OutputEntry_AGSP_fundamentacao"><text>"CFM 2265/2019 - Protocolo de 2 anos com psiquiatra, psicologo, endocrino, assistente social"</text></outputEntry>
      <outputEntry id="OE_Reprovado_AfirmacaoGeneroSemProtocolo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_AfirmacaoGeneroSemProtocolo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- PENDENTE -->
      <rule id="Rule_Pendente_AfirmacaoGeneroEmAndamento">
        <description>Pendente: Protocolo de afirmacao de genero em andamento</description>
        <inputEntry id="InputEntry_AGEA_1"><text>"AfirmacaoGenero"</text></inputEntry>
        <inputEntry id="InputEntry_AGEA_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_AGEA_3"><text>&gt;= 18</text></inputEntry>
        <inputEntry id="InputEntry_AGEA_4"><text>"EmAndamento"</text></inputEntry>
        <inputEntry id="InputEntry_AGEA_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_AGEA_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OutputEntry_AGEA_observacao"><text>"Continuar acompanhamento multidisciplinar - cirurgia apos 2 anos completos"</text></outputEntry>
        <outputEntry id="OutputEntry_AGEA_fundamentacao"><text>"CFM 2265/2019 - Minimo 2 anos de acompanhamento antes de cirurgia genital"</text></outputEntry>
      <outputEntry id="OE_Pendente_AfirmacaoGeneroEmAndamento_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Pendente_AfirmacaoGeneroEmAndamento_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- FALLBACK RULE -->
      <rule id="Rule_Fallback_REC011">
        <description>Regra padrao - Analise adicional necessaria</description>
        <inputEntry id="InputEntry_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="InputEntry_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OutputEntry_Fallback_resultado"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OutputEntry_Fallback_observacao"><text>"Avaliar com equipe multidisciplinar de reconstrucao genital"</text></outputEntry>
        <outputEntry id="OutputEntry_Fallback_fundamentacao"><text>"SBU 2022, SBCP 2022 - Reconstrucao genital requer avaliacao especializada"</text></outputEntry>
      <outputEntry id="OE_Fallback_REC011_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_REC011_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
