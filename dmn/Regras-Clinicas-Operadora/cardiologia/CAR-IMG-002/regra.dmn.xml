<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="Definitions_CAR_IMG_002" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.0.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.0.0">
  <decision id="Decision_CAR_IMG_002" name="Ecocardiograma vs Ressonância Cardíaca">
    <decisionTable id="DecisionTable_CAR_IMG_002" hitPolicy="FIRST">
      <input id="Input_clinicalQuestion" label="Questão Clínica Principal">
        <inputExpression id="InputExpression_clinicalQuestion" typeRef="string">
          <text>clinicalQuestion</text>
        </inputExpression>
        <inputValues id="UnaryTests_clinicalQuestion">
          <text>"VALVE","LVEF","MYOCARDITIS","CARDIOMYOPATHY","VIABILITY","MASS","PERICARDIUM","CONGENITAL"</text>
        </inputValues>
      </input>
      <input id="Input_previousEchoResult" label="Resultado Eco Prévio">
        <inputExpression id="InputExpression_previousEchoResult" typeRef="string">
          <text>previousEchoResult</text>
        </inputExpression>
        <inputValues id="UnaryTests_previousEchoResult">
          <text>"CONCLUSIVE","INCONCLUSIVE","NOT_DONE","POOR_WINDOW"</text>
        </inputValues>
      </input>
      <input id="Input_contrastNeed" label="Necessidade Caracterização Tecidual">
        <inputExpression id="InputExpression_contrastNeed" typeRef="boolean">
          <text>needsTissueCharacterization</text>
        </inputExpression>
      </input>
      <input id="Input_gadoliniumContraindication" label="Contraindicação Gadolínio">
        <inputExpression id="InputExpression_gadoliniumContraindication" typeRef="boolean">
          <text>hasGadoliniumContraindication</text>
        </inputExpression>
      </input>
      <input id="Input_urgency" label="Situação Clínica">
        <inputExpression id="InputExpression_urgency" typeRef="string">
          <text>clinicalUrgency</text>
        </inputExpression>
        <inputValues id="UnaryTests_urgency">
          <text>"URGENT","ROUTINE"</text>
        </inputValues>
      </input>
      <output id="Output_resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"APROVADO_ECO","APROVADO_RMC","REPROVADO_RMC","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" name="observacao" typeRef="string"/>
      <output id="Output_fundamentacao" name="fundamentacao" typeRef="string"/>
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdício" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <output id="Output_acaoRecomendada" label="Ação Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- Ecocardiograma Primeira Linha -->
      <rule id="Rule_Echo_ValveDisease">
        <description>Eco indicado: avaliação valvar</description>
        <inputEntry id="UnaryTests_clinicalQuestion_1">
          <text>"VALVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_1">
          <text>"NOT_DONE","CONCLUSIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_1">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_1">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_1">
          <text>"APROVADO_ECO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_1">
          <text>"Ecocardiograma indicado (avaliação valvar). ASE/EACVI: método primeira linha para morfologia, hemodinâmica, quantificação (NE=IA)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_1">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Echo_ValveDisease_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Echo_ValveDisease_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_Echo_LVEF_Routine">
        <description>Eco suficiente: FEVE rotina</description>
        <inputEntry id="UnaryTests_clinicalQuestion_2">
          <text>"LVEF"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_2">
          <text>"NOT_DONE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_2">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_2">
          <text>"ROUTINE","URGENT"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_2">
          <text>"APROVADO_ECO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_2">
          <text>"Ecocardiograma suficiente (FEVE/função VE). Método Simpson biplano acurácia ±5-10%. Custo-efetivo R$200-400 vs RMC R$1500-3000"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_2">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Echo_LVEF_Routine_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Echo_LVEF_Routine_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_Echo_Pericardium_Urgent">
        <description>Eco urgente: derrame pericárdico/tamponamento</description>
        <inputEntry id="UnaryTests_clinicalQuestion_3">
          <text>"PERICARDIUM"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_3">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_3">
          <text>"URGENT"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_3">
          <text>"APROVADO_ECO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_3">
          <text>"Ecocardiograma urgente (suspeita derrame/tamponamento). Método beira-leito, rápido, identifica colapso diastólico VD/AD"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_3">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Echo_Pericardium_Urgent_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Echo_Pericardium_Urgent_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Ressonância Cardíaca Indicações Específicas -->
      <rule id="Rule_CMR_Myocarditis">
        <description>RMC obrigatória: suspeita miocardite</description>
        <inputEntry id="UnaryTests_clinicalQuestion_4">
          <text>"MYOCARDITIS"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_4">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_4">
          <text>"ROUTINE"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_4">
          <text>"APROVADO_RMC"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_4">
          <text>"RMC obrigatória (miocardite). Lake Louise Criteria: edema T2 + realce tardio. Sensibilidade 87%, especificidade 96% (NE=IA)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_4">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CMR_Myocarditis_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CMR_Myocarditis_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_CMR_Cardiomyopathy">
        <description>RMC indicada: caracterização miocardiopatia</description>
        <inputEntry id="UnaryTests_clinicalQuestion_5">
          <text>"CARDIOMYOPATHY"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_5">
          <text>"INCONCLUSIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_5">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_5">
          <text>"ROUTINE"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_5">
          <text>"APROVADO_RMC"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_5">
          <text>"RMC indicada (miocardiopatia dilat/hipertr/restritiva). Padrão realce diferencia etiologia: isquêmica, infiltrativa, inflamatória (NE=IB)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_5">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CMR_Cardiomyopathy_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CMR_Cardiomyopathy_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_CMR_Viability">
        <description>RMC padrão-ouro: viabilidade miocárdica</description>
        <inputEntry id="UnaryTests_clinicalQuestion_6">
          <text>"VIABILITY"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_6">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_6">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_6">
          <text>"ROUTINE"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_6">
          <text>"APROVADO_RMC"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_6">
          <text>"RMC padrão-ouro (viabilidade). Realce tardio &lt;50% transmural = viável. Prediz recuperação pós-revascularização (NE=IA)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_6">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CMR_Viability_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CMR_Viability_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_CMR_Mass">
        <description>RMC indicada: caracterização massa cardíaca</description>
        <inputEntry id="UnaryTests_clinicalQuestion_7">
          <text>"MASS"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_7">
          <text>"INCONCLUSIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_7">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_7">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_7">
          <text>"ROUTINE"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_7">
          <text>"APROVADO_RMC"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_7">
          <text>"RMC indicada (massa cardíaca). Diferencia trombo/tumor/vegetação. Caracterização tecidual por T1/T2/realce (NE=IB)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_7">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CMR_Mass_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CMR_Mass_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_CMR_PoorWindow">
        <description>RMC indicada: janela eco inadequada</description>
        <inputEntry id="UnaryTests_clinicalQuestion_8">
          <text>"LVEF","CARDIOMYOPATHY"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_8">
          <text>"POOR_WINDOW","INCONCLUSIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_8">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_8">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_8">
          <text>"ROUTINE"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_8">
          <text>"APROVADO_RMC"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_8">
          <text>"RMC indicada (eco subótimo). Independente janela acústica. FEVE RMC padrão-ouro (variabilidade &lt;5%) vs eco (10-15%)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_8">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CMR_PoorWindow_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CMR_PoorWindow_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_CMR_Congenital">
        <description>RMC indicada: cardiopatia congênita complexa</description>
        <inputEntry id="UnaryTests_clinicalQuestion_9">
          <text>"CONGENITAL"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_9">
          <text>"INCONCLUSIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_9">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_9">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_9">
          <text>"ROUTINE"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_9">
          <text>"APROVADO_RMC"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_9">
          <text>"RMC indicada (cardiopatia congênita). Anatomia 3D, shunts, fluxo, função biventricular. Seguimento Fallot, TGV, Fontan (NE=IB)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_9">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CMR_Congenital_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CMR_Congenital_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Reprovações RMC -->
      <rule id="Rule_Reject_CMR_GadoliniumContraindication">
        <description>RMC reprovada: contraindicação gadolínio</description>
        <inputEntry id="UnaryTests_clinicalQuestion_10">
          <text>"MYOCARDITIS","VIABILITY","MASS"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_10">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_10">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_10">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_10">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_10">
          <text>"REPROVADO_RMC"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_10">
          <text>"RMC reprovada (contraindicação gadolínio: IRC grave TFG&lt;30). Risco fibrose sistêmica nefrogênica. Alternativa: PET, cintilo"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_10">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Reject_CMR_GadoliniumContraindication_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Reject_CMR_GadoliniumContraindication_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_Reject_CMR_Routine_LVEF">
        <description>RMC reprovada: FEVE rotina com eco adequado</description>
        <inputEntry id="UnaryTests_clinicalQuestion_11">
          <text>"LVEF"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_11">
          <text>"CONCLUSIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_11">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_11">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_11">
          <text>"ROUTINE"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_11">
          <text>"REPROVADO_RMC"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_11">
          <text>"RMC reprovada (eco conclusivo suficiente). Custo 7-15x maior sem benefício clínico adicional para FEVE isolada"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_11">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Reject_CMR_Routine_LVEF_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Reject_CMR_Routine_LVEF_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Pendências -->
      <rule id="Rule_Pending_Urgent_CMR">
        <description>Pendente: urgência relativa para RMC</description>
        <inputEntry id="UnaryTests_clinicalQuestion_12">
          <text>"MYOCARDITIS","CARDIOMYOPATHY"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_12">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_12">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_12">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_12">
          <text>"URGENT"</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_12">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_12">
          <text>"Iniciar eco urgente + troponina/BNP. RMC após estabilização (ideal 1-2 semanas) quando suspeita miocardite/miocardiopatia"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_12">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Pending_Urgent_CMR_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Pending_Urgent_CMR_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Regra de Fallback -->
      <rule id="Rule_Default_Fallback">
        <description>Fallback padrão</description>
        <inputEntry id="UnaryTests_clinicalQuestion_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousEchoResult_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_contrastNeed_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_gadoliniumContraindication_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_urgency_fallback">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_fallback">
          <text>"Necessária avaliação cardiologista/imagem cardíaca. Definir questão clínica e método mais apropriado"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_fallback">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Default_Fallback_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Default_Fallback_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_CAR_IMG_002">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
