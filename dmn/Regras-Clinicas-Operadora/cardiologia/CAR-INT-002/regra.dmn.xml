<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="Definitions_CAR_INT_002" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.0.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.0.0">
  <decision id="Decision_CAR_INT_002" name="FFR Antes de ICP Eletiva">
    <decisionTable id="DecisionTable_CAR_INT_002" hitPolicy="FIRST">
      <input id="Input_stenosisPercent" label="Estenose Angiográfica">
        <inputExpression id="InputExpression_stenosisPercent" typeRef="string">
          <text>stenosisCategory</text>
        </inputExpression>
        <inputValues id="UnaryTests_stenosisPercent">
          <text>"MILD","INTERMEDIATE","SEVERE","CRITICAL"</text>
        </inputValues>
      </input>
      <input id="Input_clinicalContext" label="Contexto Clínico">
        <inputExpression id="InputExpression_clinicalContext" typeRef="string">
          <text>clinicalContext</text>
        </inputExpression>
        <inputValues id="UnaryTests_clinicalContext">
          <text>"ELECTIVE","STABLE_ACS","UNSTABLE_ACS","STEMI"</text>
        </inputValues>
      </input>
      <input id="Input_symptomaticLesion" label="Lesão Relacionada a Sintomas">
        <inputExpression id="InputExpression_symptomaticLesion" typeRef="boolean">
          <text>isSymptomatic</text>
        </inputExpression>
      </input>
      <input id="Input_positiveStressTest" label="Teste Funcional Positivo">
        <inputExpression id="InputExpression_positiveStressTest" typeRef="boolean">
          <text>hasPositiveStressTest</text>
        </inputExpression>
      </input>
      <input id="Input_multiVesselDisease" label="Doença Multiarterial">
        <inputExpression id="InputExpression_multiVesselDisease" typeRef="boolean">
          <text>hasMultiVesselDisease</text>
        </inputExpression>
      </input>
      <output id="Output_resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"APROVADO_FFR_OBRIGATORIO","APROVADO_PCI_SEM_FFR","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" name="observacao" typeRef="string"/>
      <output id="Output_fundamentacao" name="fundamentacao" typeRef="string"/>
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdício" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <output id="Output_acaoRecomendada" label="Ação Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- FFR Obrigatório - Lesões Intermediárias -->
      <rule id="Rule_FFR_Intermediate_Elective">
        <description>FFR obrigatório: lesão intermediária eletiva</description>
        <inputEntry id="UnaryTests_stenosisPercent_1">
          <text>"INTERMEDIATE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_1">
          <text>"ELECTIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_1">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_1">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_1">
          <text>"APROVADO_FFR_OBRIGATORIO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_1">
          <text>"FFR obrigatório (estenose 40-70% sem teste funcional). FAME/DEFER: FFR&gt;0.80 - seguro diferir ICP com redução MACE 30%"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_1">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_FFR_Intermediate_Elective_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_FFR_Intermediate_Elective_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_FFR_MultiVessel">
        <description>FFR obrigatório: multiarterial para guiar estratégia</description>
        <inputEntry id="UnaryTests_stenosisPercent_2">
          <text>"INTERMEDIATE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_2">
          <text>"STABLE_ACS","ELECTIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_2">
          <text>true</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_2">
          <text>"APROVADO_FFR_OBRIGATORIO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_2">
          <text>"FFR obrigatório (multiarterial + lesões intermediárias). FAME 2: FFR guiado reduz revascularização desnecessária 50%"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_2">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_FFR_MultiVessel_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_FFR_MultiVessel_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_FFR_Severe_NoTest">
        <description>FFR recomendado: estenose moderada-grave sem correlação funcional</description>
        <inputEntry id="UnaryTests_stenosisPercent_3">
          <text>"SEVERE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_3">
          <text>"ELECTIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_3">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_3">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_3">
          <text>"APROVADO_FFR_OBRIGATORIO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_3">
          <text>"FFR recomendado (70-90% assintomático). 20% lesões visuais severas têm FFR&gt;0.80. Evitar ICP desnecessária"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_3">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_FFR_Severe_NoTest_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_FFR_Severe_NoTest_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- ICP sem FFR - Indicações Claras -->
      <rule id="Rule_PCI_Critical">
        <description>ICP sem FFR: lesão crítica (&gt;90%)</description>
        <inputEntry id="UnaryTests_stenosisPercent_4">
          <text>"CRITICAL"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_4">
          <text>"APROVADO_PCI_SEM_FFR"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_4">
          <text>"ICP aprovada sem FFR (estenose &gt;90%). ESC: FFR dispensável em lesões críticas com correlação clínica (NE=IIIC)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_4">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_PCI_Critical_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_PCI_Critical_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_PCI_Symptomatic_Positive">
        <description>ICP sem FFR: sintomático + teste positivo</description>
        <inputEntry id="UnaryTests_stenosisPercent_5">
          <text>"SEVERE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_5">
          <text>"ELECTIVE","STABLE_ACS"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_5">
          <text>"APROVADO_PCI_SEM_FFR"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_5">
          <text>"ICP aprovada (sintomático + teste funcional positivo + estenose ≥70%). Correlação anátomo-funcional estabelecida"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_5">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_PCI_Symptomatic_Positive_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_PCI_Symptomatic_Positive_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_PCI_STEMI">
        <description>ICP primária: STEMI - FFR contraindicado</description>
        <inputEntry id="UnaryTests_stenosisPercent_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_6">
          <text>"STEMI"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_6">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_6">
          <text>"APROVADO_PCI_SEM_FFR"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_6">
          <text>"ICP primária aprovada (STEMI). FFR não aplicável em oclusão aguda. Artéria culpada deve ser tratada imediatamente"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_6">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_PCI_STEMI_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_PCI_STEMI_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Reprovações -->
      <rule id="Rule_Reject_Mild">
        <description>ICP reprovada: estenose leve</description>
        <inputEntry id="UnaryTests_stenosisPercent_7">
          <text>"MILD"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_7">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_7">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_7">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_7">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_7">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_7">
          <text>"ICP reprovada (estenose &lt;40%). ACC/AHA: tratamento clínico otimizado indicado. ICP não altera prognóstico"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_7">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Reject_Mild_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Reject_Mild_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reject_Intermediate_NoFFR">
        <description>ICP reprovada: intermediária sem FFR/teste funcional</description>
        <inputEntry id="UnaryTests_stenosisPercent_8">
          <text>"INTERMEDIATE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_8">
          <text>"ELECTIVE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_8">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_8">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_8">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_8">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_8">
          <text>"ICP reprovada sem FFR (lesão 40-70%). SBC: FFR obrigatório - 40% lesões intermediárias não requerem ICP (NE=IA)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_8">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Reject_Intermediate_NoFFR_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Reject_Intermediate_NoFFR_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- Pendências -->
      <rule id="Rule_Pending_UnstableACS">
        <description>Pendente: SCA instável - avaliar vaso culpado</description>
        <inputEntry id="UnaryTests_stenosisPercent_9">
          <text>"INTERMEDIATE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_9">
          <text>"UNSTABLE_ACS"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_9">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_9">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_9">
          <text>true</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_9">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_9">
          <text>"Identificar artéria culpada (ECG, eco, angiografia). Considerar FFR staged para lesões não-culpadas após estabilização"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_9">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Pending_UnstableACS_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Pending_UnstableACS_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Regra de Fallback -->
      <rule id="Rule_Default_Fallback">
        <description>Fallback padrão</description>
        <inputEntry id="UnaryTests_stenosisPercent_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_clinicalContext_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_symptomaticLesion_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_positiveStressTest_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_multiVesselDisease_fallback">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_fallback">
          <text>"Necessária avaliação cardiologista intervencionista. Considerar FFR/iFR para estratificação hemodinâmica"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_fallback">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Default_Fallback_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Default_Fallback_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_CAR_INT_002">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
