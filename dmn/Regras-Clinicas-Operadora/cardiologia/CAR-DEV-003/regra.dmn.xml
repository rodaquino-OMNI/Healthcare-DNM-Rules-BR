<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="Definitions_CAR_DEV_003" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.0.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.0.0">
  <decision id="Decision_CAR_DEV_003" name="Indicação CDI vs Marcapasso">
    <decisionTable id="DecisionTable_CAR_DEV_003" hitPolicy="FIRST">
      <input id="Input_suddenDeathHistory" label="História Morte Súbita/MSC Abortada">
        <inputExpression id="InputExpression_suddenDeathHistory" typeRef="boolean">
          <text>hasSuddenDeathHistory</text>
        </inputExpression>
      </input>
      <input id="Input_lvef" label="FEVE ≤ 35%">
        <inputExpression id="InputExpression_lvef" typeRef="boolean">
          <text>hasReducedLvef</text>
        </inputExpression>
      </input>
      <input id="Input_sustainedVT" label="TV Sustentada Documentada">
        <inputExpression id="InputExpression_sustainedVT" typeRef="boolean">
          <text>hasSustainedVT</text>
        </inputExpression>
      </input>
      <input id="Input_nyhaClass" label="NYHA II-III (IC Sintomática)">
        <inputExpression id="InputExpression_nyhaClass" typeRef="boolean">
          <text>hasHeartFailureSymptoms</text>
        </inputExpression>
      </input>
      <input id="Input_avBlock" label="Bloqueio AV Avançado">
        <inputExpression id="InputExpression_avBlock" typeRef="boolean">
          <text>hasAvBlock</text>
        </inputExpression>
      </input>
      <output id="Output_resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"APROVADO_CDI","APROVADO_MP","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" name="observacao" typeRef="string"/>
      <output id="Output_fundamentacao" name="fundamentacao" typeRef="string"/>
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdício" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <output id="Output_acaoRecomendada" label="Ação Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- CDI - Prevenção Secundária (Classe I) -->
      <rule id="Rule_ICD_Secondary_SCD">
        <description>CDI obrigatório: MSC abortada</description>
        <inputEntry id="UnaryTests_suddenDeathHistory_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_sustainedVT_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_avBlock_1">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_1">
          <text>"APROVADO_CDI"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_1">
          <text>"CDI obrigatório (prevenção secundária - PCR revertida/MSC abortada). ACC/AHA Classe IA: redução mortalidade 50-60%"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_1">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_ICD_Secondary_SCD_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_ICD_Secondary_SCD_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_ICD_Secondary_VT">
        <description>CDI obrigatório: TV sustentada hemodinamicamente instável</description>
        <inputEntry id="UnaryTests_suddenDeathHistory_2">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_sustainedVT_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_avBlock_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_2">
          <text>"APROVADO_CDI"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_2">
          <text>"CDI obrigatório (TV sustentada documentada). ESC Classe IA: prevenção secundária - sobrevida comprovada"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_2">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_ICD_Secondary_VT_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_ICD_Secondary_VT_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- CDI - Prevenção Primária (Classe I/IIA) -->
      <rule id="Rule_ICD_Primary_LVEF_HF">
        <description>CDI indicado: FEVE≤35% + IC sintomática</description>
        <inputEntry id="UnaryTests_suddenDeathHistory_3">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_sustainedVT_3">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_avBlock_3">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_3">
          <text>"APROVADO_CDI"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_3">
          <text>"CDI indicado (prevenção primária - FEVE≤35% + NYHA II-III). SBC: redução mortalidade 23-31% vs terapia clínica (NE=IA)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_3">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_ICD_Primary_LVEF_HF_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_ICD_Primary_LVEF_HF_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_ICD_Primary_LVEF_Only">
        <description>CDI indicado: FEVE≤35% isolada (após 40 dias IAM/90 dias miocardiopatia)</description>
        <inputEntry id="UnaryTests_suddenDeathHistory_4">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_sustainedVT_4">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_4">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_avBlock_4">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_4">
          <text>"APROVADO_CDI"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_4">
          <text>"CDI indicado (FEVE≤35% persistente após período de wash-out). Aguardar 40d pós-IAM ou 90d diagnóstico miocardiopatia"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_4">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_ICD_Primary_LVEF_Only_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_ICD_Primary_LVEF_Only_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Marcapasso - Sem Indicação de CDI -->
      <rule id="Rule_PM_AVBlock_NoICD">
        <description>Marcapasso suficiente: BAV sem critérios CDI</description>
        <inputEntry id="UnaryTests_suddenDeathHistory_5">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_5">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_sustainedVT_5">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_5">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_avBlock_5">
          <text>true</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_5">
          <text>"APROVADO_MP"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_5">
          <text>"Marcapasso convencional indicado (BAV + FEVE&gt;35%). Sem indicação CDI - custo-efetividade desfavorável"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_5">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_PM_AVBlock_NoICD_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_PM_AVBlock_NoICD_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_PM_Bradycardia">
        <description>Marcapasso: bradicardia sintomática sem arritmias ventriculares</description>
        <inputEntry id="UnaryTests_suddenDeathHistory_6">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_6">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_sustainedVT_6">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_6">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_avBlock_6">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_6">
          <text>"APROVADO_MP"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_6">
          <text>"Marcapasso convencional suficiente (bradicardia sintomática + função VE preservada). CDI não indicado"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_6">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_PM_Bradycardia_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_PM_Bradycardia_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Reprovação -->
      <rule id="Rule_ICD_WithAVBlock">
        <description>CDI obrigatório quando há critérios + BAV</description>
        <inputEntry id="UnaryTests_suddenDeathHistory_7">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_7">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_sustainedVT_7">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_7">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_avBlock_7">
          <text>true</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_7">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_7">
          <text>"Marcapasso reprovado. Paciente preenche critérios CDI (FEVE≤35% + IC). Necessário CDI bicameral ou TRC-D"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_7">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_ICD_WithAVBlock_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_ICD_WithAVBlock_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- Regra de Fallback -->
      <rule id="Rule_Default_Fallback">
        <description>Fallback padrão</description>
        <inputEntry id="UnaryTests_suddenDeathHistory_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_sustainedVT_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_avBlock_fallback">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_fallback">
          <text>"Avaliação individualizada necessária. Encaminhar para arritmologista/eletrofisiologista"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_fallback">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Default_Fallback_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Default_Fallback_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_CAR_DEV_003">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
