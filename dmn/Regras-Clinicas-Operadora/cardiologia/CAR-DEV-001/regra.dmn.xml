<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="Definitions_CAR_DEV_001" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.0.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.0.0">
  <decision id="Decision_CAR_DEV_001" name="Seleção Stent Farmacológico vs Metálico">
    <decisionTable id="DecisionTable_CAR_DEV_001" hitPolicy="FIRST">
      <input id="Input_ffr" label="FFR/iFR ≤ 0.80">
        <inputExpression id="InputExpression_ffr" typeRef="boolean">
          <text>ffrValue</text>
        </inputExpression>
      </input>
      <input id="Input_diabetes" label="Diabetes Mellitus">
        <inputExpression id="InputExpression_diabetes" typeRef="boolean">
          <text>hasDiabetes</text>
        </inputExpression>
      </input>
      <input id="Input_vesselSize" label="Diâmetro Vaso ≥ 3.0mm">
        <inputExpression id="InputExpression_vesselSize" typeRef="boolean">
          <text>adequateVesselSize</text>
        </inputExpression>
      </input>
      <input id="Input_lesionLength" label="Extensão Lesão &lt; 20mm">
        <inputExpression id="InputExpression_lesionLength" typeRef="boolean">
          <text>shortLesion</text>
        </inputExpression>
      </input>
      <input id="Input_thrombocytopeniaRisk" label="Risco Plaquetopenia">
        <inputExpression id="InputExpression_thrombocytopeniaRisk" typeRef="boolean">
          <text>hasThrombocytopeniaRisk</text>
        </inputExpression>
      </input>
      <output id="Output_resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" name="observacao" typeRef="string"/>
      <output id="Output_fundamentacao" name="fundamentacao" typeRef="string"/>
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdício" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <output id="Output_acaoRecomendada" label="Ação Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- Stent Farmacológico (Drug-Eluting Stent) - Indicações Preferenciais -->
      <rule id="Rule_DES_Diabetes_Complex">
        <description>DES indicado: diabetes + lesão complexa/vaso pequeno</description>
        <inputEntry id="UnaryTests_ffr_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_diabetes_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_vesselSize_1">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lesionLength_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_thrombocytopeniaRisk_1">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_1">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_1">
          <text>"Stent farmacologico indicado (diabetes + vaso menor que 3mm)"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_fundamentacao_1">
          <text>"SBC/SBHCI: DES preferencial para reducao de reestenose (NE=IA)"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_DES_Diabetes_Complex_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_DES_Diabetes_Complex_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_DES_LongLesion">
        <description>DES indicado: lesão extensa + FFR crítico</description>
        <inputEntry id="UnaryTests_ffr_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_diabetes_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_vesselSize_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lesionLength_2">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_thrombocytopeniaRisk_2">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_2">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_2">
          <text>"Stent farmacologico indicado (lesao maior ou igual 20mm + FFR menor ou igual 0.80)"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_fundamentacao_2">
          <text>"ACC/AHA: DES reduz reestenose em lesoes extensas (NE=IB)"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_DES_LongLesion_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_DES_LongLesion_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_DES_Standard">
        <description>DES indicado: critérios anatômicos/clínicos favoráveis</description>
        <inputEntry id="UnaryTests_ffr_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_diabetes_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_vesselSize_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lesionLength_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_thrombocytopeniaRisk_3">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_3">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_3">
          <text>"Stent farmacologico indicado (vaso adequado + lesao focal)"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_fundamentacao_3">
          <text>"Maior eficacia a longo prazo com uso de DAPT"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_DES_Standard_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_DES_Standard_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- Stent Metálico (Bare-Metal Stent) - Indicações Específicas -->
      <rule id="Rule_BMS_Thrombocytopenia">
        <description>BMS indicado: risco plaquetopenia/sangramento</description>
        <inputEntry id="UnaryTests_ffr_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_diabetes_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_vesselSize_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lesionLength_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_thrombocytopeniaRisk_4">
          <text>true</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_4">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_4">
          <text>"Stent metalico indicado (contraindicacao DAPT prolongada)"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_fundamentacao_4">
          <text>"ESC: BMS quando alto risco sangramento (NE=IIA)"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_BMS_Thrombocytopenia_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_BMS_Thrombocytopenia_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_BMS_Simple_Large">
        <description>BMS aceitável: vaso grande + lesão focal simples</description>
        <inputEntry id="UnaryTests_ffr_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_diabetes_5">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_vesselSize_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lesionLength_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_thrombocytopeniaRisk_5">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_5">
          <text>"Aprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_5">
          <text>"Stent metalico aceitavel (vaso maior ou igual 3mm + lesao menor 20mm + sem diabetes)"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_fundamentacao_5">
          <text>"Menor custo com perfil risco aceitavel"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_BMS_Simple_Large_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_BMS_Simple_Large_acaoRecomendada"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- Reprovação e Pendências -->
      <rule id="Rule_NoFFR">
        <description>FFR não realizado em lesão intermediária</description>
        <inputEntry id="UnaryTests_ffr_6">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_diabetes_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_vesselSize_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lesionLength_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_thrombocytopeniaRisk_6">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_6">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_6">
          <text>"Necessaria avaliacao FFR/iFR para lesao intermediaria (40-70%)"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_fundamentacao_6">
          <text>"SBC: FFR obrigatorio para lesoes nao-criticas (NE=IA)"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_NoFFR_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_NoFFR_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_HighRisk_Complex">
        <description>Alto risco com múltiplos fatores adversos</description>
        <inputEntry id="UnaryTests_ffr_7">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_diabetes_7">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_vesselSize_7">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lesionLength_7">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_thrombocytopeniaRisk_7">
          <text>true</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_7">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_7">
          <text>"Caso complexo (diabetes + vaso pequeno + lesao extensa + contraindicacao DAPT)"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_fundamentacao_7">
          <text>"Avaliar revascularizacao cirurgica"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_HighRisk_Complex_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_HighRisk_Complex_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Regra de Fallback -->
      <rule id="Rule_Default_Fallback">
        <description>Fallback padrão</description>
        <inputEntry id="UnaryTests_ffr_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_diabetes_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_vesselSize_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lesionLength_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_thrombocytopeniaRisk_fallback">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_fallback">
          <text>"Avaliacao individualizada necessaria"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_fundamentacao_fallback">
          <text>"Encaminhar para auditoria clinica"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Default_Fallback_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Default_Fallback_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_CAR_DEV_001">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
