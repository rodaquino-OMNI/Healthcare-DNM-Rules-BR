<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="Definitions_CAR_DEV_004" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.0.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.0.0">
  <decision id="Decision_CAR_DEV_004" name="Seleção CRT-P vs CRT-D">
    <decisionTable id="DecisionTable_CAR_DEV_004" hitPolicy="FIRST">
      <input id="Input_lvef" label="FEVE ≤ 35%">
        <inputExpression id="InputExpression_lvef" typeRef="boolean">
          <text>hasReducedLvef</text>
        </inputExpression>
      </input>
      <input id="Input_qrsDuration" label="QRS ≥ 150ms">
        <inputExpression id="InputExpression_qrsDuration" typeRef="boolean">
          <text>hasWideQRS</text>
        </inputExpression>
      </input>
      <input id="Input_lbbb" label="Bloqueio de Ramo Esquerdo">
        <inputExpression id="InputExpression_lbbb" typeRef="boolean">
          <text>hasLBBB</text>
        </inputExpression>
      </input>
      <input id="Input_nyhaClass" label="NYHA III-IV Ambulatorial">
        <inputExpression id="InputExpression_nyhaClass" typeRef="boolean">
          <text>hasAdvancedHF</text>
        </inputExpression>
      </input>
      <input id="Input_lifeExpectancy" label="Expectativa Vida &gt; 1 Ano">
        <inputExpression id="InputExpression_lifeExpectancy" typeRef="boolean">
          <text>hasReasonableLifeExpectancy</text>
        </inputExpression>
      </input>
      <input id="Input_suddenDeathRisk" label="Risco Morte Súbita">
        <inputExpression id="InputExpression_suddenDeathRisk" typeRef="boolean">
          <text>hasSuddenDeathRisk</text>
        </inputExpression>
      </input>
      <output id="Output_resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"APROVADO_CRT_D","APROVADO_CRT_P","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" name="observacao" typeRef="string"/>
      <output id="Output_fundamentacao" name="fundamentacao" typeRef="string"/>
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdício" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <output id="Output_acaoRecomendada" label="Ação Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- CRT-D (com desfibrilador) - Indicações Classe I -->
      <rule id="Rule_CRTD_Optimal">
        <description>CRT-D obrigatório: critérios ideais completos</description>
        <inputEntry id="UnaryTests_lvef_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_1">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_1">
          <text>"APROVADO_CRT_D"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_1">
          <text>"CRT-D indicado (FEVE≤35% + QRS≥150ms + BRE + NYHA III-IV). ACC/AHA Classe IA: redução mortalidade 36% + melhora QV"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_1">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CRTD_Optimal_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CRTD_Optimal_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_CRTD_SuddenDeathRisk">
        <description>CRT-D obrigatório: risco morte súbita documentado</description>
        <inputEntry id="UnaryTests_lvef_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_2">
          <text>true</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_2">
          <text>"APROVADO_CRT_D"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_2">
          <text>"CRT-D obrigatório (critérios TRC + risco MSC). ESC: desfibrilador essencial para prevenção arritmias ventriculares (NE=IA)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_2">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CRTD_SuddenDeathRisk_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CRTD_SuddenDeathRisk_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_CRTD_Moderate">
        <description>CRT-D indicado: critérios moderados favoráveis</description>
        <inputEntry id="UnaryTests_lvef_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_3">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_3">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_3">
          <text>"APROVADO_CRT_D"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_3">
          <text>"CRT-D indicado (QRS≥150ms + FEVE≤35% + IC avançada). Benefício ressincronização + proteção MSC (NE=IB)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_3">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CRTD_Moderate_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CRTD_Moderate_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- CRT-P (sem desfibrilador) - Indicações Restritas -->
      <rule id="Rule_CRTP_Contraindication_ICD">
        <description>CRT-P aceitável: contraindicação absoluta desfibrilador</description>
        <inputEntry id="UnaryTests_lvef_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_4">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_4">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_4">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_4">
          <text>"APROVADO_CRT_P"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_4">
          <text>"CRT-P aceitável (expectativa vida &lt;1 ano). SBC: ressincronização sem desfibrilador em pacientes terminais/comorbidades graves"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_4">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CRTP_Contraindication_ICD_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CRTP_Contraindication_ICD_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_CRTP_LowRisk">
        <description>CRT-P discutível: baixo risco MSC + recusa ICD</description>
        <inputEntry id="UnaryTests_lvef_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_5">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_5">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_5">
          <text>"APROVADO_CRT_P"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_5">
          <text>"CRT-P aceitável (NYHA II + recusa ICD documentada). Ressincronização isolada com benefício sintomático"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_5">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_CRTP_LowRisk_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_CRTP_LowRisk_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Reprovações -->
      <rule id="Rule_Reject_IncompleteCriteria">
        <description>Reprovado: critérios TRC incompletos</description>
        <inputEntry id="UnaryTests_lvef_6">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_6">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_6">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_6">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_6">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_6">
          <text>"TRC reprovada (QRS&lt;150ms). ESC: benefício não comprovado em QRS estreito. Considerar apenas CDI se indicado"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_6">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Reject_IncompleteCriteria_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Reject_IncompleteCriteria_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reject_NoLVEF">
        <description>Reprovado: FEVE preservada</description>
        <inputEntry id="UnaryTests_lvef_7">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_7">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_7">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_7">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_7">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_7">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_7">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_7">
          <text>"TRC reprovada (FEVE&gt;35%). Indicação restrita a disfunção ventricular grave. Sem benefício comprovado"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_7">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Reject_NoLVEF_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Reject_NoLVEF_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- Pendências -->
      <rule id="Rule_Pending_BorderlineQRS">
        <description>Pendente: QRS 120-149ms borderline</description>
        <inputEntry id="UnaryTests_lvef_8">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_8">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_8">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_8">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_8">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_8">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_8">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_8">
          <text>"Avaliar dissincronia por ecocardiograma (QRS 120-149ms + BRE). Considerar TRC se strain longitudinal demonstrar dissincronia"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_8">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Pending_BorderlineQRS_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Pending_BorderlineQRS_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Regra de Fallback -->
      <rule id="Rule_Default_Fallback">
        <description>Fallback padrão</description>
        <inputEntry id="UnaryTests_lvef_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_qrsDuration_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lbbb_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_nyhaClass_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lifeExpectancy_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_suddenDeathRisk_fallback">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_fallback">
          <text>"Caso atípico para TRC. Necessária avaliação especializada (ecocardiografia + eletrofisiologia)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_fallback">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Default_Fallback_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Default_Fallback_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_CAR_DEV_004">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
