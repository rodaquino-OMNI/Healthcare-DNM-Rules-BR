<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:modeler="http://camunda.org/schema/modeler/1.0" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="Definitions_CAR_IMG_001" name="DRD" namespace="http://camunda.org/schema/1.0/dmn" exporter="Camunda Modeler" exporterVersion="5.0.0" modeler:executionPlatform="Camunda Cloud" modeler:executionPlatformVersion="8.0.0">
  <decision id="Decision_CAR_IMG_001" name="Seleção Teste Ergométrico vs Imagem Stress">
    <decisionTable id="DecisionTable_CAR_IMG_001" hitPolicy="FIRST">
      <input id="Input_ecgInterpretable" label="ECG Repouso Interpretável">
        <inputExpression id="InputExpression_ecgInterpretable" typeRef="boolean">
          <text>hasInterpretableEcg</text>
        </inputExpression>
      </input>
      <input id="Input_exerciseCapacity" label="Capacidade Exercício Adequada">
        <inputExpression id="InputExpression_exerciseCapacity" typeRef="boolean">
          <text>hasAdequateExerciseCapacity</text>
        </inputExpression>
      </input>
      <input id="Input_preTestProbability" label="Probabilidade Pré-Teste DAC">
        <inputExpression id="InputExpression_preTestProbability" typeRef="string">
          <text>preTestProbability</text>
        </inputExpression>
        <inputValues id="UnaryTests_preTestProbability">
          <text>"LOW","INTERMEDIATE","HIGH"</text>
        </inputValues>
      </input>
      <input id="Input_previousRevascularization" label="Revascularização Prévia">
        <inputExpression id="InputExpression_previousRevascularization" typeRef="boolean">
          <text>hasPreviousRevascularization</text>
        </inputExpression>
      </input>
      <input id="Input_lvef" label="FEVE Conhecida &lt; 50%">
        <inputExpression id="InputExpression_lvef" typeRef="boolean">
          <text>hasKnownReducedLvef</text>
        </inputExpression>
      </input>
      <output id="Output_resultado" name="resultado" typeRef="string">
        <outputValues id="UnaryTests_resultado">
          <text>"APROVADO_TE","APROVADO_CINTILO","APROVADO_ECO_STRESS","Reprovado","Pendente"</text>
        </outputValues>
      </output>
      <output id="Output_observacao" name="observacao" typeRef="string"/>
      <output id="Output_fundamentacao" name="fundamentacao" typeRef="string"/>
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdício" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <output id="Output_acaoRecomendada" label="Ação Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>


      <!-- Teste Ergométrico Simples -->
      <rule id="Rule_ExerciseTest_LowRisk">
        <description>TE simples: baixo risco + ECG/capacidade adequados</description>
        <inputEntry id="UnaryTests_ecgInterpretable_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_1">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_1">
          <text>"LOW","INTERMEDIATE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_1">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_1">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_1">
          <text>"APROVADO_TE"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_1">
          <text>"Teste ergométrico convencional indicado (ECG normal + capacidade exercício). ACC/AHA: sensibilidade 68%, especificidade 77% (NE=IA)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_1">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_ExerciseTest_LowRisk_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_ExerciseTest_LowRisk_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_ExerciseTest_Intermediate">
        <description>TE simples aceitável: probabilidade intermediária sem comorbidades</description>
        <inputEntry id="UnaryTests_ecgInterpretable_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_2">
          <text>"INTERMEDIATE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_2">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_2">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_2">
          <text>"APROVADO_TE"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_2">
          <text>"TE convencional aceitável (probabilidade intermediária + condições favoráveis). Custo-efetividade superior - R$150 vs R$800-2000"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_2">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_ExerciseTest_Intermediate_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_ExerciseTest_Intermediate_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Cintilografia Miocárdica -->
      <rule id="Rule_SPECT_AbnormalECG">
        <description>Cintilografia obrigatória: ECG basal alterado</description>
        <inputEntry id="UnaryTests_ecgInterpretable_3">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_3">
          <text>"INTERMEDIATE","HIGH"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_3">
          <text>"APROVADO_CINTILO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_3">
          <text>"Cintilografia indicada (ECG alterado: BRE, WPW, MP, infraST). ASNC: sensibilidade 85-90%, especificidade 70-75% (NE=IA)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_3">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_SPECT_AbnormalECG_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_SPECT_AbnormalECG_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_SPECT_InexercisableCapacity">
        <description>Cintilografia farmacológica: incapacidade exercício</description>
        <inputEntry id="UnaryTests_ecgInterpretable_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_4">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_4">
          <text>"INTERMEDIATE","HIGH"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_4">
          <text>"APROVADO_CINTILO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_4">
          <text>"Cintilografia com dipiridamol/adenosina (limitação física). ESC: teste farmacológico quando incapacidade atingir 85% FCmáx (NE=IB)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_4">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_SPECT_InexercisableCapacity_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_SPECT_InexercisableCapacity_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_SPECT_PostRevasc">
        <description>Cintilografia preferencial: pós-revascularização</description>
        <inputEntry id="UnaryTests_ecgInterpretable_5">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_5">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_5">
          <text>"INTERMEDIATE","HIGH"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_5">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_5">
          <text>"APROVADO_CINTILO"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_5">
          <text>"Cintilografia indicada (pós-CRM/ICP). Localização isquemia + viabilidade miocárdica. Superiores TE convencional (NE=IB)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_5">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_SPECT_PostRevasc_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_SPECT_PostRevasc_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Ecocardiograma Stress -->
      <rule id="Rule_EchoStress_LVEF">
        <description>Eco stress indicado: disfunção VE conhecida</description>
        <inputEntry id="UnaryTests_ecgInterpretable_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_6">
          <text>"INTERMEDIATE","HIGH"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_6">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_6">
          <text>true</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_6">
          <text>"APROVADO_ECO_STRESS"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_6">
          <text>"Eco stress indicado (FEVE&lt;50% conhecida). Avalia isquemia + viabilidade + motilidade. Sem radiação ionizante (NE=IB)"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_6">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_EchoStress_LVEF_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_EchoStress_LVEF_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_EchoStress_Alternative">
        <description>Eco stress alternativa: contraindicação cintilografia</description>
        <inputEntry id="UnaryTests_ecgInterpretable_7">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_7">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_7">
          <text>"INTERMEDIATE"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_7">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_7">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_7">
          <text>"APROVADO_ECO_STRESS"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_7">
          <text>"Eco stress aceitável (alternativa cintilografia). Sensibilidade 80-85%, especificidade 84-86%. Menor custo que cintilo"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_7">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_EchoStress_Alternative_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_EchoStress_Alternative_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Reprovações -->
      <rule id="Rule_Reject_HighRisk_SimpleTE">
        <description>TE simples reprovado: alto risco necessita imagem</description>
        <inputEntry id="UnaryTests_ecgInterpretable_8">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_8">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_8">
          <text>"HIGH"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_8">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_8">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_8">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_8">
          <text>"TE simples reprovado (alta probabilidade pré-teste). Necessário método imagem para localização/extensão isquemia"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_8">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Reject_HighRisk_SimpleTE_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Reject_HighRisk_SimpleTE_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reject_AbnormalECG_SimpleTE">
        <description>TE simples reprovado: ECG basal alterado</description>
        <inputEntry id="UnaryTests_ecgInterpretable_9">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_9">
          <text>true</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_9">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_9">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_9">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_9">
          <text>"Reprovado"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_9">
          <text>"TE simples reprovado (ECG não interpretável). Alto risco falso-positivo. Necessário teste com imagem"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_9">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Reject_AbnormalECG_SimpleTE_alertasDesperdicio"><text>"PROT"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Reject_AbnormalECG_SimpleTE_acaoRecomendada"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- Pendências -->
      <rule id="Rule_Pending_LowRisk">
        <description>Pendente: muito baixo risco - avaliar necessidade</description>
        <inputEntry id="UnaryTests_ecgInterpretable_10">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_10">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_10">
          <text>"LOW"</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_10">
          <text>false</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_10">
          <text>false</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_10">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_10">
          <text>"Avaliar necessidade teste (muito baixo risco). Considerar tratamento clínico empírico se assintomático/baixo risco CV"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_10">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Pending_LowRisk_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Pending_LowRisk_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- Regra de Fallback -->
      <rule id="Rule_Default_Fallback">
        <description>Fallback padrão</description>
        <inputEntry id="UnaryTests_ecgInterpretable_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_exerciseCapacity_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_preTestProbability_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_previousRevascularization_fallback">
          <text>-</text>
        </inputEntry>
        <inputEntry id="UnaryTests_lvef_fallback">
          <text>-</text>
        </inputEntry>
        <outputEntry id="LiteralExpression_resultado_fallback">
          <text>"Pendente"</text>
        </outputEntry>
        <outputEntry id="LiteralExpression_observacao_fallback">
          <text>"Necessária avaliação cardiologista. Estratificar probabilidade pré-teste e selecionar método apropriado"</text>
        </outputEntry>
      <outputEntry id="LiteralExpression_fundamentacao_fallback">
          <text>"Conforme protocolo ANS/TISS 2024"</text>
        </outputEntry>        <outputEntry id="OutputEntry_Rule_Default_Fallback_alertasDesperdicio"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OutputEntry_Rule_Default_Fallback_acaoRecomendada"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram>
      <dmndi:DMNShape dmnElementRef="Decision_CAR_IMG_001">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>
</definitions>
