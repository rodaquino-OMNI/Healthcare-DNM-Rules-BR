<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_HEP_005"
             name="Metastasectomia Hepatica - Colorrectal Oligometastatico"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-HEP-005 - Metastasectomia Hepatica para Cancer Colorrectal Oligometastatico
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Hepatobiliar Oncologica
    Categoria: Procedimentos Cirurgicos Oncologicos

    Indicacoes Clinicas (ESMO 2023 / NCCN 2024):
    - Metastases hepaticas colorretais ressecaveis (CLM)
    - Doenca oligometastatica (tipicamente ≤5 lesoes)
    - Tumor primario controlado ou sincrono ressecavel
    - Ausencia de doenca extra-hepatica irressecavel
    - Volume hepatico residual funcional adequado (>20-30%)

    Criterios de Ressecabilidade:
    - Possibilidade de R0 com margem adequada
    - Preservacao de ≥2 segmentos hepaticos contiguos
    - Preservacao de fluxo vascular e drenagem biliar
    - FLR (Future Liver Remnant) adequado

    Documentacao Obrigatoria:
    - TC torax/abdome/pelve com contraste
    - PET-CT para exclusao de doenca extra-hepatica
    - CEA serica
    - Discussao em tumor board oncologico

    Referencias Normativas:
    - ESMO Guidelines 2023 - Colorectal Cancer Metastases
    - NCCN 2024 - Colon/Rectal Cancer
    - AHPBA/SSO/SSAT Consensus 2021
  -->

  <decision id="Decision_GEN_HEP_005" name="Criterios de Autorizacao - Metastasectomia Hepatica CLM">
    <decisionTable id="DecisionTable_GEN_HEP_005" hitPolicy="FIRST">

      <!-- Input 1: Numero de Metastases -->
      <input id="Input_numeroMetastases" label="Numero de Metastases Hepaticas">
        <inputExpression id="InputExpr_numeroMetastases" typeRef="string">
          <text>numeroMetastases</text>
        </inputExpression>
        <inputValues id="InputValues_numeroMetastases">
          <text>"Ate_3_Lesoes","4_5_Lesoes","Mais_5_Lesoes"</text>
        </inputValues>
      </input>

      <!-- Input 2: Status do Tumor Primario -->
      <input id="Input_statusPrimario" label="Status do Tumor Primario">
        <inputExpression id="InputExpr_statusPrimario" typeRef="string">
          <text>statusTumorPrimario</text>
        </inputExpression>
        <inputValues id="InputValues_statusPrimario">
          <text>"Ressecado_R0","Sincrono_Ressecavel","Sincrono_Irressecavel","Recidiva_Local"</text>
        </inputValues>
      </input>

      <!-- Input 3: Doenca Extra-Hepatica -->
      <input id="Input_doencaExtraHepatica" label="Doenca Extra-Hepatica">
        <inputExpression id="InputExpr_doencaExtraHepatica" typeRef="string">
          <text>doencaExtraHepatica</text>
        </inputExpression>
        <inputValues id="InputValues_doencaExtraHepatica">
          <text>"Ausente","Pulmonar_Ressecavel","Pulmonar_Irressecavel","Peritoneal","Outras_Irressecaveis"</text>
        </inputValues>
      </input>

      <!-- Input 4: PET-CT Realizado -->
      <input id="Input_petCT" label="PET-CT Estadiamento">
        <inputExpression id="InputExpr_petCT" typeRef="boolean">
          <text>petCTRealizado</text>
        </inputExpression>
      </input>

      <!-- Input 5: Discussao Tumor Board -->
      <input id="Input_tumorBoard" label="Discussao Tumor Board Documentada">
        <inputExpression id="InputExpr_tumorBoard" typeRef="boolean">
          <text>discussaoTumorBoard</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_HEP_005_Reprovado_DoencaDisseminada">
        <description>Reprovado - Doenca extra-hepatica irressecavel</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>"Pulmonar_Irressecavel","Peritoneal","Outras_Irressecaveis"</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Doenca extra-hepatica irressecavel contraindica metastasectomia hepatica com intencao curativa. Indicar tratamento sistemico paliativo."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ESMO 2023 / NCCN 2024 - Extrahepatic Disease Contraindication"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Reprovado_DoencaDisseminada_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Reprovado_DoencaDisseminada_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_005_Reprovado_PrimarioIrressecavel">
        <description>Reprovado - Tumor primario sincrono irressecavel</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>"Sincrono_Irressecavel"</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Tumor primario colorrectal sincrono irressecavel - metastasectomia hepatica nao indicada. Priorizar tratamento sistemico e reavaliacao."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"NCCN 2024 - Synchronous Disease Management"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Reprovado_PrimarioIrressecavel_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Reprovado_PrimarioIrressecavel_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_005_Reprovado_SemPETCT">
        <description>Reprovado - Estadiamento incompleto sem PET-CT</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"PET-CT obrigatorio para exclusao de doenca extra-hepatica oculta antes de metastasectomia com intencao curativa."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"ESMO 2023 - Staging Requirements CLM"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Reprovado_SemPETCT_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Reprovado_SemPETCT_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_005_Reprovado_SemTumorBoard">
        <description>Reprovado - Sem discussao multidisciplinar</description>
        <inputEntry id="IE_Rep4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep4_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep4_2"><text>"Discussao em tumor board oncologico multidisciplinar obrigatoria para decisao de metastasectomia hepatica."</text></outputEntry>
        <outputEntry id="OE_Rep4_3"><text>"NCCN 2024 - MDT Requirement"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Reprovado_SemTumorBoard_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Reprovado_SemTumorBoard_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_HEP_005_Aprovado_Oligomet_Ideal">
        <description>Aprovado - Oligometastatico ideal (ate 3 lesoes, R0 previo)</description>
        <inputEntry id="IE_Apr1_1"><text>"Ate_3_Lesoes"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"Ressecado_R0"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Metastases hepaticas colorretais oligometastaticas (≤3 lesoes), tumor primario ressecado R0, sem doenca extra-hepatica - metastasectomia hepatica aprovada. Sobrevida em 5 anos 40-60%."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"ESMO 2023 / NCCN 2024 - Resectable CLM"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Aprovado_Oligomet_Ideal_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Aprovado_Oligomet_Ideal_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_005_Aprovado_Sincrono_Ressecavel">
        <description>Aprovado - Sincrono ressecavel (staged ou simultaneous)</description>
        <inputEntry id="IE_Apr2_1"><text>"Ate_3_Lesoes"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"Sincrono_Ressecavel"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Metastases hepaticas sincronas com tumor primario ressecavel - abordagem simultanea ou estagiada aprovada conforme decisao do tumor board."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"AHPBA/SSO/SSAT Consensus 2021 - Synchronous CLM"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Aprovado_Sincrono_Ressecavel_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Aprovado_Sincrono_Ressecavel_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_005_Aprovado_Pulmonar_Ressecavel">
        <description>Aprovado - Doenca hepatica + pulmonar ambas ressecaveis</description>
        <inputEntry id="IE_Apr3_1"><text>"Ate_3_Lesoes"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"Ressecado_R0"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>"Pulmonar_Ressecavel"</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Metastases hepaticas e pulmonares ambas ressecaveis - abordagem sequencial aprovada. Iniciar por sitio com maior carga tumoral."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"ESMO 2023 - Resectable Hepatic and Pulmonary Metastases"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Aprovado_Pulmonar_Ressecavel_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Aprovado_Pulmonar_Ressecavel_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_HEP_005_Pendente_4_5_Lesoes">
        <description>Pendente - 4-5 lesoes requer avaliacao detalhada</description>
        <inputEntry id="IE_Pend1_1"><text>"4_5_Lesoes"</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"4-5 metastases hepaticas - avaliar resposta a quimioterapia neoadjuvante, volumetria hepatica e possibilidade de resseccao R0. Anexar avaliacao detalhada de ressecabilidade."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"ESMO 2023 - Borderline Resectable CLM"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Pendente_4_5_Lesoes_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Pendente_4_5_Lesoes_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_005_Pendente_Recidiva">
        <description>Pendente - Recidiva local do primario requer avaliacao</description>
        <inputEntry id="IE_Pend2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>"Recidiva_Local"</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"Recidiva local do tumor primario - avaliar ressecabilidade da recidiva antes de indicar metastasectomia hepatica. Anexar avaliacao de equipe de coloproctologia."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"NCCN 2024 - Recurrent Disease Assessment"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Pendente_Recidiva_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Pendente_Recidiva_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_HEP_005_Fallback">
        <description>Fallback - Analise oncologica especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso requer analise por auditor medico oncologico especializado com revisao de tumor board hepatobiliar."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria oncologica - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_005_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_005_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
