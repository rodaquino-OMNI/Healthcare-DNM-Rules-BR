<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_HEP_009"
             name="Esplenectomia - Criterios para PTI"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-HEP-009 - Esplenectomia para Purpura Trombocitopenica Imune (PTI)
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Hepatobiliar/Hematologia
    Categoria: Procedimentos Cirurgicos

    Indicacoes Clinicas (ASH 2019 / SBHH 2021):
    - PTI cronica (>12 meses) refrataria a corticoides
    - Falha ou intolerancia a agonistas de TPO (eltrombopag, romiplostim)
    - Plaquetas <30.000/mcL com sangramento ou risco de sangramento
    - Necessidade de corticoide em dose inaceitavel para manutencao
    - Preferencia do paciente por tratamento definitivo

    Timing:
    - Preferir apos 12-24 meses de diagnostico (chance de remissao espontanea)
    - Excecao: sangramento grave refratario

    Pre-operatorio Obrigatorio:
    - Vacinacao: Pneumococo, Meningococo, Haemophilus (2 semanas antes se eletiva)
    - Pesquisa de baco acessorio por imagem

    Taxa de Resposta:
    - Resposta completa (plaq >100.000): ~66%
    - Resposta parcial (plaq 30-100.000): ~22%

    Referencias Normativas:
    - ASH 2019 Guidelines - Immune Thrombocytopenia
    - SBHH 2021 - Consenso Brasileiro PTI
    - Uptodadate 2024 - Splenectomy for ITP
  -->

  <decision id="Decision_GEN_HEP_009" name="Criterios de Autorizacao - Esplenectomia PTI">
    <decisionTable id="DecisionTable_GEN_HEP_009" hitPolicy="FIRST">

      <!-- Input 1: Duracao da PTI -->
      <input id="Input_duracaoPTI" label="Duracao da PTI">
        <inputExpression id="InputExpr_duracaoPTI" typeRef="string">
          <text>duracaoPTI</text>
        </inputExpression>
        <inputValues id="InputValues_duracaoPTI">
          <text>"Menos_6_Meses","6_12_Meses","Mais_12_Meses_Cronica"</text>
        </inputValues>
      </input>

      <!-- Input 2: Tratamentos Previos -->
      <input id="Input_tratamentosPrevios" label="Tratamentos Previos Realizados">
        <inputExpression id="InputExpr_tratamentosPrevios" typeRef="string">
          <text>tratamentosPreviosPTI</text>
        </inputExpression>
        <inputValues id="InputValues_tratamentosPrevios">
          <text>"Corticoide_Apenas","Corticoide_TPO_Agonista","Corticoide_Rituximab","Multiplas_Linhas","Nenhum_Tratamento"</text>
        </inputValues>
      </input>

      <!-- Input 3: Contagem Plaquetaria -->
      <input id="Input_plaquetas" label="Contagem Plaquetaria (x1000/mcL)">
        <inputExpression id="InputExpr_plaquetas" typeRef="string">
          <text>contagemPlaquetaria</text>
        </inputExpression>
        <inputValues id="InputValues_plaquetas">
          <text>"Menos_10","10_30","30_50","Mais_50"</text>
        </inputValues>
      </input>

      <!-- Input 4: Vacinacao Pre-Esplenectomia -->
      <input id="Input_vacinacao" label="Vacinacao Pre-Esplenectomia Completa">
        <inputExpression id="InputExpr_vacinacao" typeRef="boolean">
          <text>vacinacaoCompleta</text>
        </inputExpression>
      </input>

      <!-- Input 5: Laudo Hematologico -->
      <input id="Input_laudoHematologico" label="Laudo de Hematologista">
        <inputExpression id="InputExpr_laudoHematologico" typeRef="boolean">
          <text>laudoHematologista</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_HEP_009_Reprovado_SemLaudoHemato">
        <description>Reprovado - Sem laudo de hematologista</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Laudo de hematologista obrigatorio documentando diagnostico de PTI, tratamentos previos, refratariedade e indicacao de esplenectomia."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ASH 2019 - Hematologist Evaluation Required"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Reprovado_SemLaudoHemato_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Reprovado_SemLaudoHemato_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_009_Reprovado_SemTratamentoPrevio">
        <description>Reprovado - Sem tratamento clinico previo</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>"Nenhum_Tratamento"</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Esplenectomia nao e primeira linha para PTI. Iniciar corticoterapia e avaliar resposta antes de indicar cirurgia."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"ASH 2019 - First-line Therapy Required"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Reprovado_SemTratamentoPrevio_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Reprovado_SemTratamentoPrevio_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_009_Reprovado_PlaquetasAltas">
        <description>Reprovado - Plaquetas adequadas sem indicacao cirurgica</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>"Mais_50"</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Contagem plaquetaria >50.000/mcL nao requer esplenectomia na maioria dos casos. Reavaliar apenas se sangramento clinicamente significativo ou necessidade de procedimentos de alto risco."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"ASH 2019 - Treatment Threshold"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Reprovado_PlaquetasAltas_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Reprovado_PlaquetasAltas_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_HEP_009_Aprovado_Cronica_Refrataria">
        <description>Aprovado - PTI cronica refrataria a multiplas linhas</description>
        <inputEntry id="IE_Apr1_1"><text>"Mais_12_Meses_Cronica"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"Corticoide_TPO_Agonista","Multiplas_Linhas"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"Menos_10","10_30"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"PTI cronica refrataria a corticoides e agonistas de TPO com trombocitopenia significativa - esplenectomia aprovada. Taxa de resposta ~66-88%. Preferir via laparoscopica."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"ASH 2019 / SBHH 2021 - Splenectomy for Refractory ITP"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Aprovado_Cronica_Refrataria_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Aprovado_Cronica_Refrataria_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_009_Aprovado_Corticoide_Dependente">
        <description>Aprovado - PTI cronica corticoide-dependente</description>
        <inputEntry id="IE_Apr2_1"><text>"Mais_12_Meses_Cronica"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"Corticoide_Apenas"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>"Menos_10","10_30","30_50"</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"PTI cronica corticoide-dependente - esplenectomia aprovada como alternativa a uso cronico de corticoide. Considerar agonistas de TPO como opcao se paciente preferir evitar cirurgia."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"ASH 2019 - Steroid-sparing Splenectomy"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Aprovado_Corticoide_Dependente_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Aprovado_Corticoide_Dependente_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_HEP_009_Pendente_SemVacinacao">
        <description>Pendente - Vacinacao pre-esplenectomia nao realizada</description>
        <inputEntry id="IE_Pend1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>false</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Vacinacao pre-esplenectomia obrigatoria (Pneumococo, Meningococo, Haemophilus) pelo menos 2 semanas antes da cirurgia eletiva. Anexar comprovante."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"ASH 2019 - Pre-splenectomy Vaccination"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Pendente_SemVacinacao_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Pendente_SemVacinacao_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_009_Pendente_PTIRecente">
        <description>Pendente - PTI recente (<12 meses) considerar espera</description>
        <inputEntry id="IE_Pend2_1"><text>"Menos_6_Meses","6_12_Meses"</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>"10_30","30_50"</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"PTI com menos de 12 meses pode ter remissao espontanea. Considerar aguardar ou usar agonistas de TPO como ponte. Justificar se esplenectomia precoce indicada."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"ASH 2019 - Timing of Splenectomy"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Pendente_PTIRecente_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Pendente_PTIRecente_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_009_Pendente_Grave_Urgente">
        <description>Pendente - Trombocitopenia grave requer avaliacao de urgencia</description>
        <inputEntry id="IE_Pend3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend3_3"><text>"Menos_10"</text></inputEntry>
        <inputEntry id="IE_Pend3_4"><text>false</text></inputEntry>
        <inputEntry id="IE_Pend3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend3_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend3_2"><text>"Plaquetas &lt;10.000 com urgencia cirurgica - discutir com hematologista sobre preparo pre-operatorio (IVIg, transfusao de plaquetas, corticoide EV) e vacinacao pos-operatoria se eletiva nao possivel."</text></outputEntry>
        <outputEntry id="OE_Pend3_3"><text>"ASH 2019 - Emergency Splenectomy Preparation"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Pendente_Grave_Urgente_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Pendente_Grave_Urgente_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_HEP_009_Fallback">
        <description>Fallback - Analise hematologica especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso de esplenectomia para PTI requer analise por auditor medico com suporte de hematologista."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria hematologica - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_009_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_009_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
