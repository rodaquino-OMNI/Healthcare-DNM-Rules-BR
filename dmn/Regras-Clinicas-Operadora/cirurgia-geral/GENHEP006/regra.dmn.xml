<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_HEP_006"
             name="Estenose Biliar - Benigna vs Maligna"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-HEP-006 - Estenose Biliar - Diferenciacao e Manejo Benigna vs Maligna
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Hepatobiliar
    Categoria: Procedimentos Diagnosticos/Cirurgicos

    Classificacao de Bismuth-Strasberg (Estenoses Benignas):
    - Tipo I: >2cm do hilo
    - Tipo II: <2cm do hilo
    - Tipo III: No hilo, comunicacao entre ductos preservada
    - Tipo IV: No hilo, sem comunicacao
    - Tipo V: Ducto hepatico direito aberrante

    Etiologias:
    - Benigna: Iatrogenia (colecistectomia), colangite esclerosante, pancreatite cronica
    - Maligna: Colangiocarcinoma, cancer de pancreas, cancer de vesicula

    Documentacao Obrigatoria:
    - ColangioRM ou CPRE com colangiografia
    - Citologia biliar (brush) se suspeita de malignidade
    - CA 19-9 serico
    - Biopsia se acessivel

    Referencias Normativas:
    - ESGE Guidelines 2023 - Biliary Strictures
    - SAGES 2023 - Post-cholecystectomy Biliary Injury
    - NCCN 2024 - Biliary Tract Cancers
  -->

  <decision id="Decision_GEN_HEP_006" name="Criterios de Autorizacao - Estenose Biliar">
    <decisionTable id="DecisionTable_GEN_HEP_006" hitPolicy="FIRST">

      <!-- Input 1: Natureza da Estenose -->
      <input id="Input_naturezaEstenose" label="Natureza da Estenose">
        <inputExpression id="InputExpr_naturezaEstenose" typeRef="string">
          <text>naturezaEstenose</text>
        </inputExpression>
        <inputValues id="InputValues_naturezaEstenose">
          <text>"Benigna_Confirmada","Maligna_Confirmada","Indeterminada"</text>
        </inputValues>
      </input>

      <!-- Input 2: Classificacao Bismuth (se benigna) ou Estadiamento -->
      <input id="Input_classificacao" label="Classificacao Bismuth ou Estadiamento">
        <inputExpression id="InputExpr_classificacao" typeRef="string">
          <text>classificacaoBismuthEstadio</text>
        </inputExpression>
        <inputValues id="InputValues_classificacao">
          <text>"Bismuth_I","Bismuth_II","Bismuth_III","Bismuth_IV","Bismuth_V","TNM_Ressecavel","TNM_Irressecavel","Nao_Classificado"</text>
        </inputValues>
      </input>

      <!-- Input 3: Procedimento Solicitado -->
      <input id="Input_procedimento" label="Procedimento Solicitado">
        <inputExpression id="InputExpr_procedimento" typeRef="string">
          <text>procedimentoSolicitado</text>
        </inputExpression>
        <inputValues id="InputValues_procedimento">
          <text>"Derivacao_Biliodigestiva","Resseccao_Curativa","Drenagem_Endoscopica","Drenagem_Percutanea","Exploracao_Diagnostica"</text>
        </inputValues>
      </input>

      <!-- Input 4: Imagem Biliar (ColangioRM/CPRE) -->
      <input id="Input_imagemBiliar" label="ColangioRM ou CPRE Realizada">
        <inputExpression id="InputExpr_imagemBiliar" typeRef="boolean">
          <text>imagemBiliarRealizada</text>
        </inputExpression>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_HEP_006_Reprovado_SemImagem">
        <description>Reprovado - Sem imagem biliar adequada</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"ColangioRM ou CPRE obrigatoria para caracterizacao anatomica da estenose e planejamento terapeutico."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ESGE 2023 - Biliary Stricture Evaluation"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Reprovado_SemImagem_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Reprovado_SemImagem_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_006_Reprovado_SemLaudo">
        <description>Reprovado - Sem laudo de indicacao</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Laudo de indicacao com caracterizacao da estenose, etiologia presumida e justificativa do procedimento proposto."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"RN 465/2021 - Documentacao Obrigatoria"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Reprovado_SemLaudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Reprovado_SemLaudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_006_Reprovado_MalignaIrressecavel_Cirurgia">
        <description>Reprovado - Estenose maligna irressecavel para cirurgia curativa</description>
        <inputEntry id="IE_Rep3_1"><text>"Maligna_Confirmada"</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>"TNM_Irressecavel"</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>"Resseccao_Curativa"</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Estenose maligna irressecavel - procedimento curativo nao indicado. Considerar drenagem paliativa (endoscopica ou percutanea) e quimioterapia."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"NCCN 2024 - Unresectable Biliary Cancer"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Reprovado_MalignaIrressecavel_Cirurgia_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Reprovado_MalignaIrressecavel_Cirurgia_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_HEP_006_Aprovado_Benigna_Derivacao">
        <description>Aprovado - Estenose benigna com derivacao biliodigestiva</description>
        <inputEntry id="IE_Apr1_1"><text>"Benigna_Confirmada"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"Bismuth_I","Bismuth_II","Bismuth_III"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"Derivacao_Biliodigestiva"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Estenose biliar benigna iatrogena/inflamatoria - derivacao biliodigestiva (hepaticojejunoanastomose em Y de Roux) aprovada como tratamento definitivo."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"SAGES 2023 - Biliary Reconstruction"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Aprovado_Benigna_Derivacao_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Aprovado_Benigna_Derivacao_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_006_Aprovado_Maligna_Ressecavel">
        <description>Aprovado - Estenose maligna ressecavel</description>
        <inputEntry id="IE_Apr2_1"><text>"Maligna_Confirmada"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"TNM_Ressecavel"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>"Resseccao_Curativa"</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Colangiocarcinoma ou neoplasia biliar ressecavel - resseccao curativa aprovada apos discussao em tumor board."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"NCCN 2024 - Resectable Biliary Cancer"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Aprovado_Maligna_Ressecavel_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Aprovado_Maligna_Ressecavel_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_006_Aprovado_Drenagem_Paliativa">
        <description>Aprovado - Drenagem paliativa para estenose maligna</description>
        <inputEntry id="IE_Apr3_1"><text>"Maligna_Confirmada"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"TNM_Irressecavel"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>"Drenagem_Endoscopica","Drenagem_Percutanea"</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Estenose maligna irressecavel - drenagem biliar paliativa aprovada para alivio de ictericia obstrutiva e melhora de qualidade de vida."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"ESGE 2023 - Palliative Biliary Drainage"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Aprovado_Drenagem_Paliativa_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Aprovado_Drenagem_Paliativa_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_HEP_006_Pendente_Indeterminada">
        <description>Pendente - Estenose indeterminada requer investigacao adicional</description>
        <inputEntry id="IE_Pend1_1"><text>"Indeterminada"</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Natureza da estenose indeterminada - realizar citologia biliar (brush), CA 19-9, e considerar colangioscopia ou biopsia para diferenciacao benigna/maligna."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"ESGE 2023 - Indeterminate Stricture Workup"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Pendente_Indeterminada_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Pendente_Indeterminada_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_006_Pendente_BismuthAlto">
        <description>Pendente - Bismuth IV/V requer centro especializado</description>
        <inputEntry id="IE_Pend2_1"><text>"Benigna_Confirmada"</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>"Bismuth_IV","Bismuth_V"</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"Lesao biliar Bismuth IV ou V - alta complexidade requer encaminhamento para centro de referencia hepatobiliar. Anexar parecer de especialista."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"SAGES 2023 - Complex Biliary Injury Referral"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Pendente_BismuthAlto_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Pendente_BismuthAlto_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_HEP_006_Fallback">
        <description>Fallback - Analise hepatobiliar especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso de estenose biliar requer analise por auditor medico especializado em hepatobiliar."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria hepatobiliar - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_006_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_006_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
