<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_GEN_EME_002"
             name="Obstrucao Intestinal - Criterios Operatorios"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    CODIGO: GEN-EME-002
    Procedimento: Obstrucao Intestinal - Criterios para Intervencao Cirurgica
    Especialidade: Cirurgia Geral - Emergencia
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES CIRURGICAS:
    - Obstrucao intestinal completa com sinais de estrangulamento
    - Falha de tratamento conservador apos 48-72h
    - Obstrucao em alca fechada
    - Sinais de isquemia ou necrose intestinal
    - Hernia encarcerada como causa

    CONTRAINDICACOES CIRURGICAS:
    - Obstrucao parcial responsiva a tratamento clinico
    - Ileo paralitico sem causa mecanica
    - Pseudo-obstrucao colonico (Ogilvie) inicial

    REFERENCIAS TECNICAS:
    - EAST Guidelines 2023 - Small Bowel Obstruction
    - WSES Jerusalem Guidelines 2017
    - CBC 2022 - Manejo de Obstrucao Intestinal

    ===============================================================================
  -->

  <decision id="Decision_GEN_EME_002" name="Regra Clinica - Obstrucao Intestinal">
    <decisionTable id="DecisionTable_GEN_EME_002" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_tipoObstrucao" label="Tipo de Obstrucao" camunda:inputVariable="tipoObstrucao">
        <inputExpression id="InputExpression_tipoObstrucao" typeRef="string">
          <text>tipoObstrucao</text>
        </inputExpression>
        <inputValues id="InputValues_tipoObstrucao">
          <text>"Completa","Parcial","AlcaFechada","NaoDefinida"</text>
        </inputValues>
      </input>

      <input id="Input_sinaisEstrangulamento" label="Sinais de Estrangulamento" camunda:inputVariable="sinaisEstrangulamento">
        <inputExpression id="InputExpression_sinaisEstrangulamento" typeRef="boolean">
          <text>sinaisEstrangulamento</text>
        </inputExpression>
      </input>

      <input id="Input_tempoObstrucao" label="Tempo de Obstrucao (horas)" camunda:inputVariable="tempoObstrucao">
        <inputExpression id="InputExpression_tempoObstrucao" typeRef="number">
          <text>tempoObstrucao</text>
        </inputExpression>
      </input>

      <input id="Input_respostaTratamento" label="Resposta ao Tratamento Conservador" camunda:inputVariable="respostaTratamento">
        <inputExpression id="InputExpression_respostaTratamento" typeRef="string">
          <text>respostaTratamento</text>
        </inputExpression>
        <inputValues id="InputValues_respostaTratamento">
          <text>"Melhora","SemMelhora","Piora","NaoIniciado"</text>
        </inputValues>
      </input>

      <input id="Input_causaIdentificada" label="Causa Identificada" camunda:inputVariable="causaIdentificada">
        <inputExpression id="InputExpression_causaIdentificada" typeRef="string">
          <text>causaIdentificada</text>
        </inputExpression>
        <inputValues id="InputValues_causaIdentificada">
          <text>"Hernia","Brida","Tumor","Volvo","Intussuscepcao","Ileo","Outra","NaoIdentificada"</text>
        </inputValues>
      </input>

      <!-- ========== OUTPUTS (3) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== REGRAS DE REPROVACAO ========== -->

      <rule id="Rule_Reprovado_IleoParalitico">
        <description>Reprovado: Ileo paralitico sem indicacao cirurgica</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>"Ileo"</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Ileo paralitico sem causa mecanica - tratamento clinico indicado, nao cirurgico"</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"EAST Guidelines 2023 - Diferenciacao entre obstrucao mecanica e ileo funcional"</text></outputEntry>
      <outputEntry id="OE_Reprovado_IleoParalitico_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_IleoParalitico_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_ParcialMelhorando">
        <description>Reprovado: Obstrucao parcial com melhora clinica</description>
        <inputEntry id="IE_Rep2_1"><text>"Parcial"</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>"Melhora"</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Obstrucao parcial com melhora ao tratamento conservador - manter conduta clinica"</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"WSES Jerusalem Guidelines 2017 - Manejo conservador de obstrucao parcial"</text></outputEntry>
      <outputEntry id="OE_Reprovado_ParcialMelhorando_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_ParcialMelhorando_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRAS DE APROVACAO ========== -->

      <rule id="Rule_Aprovado_Estrangulamento">
        <description>Aprovado: Sinais de estrangulamento - emergencia</description>
        <inputEntry id="IE_Apr1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Sinais de estrangulamento intestinal - laparotomia de emergencia indicada"</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"EAST Guidelines 2023 - Estrangulamento requer intervencao cirurgica imediata"</text></outputEntry>
      <outputEntry id="OE_Aprovado_Estrangulamento_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_Estrangulamento_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_AlcaFechada">
        <description>Aprovado: Obstrucao em alca fechada</description>
        <inputEntry id="IE_Apr2_1"><text>"AlcaFechada"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Obstrucao em alca fechada com alto risco de isquemia - indicacao cirurgica urgente"</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"WSES Jerusalem Guidelines 2017 - Alca fechada e indicacao cirurgica"</text></outputEntry>
      <outputEntry id="OE_Aprovado_AlcaFechada_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_AlcaFechada_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_FalhaTratamento">
        <description>Aprovado: Falha de tratamento conservador</description>
        <inputEntry id="IE_Apr3_1"><text>"Completa"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>&gt;= 48</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>"SemMelhora","Piora"</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Obstrucao completa sem melhora apos 48h de tratamento conservador - indicacao cirurgica"</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"EAST Guidelines 2023 - Falha de tratamento conservador apos 48-72h"</text></outputEntry>
      <outputEntry id="OE_Aprovado_FalhaTratamento_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_FalhaTratamento_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_HerniaEncarcerada">
        <description>Aprovado: Hernia encarcerada como causa</description>
        <inputEntry id="IE_Apr4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>"Hernia"</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"Hernia encarcerada causando obstrucao - correcao cirurgica de emergencia"</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"CBC 2022 - Hernia encarcerada e emergencia cirurgica"</text></outputEntry>
      <outputEntry id="OE_Aprovado_HerniaEncarcerada_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_HerniaEncarcerada_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRA FALLBACK ========== -->

      <rule id="Rule_Fallback_GEN_EME_002">
        <description>Pendente: Avaliacao adicional necessaria</description>
        <inputEntry id="IE_FB_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_5"><text>-</text></inputEntry>
        <outputEntry id="OE_FB_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FB_2"><text>"Avaliacao clinica adicional necessaria - considerar observacao e reavaliacao seriada"</text></outputEntry>
        <outputEntry id="OE_FB_3"><text>"EAST Guidelines 2023 - Monitoramento clinico e reavaliacao periodica"</text></outputEntry>
      <outputEntry id="OE_Fallback_GEN_EME_002_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_GEN_EME_002_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
