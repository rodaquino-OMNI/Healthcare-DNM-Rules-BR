<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_GEN_BRE_008"
             name="Mastectomia Nipple-Sparing - Selecao"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    CODIGO: GEN-BRE-008
    Procedimento: Mastectomia Nipple-Sparing (Preservadora de Papila) - Selecao
    Especialidade: Cirurgia Geral - Mastologia Oncoplastica
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES:
    - Tumor a > 2 cm da papila
    - Ausencia de envolvimento cutaneo
    - Ausencia de secrecao papilar patologica
    - Biopsia retroareolar negativa
    - Mama de tamanho pequeno a medio (menor ptose)
    - Reducao de risco em BRCA

    CONTRAINDICACOES:
    - Tumor a < 2 cm da papila
    - Doenca de Paget da papila
    - Carcinoma inflamatorio
    - Envolvimento cutaneo ou papilar
    - Ptose severa (grau III)

    REFERENCIAS TECNICAS:
    - NCCN Breast Cancer Guidelines 2024
    - SSO Nipple-Sparing Mastectomy Consensus 2021
    - SBM Guidelines 2023

    ===============================================================================
  -->

  <decision id="Decision_GEN_BRE_008" name="Regra Clinica - Nipple-Sparing Mastectomy">
    <decisionTable id="DecisionTable_GEN_BRE_008" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_distanciaTumorPapila" label="Distancia Tumor-Papila (cm)" camunda:inputVariable="distanciaTumorPapila">
        <inputExpression id="InputExpression_distanciaTumorPapila" typeRef="number">
          <text>distanciaTumorPapila</text>
        </inputExpression>
      </input>

      <input id="Input_envolvimentoPapilar" label="Envolvimento Papilar" camunda:inputVariable="envolvimentoPapilar">
        <inputExpression id="InputExpression_envolvimentoPapilar" typeRef="string">
          <text>envolvimentoPapilar</text>
        </inputExpression>
        <inputValues id="InputValues_envolvimentoPapilar">
          <text>"Paget","SecrecaoPatologica","BiopsiaPositiva","Ausente"</text>
        </inputValues>
      </input>

      <input id="Input_grauPtose" label="Grau de Ptose" camunda:inputVariable="grauPtose">
        <inputExpression id="InputExpression_grauPtose" typeRef="string">
          <text>grauPtose</text>
        </inputExpression>
        <inputValues id="InputValues_grauPtose">
          <text>"Grau0","Grau1","Grau2","Grau3"</text>
        </inputValues>
      </input>

      <input id="Input_indicacaoCirurgia" label="Indicacao da Cirurgia" camunda:inputVariable="indicacaoCirurgia">
        <inputExpression id="InputExpression_indicacaoCirurgia" typeRef="string">
          <text>indicacaoCirurgia</text>
        </inputExpression>
        <inputValues id="InputValues_indicacaoCirurgia">
          <text>"Cancer","ProfilaxiaBRCA","Outra"</text>
        </inputValues>
      </input>

      <input id="Input_tipoTumor" label="Tipo de Tumor" camunda:inputVariable="tipoTumor">
        <inputExpression id="InputExpression_tipoTumor" typeRef="string">
          <text>tipoTumor</text>
        </inputExpression>
        <inputValues id="InputValues_tipoTumor">
          <text>"Invasivo","CDIS","Inflamatorio","NaoAplicavel"</text>
        </inputValues>
      </input>

      <!-- ========== OUTPUTS (3) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== REGRAS DE REPROVACAO ========== -->

      <rule id="Rule_Reprovado_Paget">
        <description>Reprovado: Doenca de Paget</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>"Paget"</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Doenca de Paget da papila - contraindicacao absoluta a preservacao"</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"SSO Consensus 2021 - Paget requer resseccao da papila"</text></outputEntry>
      <outputEntry id="OE_Reprovado_Paget_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_Paget_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_Inflamatorio">
        <description>Reprovado: Carcinoma inflamatorio</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>"Inflamatorio"</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Carcinoma inflamatorio - contraindicacao a nipple-sparing"</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"NCCN 2024 - Mastectomia radical modificada em carcinoma inflamatorio"</text></outputEntry>
      <outputEntry id="OE_Reprovado_Inflamatorio_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_Inflamatorio_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_TumorProximo">
        <description>Reprovado: Tumor muito proximo da papila</description>
        <inputEntry id="IE_Rep3_1"><text>&lt; 2</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>"Cancer"</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Tumor a &lt; 2cm da papila - alto risco de envolvimento oculto"</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"SSO Consensus 2021 - Distancia minima de 2cm recomendada"</text></outputEntry>
      <outputEntry id="OE_Reprovado_TumorProximo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_TumorProximo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_PtoseSevera">
        <description>Reprovado: Ptose severa</description>
        <inputEntry id="IE_Rep4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_3"><text>"Grau3"</text></inputEntry>
        <inputEntry id="IE_Rep4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep4_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep4_2"><text>"Ptose severa - alto risco de necrose papilar pos-operatoria"</text></outputEntry>
        <outputEntry id="OE_Rep4_3"><text>"SBM 2023 - Ptose grau III e contraindicacao relativa importante"</text></outputEntry>
      <outputEntry id="OE_Reprovado_PtoseSevera_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_PtoseSevera_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRAS DE APROVACAO ========== -->

      <rule id="Rule_Aprovado_Ideal">
        <description>Aprovado: Candidata ideal para NSM</description>
        <inputEntry id="IE_Apr1_1"><text>&gt;= 2</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"Grau0","Grau1"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>"Invasivo","CDIS"</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Candidata ideal para nipple-sparing mastectomy - criterios oncologicos e anatomicos favoraveis"</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"SSO Consensus 2021 - Criterios de elegibilidade preenchidos"</text></outputEntry>
      <outputEntry id="OE_Aprovado_Ideal_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_Ideal_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_Profilatica">
        <description>Aprovado: Profilaxia BRCA</description>
        <inputEntry id="IE_Apr2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>"Grau0","Grau1","Grau2"</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>"ProfilaxiaBRCA"</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>"NaoAplicavel"</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Mastectomia profilatica em BRCA - nipple-sparing e opcao segura"</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"NCCN 2024 - NSM e opcao valida para reducao de risco"</text></outputEntry>
      <outputEntry id="OE_Aprovado_Profilatica_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_Profilatica_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_PtoseModerada">
        <description>Aprovado: Ptose moderada com bom planejamento</description>
        <inputEntry id="IE_Apr3_1"><text>&gt;= 2</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>"Grau2"</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>"Invasivo","CDIS"</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Ptose moderada - NSM possivel com tecnica adequada e mastopexia associada"</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"SBM 2023 - Tecnicas de reposicionamento papilar podem viabilizar NSM"</text></outputEntry>
      <outputEntry id="OE_Aprovado_PtoseModerada_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_PtoseModerada_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRA FALLBACK ========== -->

      <rule id="Rule_Fallback_GEN_BRE_008">
        <description>Pendente: Avaliacao adicional do complexo areolopapilar</description>
        <inputEntry id="IE_FB_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_5"><text>-</text></inputEntry>
        <outputEntry id="OE_FB_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FB_2"><text>"RM de mama e biopsia retroareolar recomendadas para confirmacao de elegibilidade"</text></outputEntry>
        <outputEntry id="OE_FB_3"><text>"SSO Consensus 2021 - Avaliacao pre-operatoria detalhada necessaria"</text></outputEntry>
      <outputEntry id="OE_Fallback_GEN_BRE_008_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_GEN_BRE_008_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
