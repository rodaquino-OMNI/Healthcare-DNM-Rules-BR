<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_UGI_004"
             name="Ulcera Peptica - Indicacoes Cirurgicas"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-UGI-004 - Ulcera Peptica - Indicacoes para Tratamento Cirurgico
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Esofago Gastrico
    Categoria: Procedimentos Cirurgicos

    Indicacoes Cirurgicas de Urgencia:
    - Perfuracao: Rafia + omentoplastia (Graham patch)
    - Sangramento refratario a endoscopia
    - Obstrucao gastrica (estenose pilorica)

    Indicacoes Eletivas (Raras na Era IBP):
    - Ulcera refrataria a tratamento clinico otimizado
    - Ulceras de Cushing/Curling em pacientes criticos
    - Sindrome de Zollinger-Ellison

    Procedimentos:
    - Rafia simples + omentoplastia (perfuracao)
    - Vagotomia + piloroplastia (historico)
    - Antrectomia (raramente necessaria)
    - Gastrectomia parcial (ulcera gigante, suspeita neoplasia)

    Documentacao Obrigatoria:
    - EDA com biopsias (excluir malignidade)
    - Teste para H. pylori
    - TC abdome (se perfuracao)

    Referencias Normativas:
    - WSES Guidelines Perforated Peptic Ulcer 2020
    - ACG Guidelines H. pylori 2017
    - ESGE Guidelines GI Bleeding 2021
  -->

  <decision id="Decision_GEN_UGI_004" name="Criterios de Autorizacao - Ulcera Peptica Cirurgia">
    <decisionTable id="DecisionTable_GEN_UGI_004" hitPolicy="FIRST">

      <!-- Input 1: Indicacao -->
      <input id="Input_indicacao" label="Indicacao Cirurgica">
        <inputExpression id="InputExpr_indicacao" typeRef="string">
          <text>indicacaoCirurgica</text>
        </inputExpression>
        <inputValues id="InputValues_indicacao">
          <text>"Perfuracao","Sangramento_Refratario","Obstrucao_Pilorica","Refratariedade_Clinica","Suspeita_Neoplasia"</text>
        </inputValues>
      </input>

      <!-- Input 2: EDA com Biopsias -->
      <input id="Input_edaBiopsias" label="EDA com Biopsias">
        <inputExpression id="InputExpr_edaBiopsias" typeRef="string">
          <text>edaBiopsiasResultado</text>
        </inputExpression>
        <inputValues id="InputValues_edaBiopsias">
          <text>"Benigna","Suspeita_Malignidade","Nao_Realizada"</text>
        </inputValues>
      </input>

      <!-- Input 3: Tratamento Clinico Previo -->
      <input id="Input_tratamentoClinico" label="Tratamento Clinico Previo">
        <inputExpression id="InputExpr_tratamentoClinico" typeRef="string">
          <text>tratamentoClinicoPrevio</text>
        </inputExpression>
        <inputValues id="InputValues_tratamentoClinico">
          <text>"IBP_Dose_Dobrada_8sem","IBP_Padrao","Nenhum","Urgencia"</text>
        </inputValues>
      </input>

      <!-- Input 4: Status H. pylori -->
      <input id="Input_hPylori" label="Status H. pylori">
        <inputExpression id="InputExpr_hPylori" typeRef="string">
          <text>statusHPylori</text>
        </inputExpression>
        <inputValues id="InputValues_hPylori">
          <text>"Positivo_Tratado","Positivo_Nao_Tratado","Negativo","Nao_Testado"</text>
        </inputValues>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_UGI_004_Reprovado_SemTratamentoClinico">
        <description>Reprovado - Cirurgia eletiva sem tratamento clinico adequado</description>
        <inputEntry id="IE_Rep1_1"><text>"Refratariedade_Clinica"</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>"Nenhum","IBP_Padrao"</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Cirurgia eletiva para ulcera peptica requer falha de IBP dose dobrada por 8-12 semanas + erradicacao de H. pylori se positivo."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ACG 2017 - Medical Therapy First"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Reprovado_SemTratamentoClinico_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Reprovado_SemTratamentoClinico_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_004_Reprovado_HPyloriNaoTratado">
        <description>Reprovado - H. pylori positivo nao tratado</description>
        <inputEntry id="IE_Rep2_1"><text>"Refratariedade_Clinica"</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>"Positivo_Nao_Tratado"</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"H. pylori positivo - erradicar antes de considerar cirurgia. Maioria das ulceras cicatriza com erradicacao + IBP."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"ACG 2017 - H. pylori Eradication Required"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Reprovado_HPyloriNaoTratado_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Reprovado_HPyloriNaoTratado_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_004_Reprovado_SemLaudo">
        <description>Reprovado - Sem laudo de indicacao</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Laudo de indicacao obrigatorio com EDA, histopatologia, status H. pylori e tratamento previo."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"RN 465/2021 - Documentacao Obrigatoria"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Reprovado_SemLaudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Reprovado_SemLaudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_UGI_004_Aprovado_Perfuracao">
        <description>Aprovado - Ulcera perfurada (urgencia)</description>
        <inputEntry id="IE_Apr1_1"><text>"Perfuracao"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"URGENCIA - Ulcera peptica perfurada. Rafia com patch de omento (Graham) + lavagem cavidade. Laparoscopia se disponivel e estavel."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"WSES 2020 - Perforated Ulcer Surgery"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Aprovado_Perfuracao_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Aprovado_Perfuracao_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_004_Aprovado_Sangramento">
        <description>Aprovado - Sangramento refratario a endoscopia</description>
        <inputEntry id="IE_Apr2_1"><text>"Sangramento_Refratario"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"URGENCIA - Sangramento por ulcera refratario a hemostasia endoscopica (2+ tentativas). Ligadura do vaso + oversewing ou resseccao."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"ESGE 2021 - Refractory Bleeding Surgery"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Aprovado_Sangramento_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Aprovado_Sangramento_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_004_Aprovado_Obstrucao">
        <description>Aprovado - Obstrucao gastrica por estenose</description>
        <inputEntry id="IE_Apr3_1"><text>"Obstrucao_Pilorica"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"Benigna"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Estenose pilorica por ulcera - antrectomia com gastrojejunostomia ou piloroplastia aprovada apos otimizacao nutricional."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"WSES 2020 - Gastric Outlet Obstruction"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Aprovado_Obstrucao_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Aprovado_Obstrucao_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_004_Aprovado_SuspeitaNeoplasia">
        <description>Aprovado - Suspeita de malignidade</description>
        <inputEntry id="IE_Apr4_1"><text>"Suspeita_Neoplasia"</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>"Suspeita_Malignidade"</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"Ulcera gastrica com suspeita de malignidade - gastrectomia com linfadenectomia D2 aprovada. Biopsias inconclusivas nao excluem cancer."</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"NCCN 2024 - Suspicious Ulcer Resection"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Aprovado_SuspeitaNeoplasia_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Aprovado_SuspeitaNeoplasia_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_UGI_004_Pendente_SemBiopsia">
        <description>Pendente - Ulcera gastrica sem biopsia</description>
        <inputEntry id="IE_Pend1_1"><text>"Refratariedade_Clinica","Obstrucao_Pilorica"</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>"Nao_Realizada"</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Ulcera gastrica requer EDA com biopsias multiplas (minimo 6) para excluir malignidade antes de cirurgia eletiva."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"ESGE - Gastric Ulcer Biopsy Protocol"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Pendente_SemBiopsia_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Pendente_SemBiopsia_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_004_Pendente_HPyloriNaoTestado">
        <description>Pendente - H. pylori nao testado</description>
        <inputEntry id="IE_Pend2_1"><text>"Refratariedade_Clinica"</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>"Nao_Testado"</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"Teste para H. pylori obrigatorio antes de cirurgia eletiva. Se positivo, tratar primeiro."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"ACG 2017 - Test and Treat"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Pendente_HPyloriNaoTestado_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Pendente_HPyloriNaoTestado_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_UGI_004_Fallback">
        <description>Fallback - Analise especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso de ulcera peptica para cirurgia requer analise por auditor medico."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria cirurgica - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_004_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_004_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
