<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_HEP_010"
             name="Hipertensao Portal - Selecao de Shunt"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-HEP-010 - Hipertensao Portal - Criterios para Selecao de Shunt
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Hepatobiliar
    Categoria: Procedimentos Cirurgicos

    Indicacoes Clinicas (AASLD 2021 / Baveno VII 2022):
    - Sangramento varicoso refratario a tratamento endoscopico + farmacologico
    - Ascite refrataria a diureticos
    - Sindrome de Budd-Chiari
    - Hipertensao portal pre-hepatica (trombose portal)

    Opcoes de Shunt:
    - TIPS (Transjugular Intrahepatic Portosystemic Shunt): Primeira linha na maioria
    - Shunt esplenorrenal distal (Warren): Hipertensao sinusoidal com funcao preservada
    - Shunt portocava: Historico, raramente realizado
    - Derivacao meso-cava: Casos selecionados

    Contraindicacoes para TIPS:
    - Encefalopatia hepatica grave recorrente
    - Insuficiencia cardiaca direita grave
    - Doenca hepatica policistica
    - Infeccao sistemica ativa

    Documentacao Obrigatoria:
    - Endoscopia com tentativa de ligadura/escleroterapia
    - MELD score atualizado
    - Ecocardiograma para avaliacao cardiaca
    - USG Doppler portal

    Referencias Normativas:
    - AASLD 2021 - Portal Hypertension
    - Baveno VII Consensus 2022
    - EASL 2018 - Decompensated Cirrhosis
  -->

  <decision id="Decision_GEN_HEP_010" name="Criterios de Autorizacao - Shunt Portal">
    <decisionTable id="DecisionTable_GEN_HEP_010" hitPolicy="FIRST">

      <!-- Input 1: Indicacao Principal -->
      <input id="Input_indicacao" label="Indicacao Principal">
        <inputExpression id="InputExpr_indicacao" typeRef="string">
          <text>indicacaoPrincipal</text>
        </inputExpression>
        <inputValues id="InputValues_indicacao">
          <text>"Sangramento_Refratario","Ascite_Refrataria","Budd_Chiari","Trombose_Portal","Profilaxia_Ressangramento"</text>
        </inputValues>
      </input>

      <!-- Input 2: Tipo de Shunt Solicitado -->
      <input id="Input_tipoShunt" label="Tipo de Shunt Solicitado">
        <inputExpression id="InputExpr_tipoShunt" typeRef="string">
          <text>tipoShuntSolicitado</text>
        </inputExpression>
        <inputValues id="InputValues_tipoShunt">
          <text>"TIPS","Shunt_Warren","Shunt_Mesocava","Shunt_Portocava"</text>
        </inputValues>
      </input>

      <!-- Input 3: Funcao Hepatica (MELD) -->
      <input id="Input_meld" label="MELD Score">
        <inputExpression id="InputExpr_meld" typeRef="string">
          <text>meldScore</text>
        </inputExpression>
        <inputValues id="InputValues_meld">
          <text>"MELD_Menos_15","MELD_15_18","MELD_Mais_18"</text>
        </inputValues>
      </input>

      <!-- Input 4: Tratamento Endoscopico Previo -->
      <input id="Input_endoscopia" label="Tratamento Endoscopico Previo">
        <inputExpression id="InputExpr_endoscopia" typeRef="boolean">
          <text>tratamentoEndoscopicoPrevio</text>
        </inputExpression>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao (Hepatologista/Cirurgiao)">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_HEP_010_Reprovado_SemLaudo">
        <description>Reprovado - Sem laudo de indicacao</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Laudo de hepatologista ou cirurgiao hepatobiliar obrigatorio com indicacao, MELD, e justificativa da escolha do tipo de shunt."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"AASLD 2021 - Specialist Evaluation Required"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Reprovado_SemLaudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Reprovado_SemLaudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_010_Reprovado_SemEndoscopia_Sangramento">
        <description>Reprovado - Sangramento sem tentativa endoscopica</description>
        <inputEntry id="IE_Rep2_1"><text>"Sangramento_Refratario","Profilaxia_Ressangramento"</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Shunt para sangramento varicoso requer falha documentada de tratamento endoscopico (ligadura elastica) + farmacoterapia (betabloqueador + vasoconstritor). Anexar laudos endoscopicos."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"Baveno VII 2022 - Endoscopic Therapy First"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Reprovado_SemEndoscopia_Sangramento_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Reprovado_SemEndoscopia_Sangramento_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_010_Reprovado_MELD_Alto_Cirurgico">
        <description>Reprovado - MELD alto para shunt cirurgico</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>"Shunt_Warren","Shunt_Mesocava","Shunt_Portocava"</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>"MELD_Mais_18"</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"MELD >18 contraindica shunt cirurgico devido alta morbimortalidade. Considerar TIPS se indicado ou priorizar transplante hepatico."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"AASLD 2021 - Surgical Shunt Contraindications"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Reprovado_MELD_Alto_Cirurgico_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Reprovado_MELD_Alto_Cirurgico_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_HEP_010_Aprovado_TIPS_Sangramento">
        <description>Aprovado - TIPS para sangramento refratario</description>
        <inputEntry id="IE_Apr1_1"><text>"Sangramento_Refratario"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"TIPS"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"MELD_Menos_15","MELD_15_18"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"TIPS aprovado para sangramento varicoso refratario a tratamento endoscopico. Procedimento de resgate eficaz. Preferir TIPS coberto (e-PTFE) para maior patencia."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"Baveno VII 2022 / AASLD 2021 - Rescue TIPS"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Aprovado_TIPS_Sangramento_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Aprovado_TIPS_Sangramento_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_010_Aprovado_TIPS_Ascite">
        <description>Aprovado - TIPS para ascite refrataria</description>
        <inputEntry id="IE_Apr2_1"><text>"Ascite_Refrataria"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"TIPS"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>"MELD_Menos_15","MELD_15_18"</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"TIPS aprovado para ascite refrataria a diureticos em paciente com funcao hepatica razoavel (MELD â‰¤18). Reduz necessidade de paracenteses e melhora qualidade de vida."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"EASL 2018 / AASLD 2021 - TIPS for Refractory Ascites"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Aprovado_TIPS_Ascite_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Aprovado_TIPS_Ascite_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_010_Aprovado_Warren">
        <description>Aprovado - Shunt Warren em casos selecionados</description>
        <inputEntry id="IE_Apr3_1"><text>"Sangramento_Refratario","Profilaxia_Ressangramento"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"Shunt_Warren"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>"MELD_Menos_15"</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Shunt esplenorrenal distal (Warren) aprovado em paciente com funcao hepatica preservada (MELD &lt;15) quando TIPS nao disponivel ou tecnicamente impossivel. Menor taxa de encefalopatia."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"AASLD 2021 - Surgical Shunt Indications"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Aprovado_Warren_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Aprovado_Warren_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_010_Aprovado_BuddChiari">
        <description>Aprovado - TIPS para Budd-Chiari</description>
        <inputEntry id="IE_Apr4_1"><text>"Budd_Chiari"</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>"TIPS"</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"TIPS aprovado para sindrome de Budd-Chiari apos falha de anticoagulacao. Pode ser ponte para transplante. Confirmar perviedade de veias hepaticas/VCI antes do procedimento."</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"EASL 2016 - Budd-Chiari Syndrome Management"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Aprovado_BuddChiari_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Aprovado_BuddChiari_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_HEP_010_Pendente_MELD_Alto_TIPS">
        <description>Pendente - MELD alto para TIPS requer avaliacao</description>
        <inputEntry id="IE_Pend1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>"TIPS"</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>"MELD_Mais_18"</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"MELD >18 indica alto risco para TIPS. Avaliar se paciente e candidato a transplante hepatico (pode ser ponte). Discutir risco-beneficio com hepatologista e equipe de transplante."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"AASLD 2021 - High MELD TIPS Assessment"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Pendente_MELD_Alto_TIPS_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Pendente_MELD_Alto_TIPS_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_010_Pendente_Trombose_Portal">
        <description>Pendente - Trombose portal requer avaliacao especializada</description>
        <inputEntry id="IE_Pend2_1"><text>"Trombose_Portal"</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"Trombose portal - avaliar anticoagulacao como primeira linha. Se shunt indicado, revisar anatomia vascular detalhada (angioTC ou angio-RM) para planejamento. Anexar avaliacao vascular."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"Baveno VII 2022 - Portal Vein Thrombosis"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Pendente_Trombose_Portal_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Pendente_Trombose_Portal_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_HEP_010_Fallback">
        <description>Fallback - Analise hepatologica especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso de hipertensao portal requer analise por auditor medico com expertise hepatobiliar e discussao com equipe de transplante se aplicavel."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria hepatologica - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_010_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_010_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
