<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_GEN_EME_007"
             name="Cirurgia de Controle de Danos - Criterios"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    CODIGO: GEN-EME-007
    Procedimento: Damage Control Surgery - Cirurgia de Controle de Danos
    Especialidade: Cirurgia Geral - Trauma
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES PARA DAMAGE CONTROL:
    - Triade letal: Hipotermia + Acidose + Coagulopatia
    - Tempo cirurgico prolongado previsto (> 90 min)
    - Lesoes multiplas requerendo reconstrucao complexa
    - Instabilidade hemodinamica persistente
    - Transfusao massiva (> 10 unidades de CH)
    - Lesao vascular maior com isquemia

    CONTRAINDICACOES:
    - Paciente estavel sem triade letal
    - Lesao unica tratavel definitivamente
    - Recursos para reoperacao nao disponiveis

    REFERENCIAS TECNICAS:
    - ACS TQIP Best Practices 2024 - Damage Control
    - EAST Guidelines 2023 - Damage Control Surgery
    - Journal of Trauma Guidelines 2020

    ===============================================================================
  -->

  <decision id="Decision_GEN_EME_007" name="Regra Clinica - Damage Control Surgery">
    <decisionTable id="DecisionTable_GEN_EME_007" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_triadeLetal" label="Componentes da Triade Letal" camunda:inputVariable="triadeLetal">
        <inputExpression id="InputExpression_triadeLetal" typeRef="string">
          <text>triadeLetal</text>
        </inputExpression>
        <inputValues id="InputValues_triadeLetal">
          <text>"TriadeCompleta","DoisComponentes","UmComponente","Ausente"</text>
        </inputValues>
      </input>

      <input id="Input_temperaturaCore" label="Temperatura Central (C)" camunda:inputVariable="temperaturaCore">
        <inputExpression id="InputExpression_temperaturaCore" typeRef="number">
          <text>temperaturaCore</text>
        </inputExpression>
      </input>

      <input id="Input_phArterial" label="pH Arterial" camunda:inputVariable="phArterial">
        <inputExpression id="InputExpression_phArterial" typeRef="number">
          <text>phArterial</text>
        </inputExpression>
      </input>

      <input id="Input_unidadesCH" label="Unidades de CH Transfundidas" camunda:inputVariable="unidadesCH">
        <inputExpression id="InputExpression_unidadesCH" typeRef="number">
          <text>unidadesCH</text>
        </inputExpression>
      </input>

      <input id="Input_inr" label="INR" camunda:inputVariable="inr">
        <inputExpression id="InputExpression_inr" typeRef="number">
          <text>inr</text>
        </inputExpression>
      </input>

      <!-- ========== OUTPUTS (3) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== REGRAS DE REPROVACAO ========== -->

      <rule id="Rule_Reprovado_PacienteEstavel">
        <description>Reprovado: Paciente estavel sem indicadores de damage control</description>
        <inputEntry id="IE_Rep1_1"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>&gt;= 35</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>&gt;= 7.25</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>&lt; 6</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>&lt; 1.5</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Paciente estavel sem indicadores de damage control - cirurgia definitiva pode ser realizada"</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ACS TQIP Best Practices 2024 - Damage control reservado para instabilidade fisiologica"</text></outputEntry>
      <outputEntry id="OE_Reprovado_PacienteEstavel_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_PacienteEstavel_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_UmComponente">
        <description>Reprovado: Apenas um componente da triade presente</description>
        <inputEntry id="IE_Rep2_1"><text>"UmComponente"</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>&lt; 10</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Um componente isolado da triade sem outros indicadores - corrigir e prosseguir com cirurgia definitiva"</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"EAST Guidelines 2023 - Threshold para damage control nao atingido"</text></outputEntry>
      <outputEntry id="OE_Reprovado_UmComponente_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_UmComponente_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRAS DE APROVACAO ========== -->

      <rule id="Rule_Aprovado_TriadeCompleta">
        <description>Aprovado: Triade letal completa</description>
        <inputEntry id="IE_Apr1_1"><text>"TriadeCompleta"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Triade letal presente (hipotermia + acidose + coagulopatia) - damage control surgery indicada"</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"ACS TQIP Best Practices 2024 - Indicacao classica de damage control"</text></outputEntry>
      <outputEntry id="OE_Aprovado_TriadeCompleta_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_TriadeCompleta_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_TransfusaoMassiva">
        <description>Aprovado: Transfusao massiva em curso</description>
        <inputEntry id="IE_Apr2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>&gt;= 10</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Transfusao massiva (10+ unidades) indica coagulopatia e perda significativa - damage control"</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"EAST Guidelines 2023 - Transfusao massiva como trigger para damage control"</text></outputEntry>
      <outputEntry id="OE_Aprovado_TransfusaoMassiva_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_TransfusaoMassiva_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_AcidoseGrave">
        <description>Aprovado: Acidose grave com coagulopatia</description>
        <inputEntry id="IE_Apr3_1"><text>"DoisComponentes"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>&lt; 7.2</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>&gt;= 2.0</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Acidose grave (pH &lt; 7.2) com coagulopatia (INR &gt;= 2.0) - abreviar cirurgia com damage control"</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"Journal of Trauma Guidelines 2020 - pH &lt; 7.2 e trigger para abreviacao"</text></outputEntry>
      <outputEntry id="OE_Aprovado_AcidoseGrave_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_AcidoseGrave_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_HipotermiaGrave">
        <description>Aprovado: Hipotermia grave</description>
        <inputEntry id="IE_Apr4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>&lt; 34</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>&gt;= 1.8</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"Hipotermia grave (&lt; 34C) com coagulopatia - damage control para reaquecimento em UTI"</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"ACS TQIP Best Practices 2024 - Hipotermia e indicador critico"</text></outputEntry>
      <outputEntry id="OE_Aprovado_HipotermiaGrave_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_HipotermiaGrave_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRA FALLBACK ========== -->

      <rule id="Rule_Fallback_GEN_EME_007">
        <description>Pendente: Avaliacao intraoperatoria continua</description>
        <inputEntry id="IE_FB_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_5"><text>-</text></inputEntry>
        <outputEntry id="OE_FB_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FB_2"><text>"Monitorar parametros fisiologicos intraoperatorios - converter para damage control se deterioracao"</text></outputEntry>
        <outputEntry id="OE_FB_3"><text>"Reavaliacao continua conforme evolucao durante o procedimento"</text></outputEntry>
      <outputEntry id="OE_Fallback_GEN_EME_007_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_GEN_EME_007_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
