<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_UGI_007"
             name="Esofagectomia - Cancer de Esofago"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-UGI-007 - Esofagectomia para Cancer de Esofago - Criterios de Indicacao
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Cirurgia Toracica/Oncologica
    Categoria: Procedimentos Cirurgicos Oncologicos

    Estadiamento (AJCC 8th):
    - T: Invasao de mucosa a adventicia
    - N: Linfonodos regionais
    - M: Metastases distantes

    Indicacoes Cirurgicas (NCCN/ESMO):
    - cT1b ou maior sem metastases distantes
    - Pos neoadjuvancia para cT2+ ou N+
    - Resseccao endoscopica inadequada (T1a com fatores)

    Contraindicacoes Relativas:
    - T4b (invasao irressecavel de estruturas)
    - M1 (doenca metastatica)
    - Performance status ruim
    - Comorbidades graves

    Abordagens:
    - Ivor Lewis: Esofagectomia transtoraco + anastomose toracica
    - McKeown: Tres campos (cervical, toracico, abdominal)
    - Transhiatal: Sem toracotomia (tumores distais)
    - Minimamente invasiva: Toracoscopia/laparoscopia

    Quimiorradioterapia Neoadjuvante:
    - Indicada para cT2+ ou N+ (CROSS protocol)
    - Melhora sobrevida e taxa de R0

    Documentacao Obrigatoria:
    - EDA com biopsias
    - TC torax/abdome/pelve
    - PET-CT
    - Ecoendoscopia

    Referencias Normativas:
    - NCCN Esophageal Cancer 2024
    - ESMO Oesophageal Cancer Guidelines 2022
    - ESSO/EORTC Guidelines
  -->

  <decision id="Decision_GEN_UGI_007" name="Criterios de Autorizacao - Esofagectomia Cancer">
    <decisionTable id="DecisionTable_GEN_UGI_007" hitPolicy="FIRST">

      <!-- Input 1: Estadiamento -->
      <input id="Input_estadiamento" label="Estadiamento Clinico">
        <inputExpression id="InputExpr_estadiamento" typeRef="string">
          <text>estadiamentoClinico</text>
        </inputExpression>
        <inputValues id="InputValues_estadiamento">
          <text>"cT1a","cT1b","cT2","cT3","cT4a","cT4b","M1"</text>
        </inputValues>
      </input>

      <!-- Input 2: Exames de Estadiamento -->
      <input id="Input_examesCompletos" label="Estadiamento Completo (TC/PET/EUS)">
        <inputExpression id="InputExpr_examesCompletos" typeRef="boolean">
          <text>estadiamentoCompleto</text>
        </inputExpression>
      </input>

      <!-- Input 3: Neoadjuvancia -->
      <input id="Input_neoadjuvancia" label="Quimiorradioterapia Neoadjuvante">
        <inputExpression id="InputExpr_neoadjuvancia" typeRef="string">
          <text>neoadjuvanciaRealizada</text>
        </inputExpression>
        <inputValues id="InputValues_neoadjuvancia">
          <text>"Realizada_Completa","Realizada_Parcial","Nao_Indicada","Indicada_Nao_Realizada"</text>
        </inputValues>
      </input>

      <!-- Input 4: Performance Status -->
      <input id="Input_performanceStatus" label="Performance Status (ECOG)">
        <inputExpression id="InputExpr_performanceStatus" typeRef="string">
          <text>performanceStatus</text>
        </inputExpression>
        <inputValues id="InputValues_performanceStatus">
          <text>"ECOG_0_1","ECOG_2","ECOG_3_4"</text>
        </inputValues>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_UGI_007_Reprovado_M1">
        <description>Reprovado - Doenca metastatica (M1)</description>
        <inputEntry id="IE_Rep1_1"><text>"M1"</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Cancer de esofago M1 (metastatico) - esofagectomia curativa nao indicada. Tratamento paliativo com quimioterapia, radioterapia ou stent."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"NCCN 2024 - Stage IV Palliative Treatment"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Reprovado_M1_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Reprovado_M1_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_007_Reprovado_T4b">
        <description>Reprovado - T4b irressecavel</description>
        <inputEntry id="IE_Rep2_1"><text>"cT4b"</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"T4b (invasao de aorta, traqueia, coluna) - irressecavel. Quimiorradioterapia definitiva. Reavaliar apos tratamento para possivel salvage."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"NCCN 2024 - Unresectable T4b"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Reprovado_T4b_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Reprovado_T4b_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_007_Reprovado_PS_Ruim">
        <description>Reprovado - Performance status ruim</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>"ECOG_3_4"</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"ECOG 3-4 - performance status incompativel com cirurgia de grande porte. Esofagectomia tem alta morbimortalidade. Tratamento paliativo."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"NCCN 2024 - Performance Status Criteria"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Reprovado_PS_Ruim_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Reprovado_PS_Ruim_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_007_Reprovado_SemEstadiamento">
        <description>Reprovado - Sem estadiamento completo</description>
        <inputEntry id="IE_Rep4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_2"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep4_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep4_2"><text>"Estadiamento completo obrigatorio: TC torax/abdome/pelve, PET-CT, ecoendoscopia (EUS). Broncoscopia se tumor medio/proximal."</text></outputEntry>
        <outputEntry id="OE_Rep4_3"><text>"NCCN 2024 - Complete Staging Required"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Reprovado_SemEstadiamento_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Reprovado_SemEstadiamento_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_007_Reprovado_SemLaudo">
        <description>Reprovado - Sem laudo de indicacao</description>
        <inputEntry id="IE_Rep5_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep5_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep5_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep5_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep5_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep5_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep5_2"><text>"Laudo de indicacao obrigatorio com estadiamento completo, histologia, localizacao e abordagem cirurgica proposta."</text></outputEntry>
        <outputEntry id="OE_Rep5_3"><text>"RN 465/2021 - Documentacao Obrigatoria"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Reprovado_SemLaudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Reprovado_SemLaudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_UGI_007_Aprovado_T1a">
        <description>Aprovado - T1a apos falha de resseccao endoscopica</description>
        <inputEntry id="IE_Apr1_1"><text>"cT1a"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"Nao_Indicada"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>"ECOG_0_1"</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"T1a com fatores desfavoraveis (invasao sm, LVI, margem+) apos resseccao endoscopica - esofagectomia aprovada."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"NCCN 2024 - T1a High Risk"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Aprovado_T1a_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Aprovado_T1a_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_007_Aprovado_T1b">
        <description>Aprovado - T1b N0</description>
        <inputEntry id="IE_Apr2_1"><text>"cT1b"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>"Nao_Indicada"</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>"ECOG_0_1"</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Cancer esofago T1b - esofagectomia com linfadenectomia aprovada. Risco de metastase linfonodal 20-30%. Neoadjuvancia opcional."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"NCCN 2024 - T1b Esophagectomy"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Aprovado_T1b_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Aprovado_T1b_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_007_Aprovado_PosNeoadjuvancia">
        <description>Aprovado - T2-T4a pos neoadjuvancia</description>
        <inputEntry id="IE_Apr3_1"><text>"cT2","cT3","cT4a"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>"Realizada_Completa"</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>"ECOG_0_1","ECOG_2"</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Esofagectomia pos quimiorradioterapia neoadjuvante (CROSS) aprovada. Cirurgia 6-10 semanas apos fim da radioterapia. Centro de alto volume recomendado."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"NCCN 2024 / CROSS Trial - Post-Neoadjuvant Surgery"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Aprovado_PosNeoadjuvancia_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Aprovado_PosNeoadjuvancia_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_UGI_007_Pendente_SemNeoadjuvancia">
        <description>Pendente - T2+ sem neoadjuvancia</description>
        <inputEntry id="IE_Pend1_1"><text>"cT2","cT3","cT4a"</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>true</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>"Indicada_Nao_Realizada"</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Cancer esofago cT2+ ou N+ - quimiorradioterapia neoadjuvante (CROSS) melhora sobrevida. Realizar antes de cirurgia."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"NCCN 2024 - Neoadjuvant CRT for T2+"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Pendente_SemNeoadjuvancia_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Pendente_SemNeoadjuvancia_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_007_Pendente_ECOG2">
        <description>Pendente - ECOG 2 requer otimizacao</description>
        <inputEntry id="IE_Pend2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>"ECOG_2"</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"ECOG 2 - avaliar otimizacao nutricional, funcao pulmonar e cardiaca antes de esofagectomia. Fisioterapia pre-habilitacao recomendada."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"ESSO/EORTC - Prehabilitation"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Pendente_ECOG2_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Pendente_ECOG2_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_007_Pendente_NeoadjuvanciaParcial">
        <description>Pendente - Neoadjuvancia parcial</description>
        <inputEntry id="IE_Pend3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend3_3"><text>"Realizada_Parcial"</text></inputEntry>
        <inputEntry id="IE_Pend3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend3_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend3_2"><text>"Neoadjuvancia incompleta - avaliar motivo e possibilidade de completar. Se toxicidade, discutir em tumor board beneficio de cirurgia imediata."</text></outputEntry>
        <outputEntry id="OE_Pend3_3"><text>"NCCN 2024 - Incomplete Neoadjuvant"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Pendente_NeoadjuvanciaParcial_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Pendente_NeoadjuvanciaParcial_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_UGI_007_Fallback">
        <description>Fallback - Analise especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso de cancer de esofago requer discussao em tumor board multidisciplinar (oncologia, cirurgia, radioterapia)."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria oncologica - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_007_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_007_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
