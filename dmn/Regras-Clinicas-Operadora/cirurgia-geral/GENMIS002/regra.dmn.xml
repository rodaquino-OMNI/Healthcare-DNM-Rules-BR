<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_GEN_MIS_002"
             name="Sarcoma de Partes Moles - Resseccao Ampla"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    CODIGO: GEN-MIS-002
    Procedimento: Sarcoma de Partes Moles - Criterios para Resseccao Ampla
    Especialidade: Cirurgia Geral - Procedimentos Diversos
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES CIRURGICAS:
    - Sarcoma confirmado por biopsia
    - Margens amplas (2-3 cm ou fascia profunda)
    - Tumor ressecavel sem mutilacao
    - Estadiamento completo (TC torax, RNM local)

    CONTRAINDICACOES:
    - Doenca metastatica extensa (relativa)
    - Tumor irressecavel
    - Biopsia incisional inadequada (excisar trajeto)

    REFERENCIAS TECNICAS:
    - NCCN Soft Tissue Sarcoma 2023
    - ESMO Sarcoma Guidelines 2021
    - SBCO Guidelines Sarcoma 2022

    ===============================================================================
  -->

  <decision id="Decision_GEN_MIS_002" name="Regra Clinica - Sarcoma Partes Moles">
    <decisionTable id="DecisionTable_GEN_MIS_002" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_confirmacaoHistologica" label="Confirmacao Histologica" camunda:inputVariable="confirmacaoHistologica">
        <inputExpression id="InputExpression_confirmacaoHistologica" typeRef="string">
          <text>confirmacaoHistologica</text>
        </inputExpression>
        <inputValues id="InputValues_confirmacaoHistologica">
          <text>"SarcomaConfirmado","SuspeitaSarcoma","Benigno","NaoRealizada"</text>
        </inputValues>
      </input>

      <input id="Input_tamanhoTumor" label="Tamanho do Tumor (cm)" camunda:inputVariable="tamanhoTumor">
        <inputExpression id="InputExpression_tamanhoTumor" typeRef="number">
          <text>tamanhoTumor</text>
        </inputExpression>
      </input>

      <input id="Input_grauHistologico" label="Grau Histologico FNCLCC" camunda:inputVariable="grauHistologico">
        <inputExpression id="InputExpression_grauHistologico" typeRef="string">
          <text>grauHistologico</text>
        </inputExpression>
        <inputValues id="InputValues_grauHistologico">
          <text>"Grau1","Grau2","Grau3","NaoDefinido"</text>
        </inputValues>
      </input>

      <input id="Input_estadiamentoCompleto" label="Estadiamento Completo (TC/RNM)" camunda:inputVariable="estadiamentoCompleto">
        <inputExpression id="InputExpression_estadiamentoCompleto" typeRef="boolean">
          <text>estadiamentoCompleto</text>
        </inputExpression>
      </input>

      <input id="Input_metastaseDistancia" label="Metastase a Distancia" camunda:inputVariable="metastaseDistancia">
        <inputExpression id="InputExpression_metastaseDistancia" typeRef="string">
          <text>metastaseDistancia</text>
        </inputExpression>
        <inputValues id="InputValues_metastaseDistancia">
          <text>"Ausente","PulmonarRessecavel","PulmonarIrressecavel","Multiplas"</text>
        </inputValues>
      </input>

      <!-- ========== OUTPUTS (3) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== REGRAS DE REPROVACAO ========== -->

      <rule id="Rule_Reprovado_SemBiopsia">
        <description>Reprovado: Sem confirmacao histologica</description>
        <inputEntry id="IE_Rep1_1"><text>"NaoRealizada"</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Biopsia obrigatoria antes de resseccao ampla - core biopsy ou incisional"</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"NCCN 2023 - Biopsia pre-operatoria e mandatoria para planejamento cirurgico"</text></outputEntry>
      <outputEntry id="OE_Reprovado_SemBiopsia_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_SemBiopsia_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_MetastaseMultipla">
        <description>Reprovado: Metastases multiplas irressecaveis</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>"Multiplas","PulmonarIrressecavel"</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Doenca metastatica extensa - quimioterapia sistemica prioritaria"</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"ESMO 2021 - Cirurgia primaria nao indicada em doenca disseminada"</text></outputEntry>
      <outputEntry id="OE_Reprovado_MetastaseMultipla_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_MetastaseMultipla_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_SemEstadiamento">
        <description>Reprovado: Estadiamento incompleto</description>
        <inputEntry id="IE_Rep3_1"><text>"SarcomaConfirmado"</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Completar estadiamento - TC torax e RNM local obrigatorios"</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"NCCN 2023 - Estadiamento completo antes de definir tratamento"</text></outputEntry>
      <outputEntry id="OE_Reprovado_SemEstadiamento_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_SemEstadiamento_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRAS DE APROVACAO ========== -->

      <rule id="Rule_Aprovado_LocalizadoAltoGrau">
        <description>Aprovado: Sarcoma localizado alto grau</description>
        <inputEntry id="IE_Apr1_1"><text>"SarcomaConfirmado"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>&gt;= 5</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"Grau2","Grau3"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>"Ausente"</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Sarcoma alto grau localizado - resseccao ampla + considerar RT neoadjuvante/adjuvante"</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"NCCN 2023 - Tumores &gt; 5cm alto grau: cirurgia + radioterapia"</text></outputEntry>
      <outputEntry id="OE_Aprovado_LocalizadoAltoGrau_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_LocalizadoAltoGrau_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_LocalizadoBaixoGrau">
        <description>Aprovado: Sarcoma localizado baixo grau</description>
        <inputEntry id="IE_Apr2_1"><text>"SarcomaConfirmado"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>"Grau1"</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>"Ausente"</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Sarcoma baixo grau - resseccao ampla com margens de 1-2 cm"</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"ESMO 2021 - Grau 1 geralmente nao requer radioterapia adjuvante"</text></outputEntry>
      <outputEntry id="OE_Aprovado_LocalizadoBaixoGrau_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_LocalizadoBaixoGrau_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_MetastaseRessecavel">
        <description>Aprovado: Metastase pulmonar ressecavel</description>
        <inputEntry id="IE_Apr3_1"><text>"SarcomaConfirmado"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>"PulmonarRessecavel"</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Metastase pulmonar ressecavel - resseccao primaria + metastasectomia estagiada"</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"NCCN 2023 - Oligometastase pulmonar pode ser ressecada com intencao curativa"</text></outputEntry>
      <outputEntry id="OE_Aprovado_MetastaseRessecavel_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_MetastaseRessecavel_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_PequenoSuperficial">
        <description>Aprovado: Tumor pequeno superficial</description>
        <inputEntry id="IE_Apr4_1"><text>"SarcomaConfirmado"</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>&lt; 5</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>"Ausente"</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"Sarcoma &lt; 5cm - resseccao ampla, RT adjuvante se margens exiguas"</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"SBCO 2022 - Tumores T1 tem melhor prognostico com cirurgia adequada"</text></outputEntry>
      <outputEntry id="OE_Aprovado_PequenoSuperficial_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_PequenoSuperficial_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRA FALLBACK ========== -->

      <rule id="Rule_Fallback_GEN_MIS_002">
        <description>Pendente: Completar avaliacao diagnostica</description>
        <inputEntry id="IE_FB_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_5"><text>-</text></inputEntry>
        <outputEntry id="OE_FB_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FB_2"><text>"Realizar biopsia (core ou incisional) e estadiamento completo"</text></outputEntry>
        <outputEntry id="OE_FB_3"><text>"NCCN 2023 - Avaliacao multidisciplinar em centro de referencia"</text></outputEntry>
      <outputEntry id="OE_Fallback_GEN_MIS_002_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_GEN_MIS_002_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
