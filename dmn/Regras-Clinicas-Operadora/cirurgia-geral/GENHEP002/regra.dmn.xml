<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_HEP_002"
             name="Colecistectomia - Colecistite Aguda Timing"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-HEP-002 - Colecistectomia para Colecistite Aguda - Criterios de Timing
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Hepatobiliar
    Categoria: Procedimentos Cirurgicos

    Indicacoes Clinicas (Tokyo Guidelines 2018 / SAGES 2023):
    - Colecistite aguda grau I (leve): Colecistectomia precoce em ate 72h
    - Colecistite aguda grau II (moderada): Colecistectomia precoce se equipe experiente
    - Colecistite aguda grau III (grave): Drenagem percutanea primeiro, colecistectomia diferida
    - Intervalo ideal pos-episodio agudo: 6-8 semanas se tratamento conservador inicial

    Contraindicacoes:
    - Colecistite grau III sem estabilizacao hemodinamica
    - Coagulopatia nao corrigida
    - Risco cirurgico ASA V sem urgencia vital

    Documentacao Obrigatoria:
    - USG ou TC confirmando colecistite aguda
    - Classificacao de gravidade (Tokyo Grading)
    - Tempo de evolucao dos sintomas
    - Avaliacao pre-operatoria com ASA

    Referencias Normativas:
    - Tokyo Guidelines 2018 (TG18) - Acute Cholecystitis
    - SAGES 2023 - Timing of Cholecystectomy
    - WSES 2020 - Emergency Surgery Guidelines
  -->

  <decision id="Decision_GEN_HEP_002" name="Criterios de Autorizacao - Colecistectomia Timing Colecistite">
    <decisionTable id="DecisionTable_GEN_HEP_002" hitPolicy="FIRST">

      <!-- Input 1: Grau de Gravidade (Tokyo Grading) -->
      <input id="Input_grauGravidade" label="Grau de Gravidade (Tokyo)">
        <inputExpression id="InputExpr_grauGravidade" typeRef="string">
          <text>grauGravidadeTokyo</text>
        </inputExpression>
        <inputValues id="InputValues_grauGravidade">
          <text>"Grau_I_Leve","Grau_II_Moderada","Grau_III_Grave","Nao_Classificado"</text>
        </inputValues>
      </input>

      <!-- Input 2: Tempo de Evolucao -->
      <input id="Input_tempoEvolucao" label="Tempo de Evolucao (horas)">
        <inputExpression id="InputExpr_tempoEvolucao" typeRef="string">
          <text>tempoEvolucao</text>
        </inputExpression>
        <inputValues id="InputValues_tempoEvolucao">
          <text>"Ate_72h","72h_a_7dias","Mais_7dias","Intervalar_6_8_semanas"</text>
        </inputValues>
      </input>

      <!-- Input 3: Imagem Confirmatoria -->
      <input id="Input_imagemConfirmatoria" label="USG/TC Confirmando Colecistite">
        <inputExpression id="InputExpr_imagemConfirmatoria" typeRef="boolean">
          <text>imagemConfirmatoria</text>
        </inputExpression>
      </input>

      <!-- Input 4: Risco Cirurgico (ASA) -->
      <input id="Input_riscoCirurgico" label="Classificacao de Risco Cirurgico (ASA)">
        <inputExpression id="InputExpr_riscoCirurgico" typeRef="string">
          <text>riscoCirurgico</text>
        </inputExpression>
        <inputValues id="InputValues_riscoCirurgico">
          <text>"ASA_I","ASA_II","ASA_III","ASA_IV","ASA_V"</text>
        </inputValues>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao Cirurgica">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao Legal/Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_HEP_002_Reprovado_ASA_V">
        <description>Reprovado - ASA V sem urgencia vital</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>"ASA_V"</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Risco cirurgico ASA V proibitivo. Considerar drenagem percutanea (colecistostomia) como alternativa menos invasiva."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"Tokyo Guidelines 2018 - High Risk Patient Management"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Reprovado_ASA_V_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Reprovado_ASA_V_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_002_Reprovado_SemImagem">
        <description>Reprovado - Sem confirmacao por imagem</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Confirmacao diagnostica por imagem (USG ou TC) e obrigatoria para autorizacao de colecistectomia por colecistite aguda."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"Tokyo Guidelines 2018 - Diagnostic Criteria"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Reprovado_SemImagem_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Reprovado_SemImagem_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_002_Reprovado_SemLaudo">
        <description>Reprovado - Sem laudo de indicacao</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Laudo de indicacao cirurgica obrigatorio com classificacao de gravidade e justificativa de timing."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"RN 465/2021 - Documentacao Obrigatoria"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Reprovado_SemLaudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Reprovado_SemLaudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_HEP_002_Aprovado_GrauI_Precoce">
        <description>Aprovado - Grau I colecistectomia precoce ate 72h</description>
        <inputEntry id="IE_Apr1_1"><text>"Grau_I_Leve"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"Ate_72h"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>"ASA_I","ASA_II","ASA_III"</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Colecistite aguda grau I - colecistectomia precoce (ate 72h) indicada. Timing ideal conforme Tokyo Guidelines 2018."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"Tokyo Guidelines 2018 (TG18) - Early Cholecystectomy Grade I"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Aprovado_GrauI_Precoce_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Aprovado_GrauI_Precoce_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_002_Aprovado_GrauII_Precoce">
        <description>Aprovado - Grau II colecistectomia precoce com equipe experiente</description>
        <inputEntry id="IE_Apr2_1"><text>"Grau_II_Moderada"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"Ate_72h"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>"ASA_I","ASA_II","ASA_III"</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Colecistite aguda grau II - colecistectomia precoce indicada se equipe cirurgica experiente disponivel. Considerar conversao para aberta se dificuldade tecnica."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"Tokyo Guidelines 2018 (TG18) - Early Cholecystectomy Grade II"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Aprovado_GrauII_Precoce_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Aprovado_GrauII_Precoce_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_002_Aprovado_Intervalar">
        <description>Aprovado - Colecistectomia intervalar pos-tratamento conservador</description>
        <inputEntry id="IE_Apr3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"Intervalar_6_8_semanas"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>"ASA_I","ASA_II","ASA_III","ASA_IV"</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Colecistectomia intervalar (6-8 semanas pos-episodio agudo) indicada apos tratamento conservador bem-sucedido. Timing adequado para reducao de complicacoes."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"SAGES 2023 - Interval Cholecystectomy"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Aprovado_Intervalar_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Aprovado_Intervalar_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_HEP_002_Pendente_GrauIII">
        <description>Pendente - Grau III requer drenagem primeiro</description>
        <inputEntry id="IE_Pend1_1"><text>"Grau_III_Grave"</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Colecistite grau III (grave) - considerar colecistostomia percutanea para estabilizacao antes de colecistectomia. Encaminhar para discussao multidisciplinar."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"Tokyo Guidelines 2018 - Severe Cholecystitis Management"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Pendente_GrauIII_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Pendente_GrauIII_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_HEP_002_Pendente_NaoClassificado">
        <description>Pendente - Gravidade nao classificada</description>
        <inputEntry id="IE_Pend2_1"><text>"Nao_Classificado"</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"Classificacao de gravidade (Tokyo Grading) nao informada. Anexar avaliacao com grau I, II ou III para definicao de timing cirurgico."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"Tokyo Guidelines 2018 - Severity Grading Required"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Pendente_NaoClassificado_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Pendente_NaoClassificado_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_HEP_002_Fallback">
        <description>Fallback - Analise manual necessaria</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso requer analise manual por auditor medico. Criterios de timing e gravidade nao claramente definidos."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria medica especializada - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_HEP_002_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_HEP_002_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
