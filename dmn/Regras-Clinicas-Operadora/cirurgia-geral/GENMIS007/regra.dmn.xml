<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_GEN_MIS_007"
             name="Gastrostomia Endoscopica - Criterios PEG"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    CODIGO: GEN-MIS-007
    Procedimento: Gastrostomia Endoscopica Percutanea (PEG) - Criterios
    Especialidade: Cirurgia Geral - Procedimentos Diversos
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES:
    - Disfagia prolongada (> 4 semanas previstas)
    - AVC com disfagia persistente
    - Neoplasia de cabeca e pescoco
    - Doencas neurologicas progressivas (ELA, Parkinson)
    - Trauma cranioencefalico

    CONTRAINDICACOES:
    - Expectativa de vida < 4 semanas
    - Ascite volumosa
    - Hipertensao portal com varizes gastricas
    - Impossibilidade de transligamentacao
    - Coagulopatia grave

    REFERENCIAS TECNICAS:
    - ESPEN Guidelines Enteral Nutrition 2020
    - ASGE Standards PEG 2021
    - SBCM Terapia Nutricional 2022

    ===============================================================================
  -->

  <decision id="Decision_GEN_MIS_007" name="Regra Clinica - PEG Gastrostomia">
    <decisionTable id="DecisionTable_GEN_MIS_007" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_indicacaoDisfagia" label="Indicacao da Disfagia" camunda:inputVariable="indicacaoDisfagia">
        <inputExpression id="InputExpression_indicacaoDisfagia" typeRef="string">
          <text>indicacaoDisfagia</text>
        </inputExpression>
        <inputValues id="InputValues_indicacaoDisfagia">
          <text>"AVC","NeoplasiaCabecaPescoco","DoencaNeurologicaProgressiva","TCE","Demencia","Outros"</text>
        </inputValues>
      </input>

      <input id="Input_duracaoPrevistaNutricao" label="Duracao Prevista de Nutricao Enteral (semanas)" camunda:inputVariable="duracaoPrevistaNutricao">
        <inputExpression id="InputExpression_duracaoPrevistaNutricao" typeRef="number">
          <text>duracaoPrevistaNutricao</text>
        </inputExpression>
      </input>

      <input id="Input_expectativaVida" label="Expectativa de Vida (semanas)" camunda:inputVariable="expectativaVida">
        <inputExpression id="InputExpression_expectativaVida" typeRef="number">
          <text>expectativaVida</text>
        </inputExpression>
      </input>

      <input id="Input_asciteHipertensaoPortal" label="Ascite ou Hipertensao Portal" camunda:inputVariable="asciteHipertensaoPortal">
        <inputExpression id="InputExpression_asciteHipertensaoPortal" typeRef="string">
          <text>asciteHipertensaoPortal</text>
        </inputExpression>
        <inputValues id="InputValues_asciteHipertensaoPortal">
          <text>"Ausente","AsciteLeve","AsciteModerada","AsciteVolumosa","VarizesGastricas"</text>
        </inputValues>
      </input>

      <input id="Input_transligamentacao" label="Transligamentacao Possivel (EDA previa)" camunda:inputVariable="transligamentacao">
        <inputExpression id="InputExpression_transligamentacao" typeRef="string">
          <text>transligamentacao</text>
        </inputExpression>
        <inputValues id="InputValues_transligamentacao">
          <text>"Possivel","Dificil","Impossivel","NaoAvaliada"</text>
        </inputValues>
      </input>

      <!-- ========== OUTPUTS (3) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== REGRAS DE REPROVACAO ========== -->

      <rule id="Rule_Reprovado_ExpectativaCurta">
        <description>Reprovado: Expectativa de vida muito curta</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>&lt; 4</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Expectativa de vida &lt; 4 semanas - PEG nao indicada, manter SNE ou cuidados paliativos"</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ESPEN 2020 - PEG so justificada se expectativa &gt; 4 semanas"</text></outputEntry>
      <outputEntry id="OE_Reprovado_ExpectativaCurta_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_ExpectativaCurta_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_AsciteVolumosa">
        <description>Reprovado: Ascite volumosa ou varizes gastricas</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>"AsciteVolumosa","VarizesGastricas"</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Ascite volumosa ou varizes gastricas - PEG contraindicada, considerar gastrostomia cirurgica"</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"ASGE 2021 - Ascite tensa e varizes gastricas sao contraindicacoes absolutas"</text></outputEntry>
      <outputEntry id="OE_Reprovado_AsciteVolumosa_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_AsciteVolumosa_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_TransligamentacaoImpossivel">
        <description>Reprovado: Transligamentacao impossivel</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>"Impossivel"</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Transligamentacao impossivel - considerar gastrostomia cirurgica ou radiologica"</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"ASGE 2021 - Interposicao hepatica ou colonica impede PEG segura"</text></outputEntry>
      <outputEntry id="OE_Reprovado_TransligamentacaoImpossivel_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_TransligamentacaoImpossivel_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_DuracaoCurta">
        <description>Reprovado: Duracao prevista curta</description>
        <inputEntry id="IE_Rep4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_2"><text>&lt; 4</text></inputEntry>
        <inputEntry id="IE_Rep4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep4_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep4_2"><text>"Nutricao enteral prevista &lt; 4 semanas - manter sonda nasoenteral"</text></outputEntry>
        <outputEntry id="OE_Rep4_3"><text>"ESPEN 2020 - SNE adequada para uso &lt; 4 semanas"</text></outputEntry>
      <outputEntry id="OE_Reprovado_DuracaoCurta_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_DuracaoCurta_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRAS DE APROVACAO ========== -->

      <rule id="Rule_Aprovado_AVCDisfagia">
        <description>Aprovado: AVC com disfagia persistente</description>
        <inputEntry id="IE_Apr1_1"><text>"AVC"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>&gt;= 4</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>&gt;= 4</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>"Ausente","AsciteLeve"</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>"Possivel","Dificil"</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"AVC com disfagia persistente apos 2-3 semanas - PEG indicada para nutricao segura"</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"ESPEN 2020 - PEG em AVC se disfagia persistir apos avaliacao fonoaudiologica"</text></outputEntry>
      <outputEntry id="OE_Aprovado_AVCDisfagia_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_AVCDisfagia_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_NeoplasiaCabecaPescoco">
        <description>Aprovado: Neoplasia de cabeca e pescoco</description>
        <inputEntry id="IE_Apr2_1"><text>"NeoplasiaCabecaPescoco"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>&gt;= 4</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>&gt;= 8</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>"Ausente","AsciteLeve"</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>"Possivel"</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Neoplasia cabeca/pescoco - PEG profilatica antes de RT/QT se disfagia prevista"</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"SBCM 2022 - PEG profilatica em tumores com mucosite esperada grau 3-4"</text></outputEntry>
      <outputEntry id="OE_Aprovado_NeoplasiaCabecaPescoco_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_NeoplasiaCabecaPescoco_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_DoencaNeurologica">
        <description>Aprovado: Doenca neurologica progressiva</description>
        <inputEntry id="IE_Apr3_1"><text>"DoencaNeurologicaProgressiva"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>&gt;= 4</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>&gt;= 12</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>"Possivel"</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Doenca neurologica progressiva (ELA, Parkinson) - PEG antes de perda de capacidade vital"</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"ESPEN 2020 - Em ELA, PEG quando CVF ainda &gt; 50%"</text></outputEntry>
      <outputEntry id="OE_Aprovado_DoencaNeurologica_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_DoencaNeurologica_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_TCE">
        <description>Aprovado: TCE com disfagia prolongada</description>
        <inputEntry id="IE_Apr4_1"><text>"TCE"</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>&gt;= 4</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>&gt;= 8</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>"Ausente"</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>"Possivel","Dificil"</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"TCE grave com disfagia persistente - PEG para suporte nutricional em reabilitacao"</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"SBCM 2022 - PEG em TCE se nutricao enteral &gt; 4 semanas prevista"</text></outputEntry>
      <outputEntry id="OE_Aprovado_TCE_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_TCE_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRA FALLBACK ========== -->

      <rule id="Rule_Fallback_GEN_MIS_007">
        <description>Pendente: Avaliar transligamentacao por EDA</description>
        <inputEntry id="IE_FB_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_5"><text>-</text></inputEntry>
        <outputEntry id="OE_FB_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FB_2"><text>"Realizar EDA para avaliar transligamentacao e excluir contraindicacoes"</text></outputEntry>
        <outputEntry id="OE_FB_3"><text>"ASGE 2021 - Avaliacao endoscopica previa obrigatoria para PEG"</text></outputEntry>
      <outputEntry id="OE_Fallback_GEN_MIS_007_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_GEN_MIS_007_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
