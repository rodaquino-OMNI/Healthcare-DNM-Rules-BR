<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_UGI_005"
             name="Cirurgia Bariatrica Revisional"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-UGI-005 - Cirurgia Bariatrica Revisional - Indicacoes
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Cirurgia Bariatrica
    Categoria: Procedimentos Cirurgicos

    Indicacoes de Revisao (ASMBS 2022 / IFSO):
    - Perda de peso insuficiente (<50% excesso)
    - Reganho de peso significativo (>15-20% do minimo)
    - Complicacoes da cirurgia primaria
    - Falha anatomica (dilatacao de pouch, fistula)

    Conversoes Comuns:
    - Banda para Bypass ou Sleeve
    - Sleeve para Bypass (DRGE, perda insuficiente)
    - Bypass para SADI-S ou DS (reganho)

    Avaliacoes Pre-operatorias:
    - EDA (anatomia, ulceras, estenose)
    - Seriografia (transito, tamanho pouch/sleeve)
    - Avaliacao nutricional
    - Avaliacao psicologica

    Requisitos:
    - Documentacao da cirurgia primaria
    - Justificativa da falha
    - Comprometimento com seguimento

    Referencias Normativas:
    - ASMBS Revision Surgery Guidelines 2022
    - IFSO Guidelines Revisional Surgery
    - CFM Resolucao 2131/2015
  -->

  <decision id="Decision_GEN_UGI_005" name="Criterios de Autorizacao - Bariatrica Revisional">
    <decisionTable id="DecisionTable_GEN_UGI_005" hitPolicy="FIRST">

      <!-- Input 1: Cirurgia Primaria -->
      <input id="Input_cirurgiaPrimaria" label="Cirurgia Bariatrica Primaria">
        <inputExpression id="InputExpr_cirurgiaPrimaria" typeRef="string">
          <text>cirurgiaPrimaria</text>
        </inputExpression>
        <inputValues id="InputValues_cirurgiaPrimaria">
          <text>"Banda_Gastrica","Sleeve","Bypass_Gastrico","Outro"</text>
        </inputValues>
      </input>

      <!-- Input 2: Motivo da Revisao -->
      <input id="Input_motivoRevisao" label="Motivo da Revisao">
        <inputExpression id="InputExpr_motivoRevisao" typeRef="string">
          <text>motivoRevisao</text>
        </inputExpression>
        <inputValues id="InputValues_motivoRevisao">
          <text>"Perda_Peso_Insuficiente","Reganho_Peso","Complicacao_Anatomica","DRGE_Severa","Desnutricao"</text>
        </inputValues>
      </input>

      <!-- Input 3: Exames Anatomicos -->
      <input id="Input_examesAnatomicos" label="EDA e Seriografia Realizados">
        <inputExpression id="InputExpr_examesAnatomicos" typeRef="boolean">
          <text>examesAnatomicosRealizados</text>
        </inputExpression>
      </input>

      <!-- Input 4: Avaliacao Multidisciplinar -->
      <input id="Input_avaliacaoMulti" label="Avaliacao Multidisciplinar Completa">
        <inputExpression id="InputExpr_avaliacaoMulti" typeRef="boolean">
          <text>avaliacaoMultidisciplinarCompleta</text>
        </inputExpression>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_UGI_005_Reprovado_SemExames">
        <description>Reprovado - Sem exames anatomicos</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"EDA e seriografia obrigatorias para avaliar anatomia pos-bariatrica, identificar causa da falha e planejar revisao."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ASMBS 2022 - Anatomic Assessment Required"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Reprovado_SemExames_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Reprovado_SemExames_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_005_Reprovado_SemEquipeMulti">
        <description>Reprovado - Sem avaliacao multidisciplinar</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Avaliacao multidisciplinar completa (nutricao, psicologia, endocrinologia) obrigatoria para cirurgia bariatrica revisional."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"CFM 2131/2015 - Equipe Multidisciplinar"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Reprovado_SemEquipeMulti_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Reprovado_SemEquipeMulti_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_005_Reprovado_SemLaudo">
        <description>Reprovado - Sem laudo de indicacao</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Laudo de indicacao obrigatorio com relatorio da cirurgia primaria, motivo da falha e procedimento revisional proposto."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"RN 465/2021 - Documentacao Obrigatoria"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Reprovado_SemLaudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Reprovado_SemLaudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_UGI_005_Aprovado_Banda_Complicacao">
        <description>Aprovado - Remocao de banda com complicacao</description>
        <inputEntry id="IE_Apr1_1"><text>"Banda_Gastrica"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"Complicacao_Anatomica"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Banda gastrica com complicacao (slippage, erosao, infeccao) - remocao aprovada. Conversao para sleeve/bypass em mesmo tempo ou estagiado."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"ASMBS 2022 - Band Removal and Conversion"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Aprovado_Banda_Complicacao_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Aprovado_Banda_Complicacao_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_005_Aprovado_Sleeve_DRGE">
        <description>Aprovado - Sleeve com DRGE severa</description>
        <inputEntry id="IE_Apr2_1"><text>"Sleeve"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"DRGE_Severa"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"DRGE severa pos-sleeve refrataria a IBP - conversao para bypass gastrico em Y-de-Roux aprovada. Corrige refluxo e mantem perda de peso."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"ASMBS 2022 - Sleeve to Bypass for GERD"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Aprovado_Sleeve_DRGE_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Aprovado_Sleeve_DRGE_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_005_Aprovado_Reganho_Completa">
        <description>Aprovado - Reganho com documentacao completa</description>
        <inputEntry id="IE_Apr3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"Reganho_Peso"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Reganho de peso significativo com causa anatomica identificada e avaliacao multidisciplinar completa - cirurgia revisional aprovada."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"ASMBS 2022 - Weight Regain Revision"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Aprovado_Reganho_Completa_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Aprovado_Reganho_Completa_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_UGI_005_Aprovado_Desnutricao">
        <description>Aprovado - Desnutricao severa pos-disabsortiva</description>
        <inputEntry id="IE_Apr4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>"Desnutricao"</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"Desnutricao severa pos-cirurgia disabsortiva - reversao ou revisao aprovada. Alongamento de alca comum pode ser necessario."</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"ASMBS 2022 - Malnutrition Revision"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Aprovado_Desnutricao_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Aprovado_Desnutricao_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_UGI_005_Pendente_PerdaInsuficiente">
        <description>Pendente - Perda insuficiente requer avaliacao</description>
        <inputEntry id="IE_Pend1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>"Perda_Peso_Insuficiente"</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Perda de peso insuficiente - avaliar adesao, fatores comportamentais e anatomia antes de revisao. Anexar avaliacao nutricional e psicologica."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"ASMBS 2022 - Assess Compliance First"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Pendente_PerdaInsuficiente_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Pendente_PerdaInsuficiente_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_UGI_005_Fallback">
        <description>Fallback - Analise especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso de cirurgia bariatrica revisional requer analise por equipe multidisciplinar de obesidade."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria bariatrica - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_UGI_005_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_UGI_005_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
