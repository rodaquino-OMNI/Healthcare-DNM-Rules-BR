<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_GEN_BRE_002"
             name="Biopsia de Linfonodo Sentinela - Criterios"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    CODIGO: GEN-BRE-002
    Procedimento: Biopsia de Linfonodo Sentinela - Criterios de Elegibilidade
    Especialidade: Cirurgia Geral - Mastologia
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES PARA BLS:
    - Carcinoma invasivo clinicamente N0
    - CDIS extenso com indicacao de mastectomia
    - Pos-quimioterapia neoadjuvante (cN0 inicial)
    - Tumor T1-T2 clinicamente node-negativo

    CONTRAINDICACOES:
    - Linfonodos clinicamente positivos (cN1-3)
    - Carcinoma inflamatorio
    - BLS previa ipsilateral
    - Gestacao (contraindicacao a mapeamento com tecnecio)

    REFERENCIAS TECNICAS:
    - ASCO/SSO Sentinel Node Guidelines 2017
    - NCCN Breast Cancer Guidelines 2024
    - ACOSOG Z0011 Trial

    ===============================================================================
  -->

  <decision id="Decision_GEN_BRE_002" name="Regra Clinica - Biopsia Linfonodo Sentinela">
    <decisionTable id="DecisionTable_GEN_BRE_002" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_estadioClinico" label="Estadio Clinico N" camunda:inputVariable="estadioClinico">
        <inputExpression id="InputExpression_estadioClinico" typeRef="string">
          <text>estadioClinico</text>
        </inputExpression>
        <inputValues id="InputValues_estadioClinico">
          <text>"cN0","cN1","cN2","cN3"</text>
        </inputValues>
      </input>

      <input id="Input_tipoTumor" label="Tipo de Tumor" camunda:inputVariable="tipoTumor">
        <inputExpression id="InputExpression_tipoTumor" typeRef="string">
          <text>tipoTumor</text>
        </inputExpression>
        <inputValues id="InputValues_tipoTumor">
          <text>"CarcinomaInvasivo","CDIS","CarcinomaInflamatorio","Outro"</text>
        </inputValues>
      </input>

      <input id="Input_tamanhoTumor" label="Tamanho Tumor (T)" camunda:inputVariable="tamanhoTumor">
        <inputExpression id="InputExpression_tamanhoTumor" typeRef="string">
          <text>tamanhoTumor</text>
        </inputExpression>
        <inputValues id="InputValues_tamanhoTumor">
          <text>"T1","T2","T3","T4"</text>
        </inputValues>
      </input>

      <input id="Input_neoadjuvancia" label="Pos-Neoadjuvancia" camunda:inputVariable="neoadjuvancia">
        <inputExpression id="InputExpression_neoadjuvancia" typeRef="string">
          <text>neoadjuvancia</text>
        </inputExpression>
        <inputValues id="InputValues_neoadjuvancia">
          <text>"cN0_Inicial","cN1_Convertido","NaoRealizada"</text>
        </inputValues>
      </input>

      <input id="Input_blsPrevia" label="BLS Previa Ipsilateral" camunda:inputVariable="blsPrevia">
        <inputExpression id="InputExpression_blsPrevia" typeRef="boolean">
          <text>blsPrevia</text>
        </inputExpression>
      </input>

      <!-- ========== OUTPUTS (3) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== REGRAS DE REPROVACAO ========== -->

      <rule id="Rule_Reprovado_NodePositivo">
        <description>Reprovado: Linfonodos clinicamente positivos</description>
        <inputEntry id="IE_Rep1_1"><text>"cN1","cN2","cN3"</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>"NaoRealizada"</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Linfonodos clinicamente positivos - esvaziamento axilar indicado, nao BLS isolada"</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"NCCN 2024 - cN+ e indicacao de esvaziamento axilar"</text></outputEntry>
      <outputEntry id="OE_Reprovado_NodePositivo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_NodePositivo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_Inflamatorio">
        <description>Reprovado: Carcinoma inflamatorio</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>"CarcinomaInflamatorio"</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Carcinoma inflamatorio - BLS contraindicada, esvaziamento axilar apos quimioterapia"</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"ASCO/SSO Guidelines 2017 - Contraindicacao absoluta para BLS"</text></outputEntry>
      <outputEntry id="OE_Reprovado_Inflamatorio_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_Inflamatorio_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_BLSPrevia">
        <description>Reprovado: BLS previa ipsilateral</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"BLS previa ipsilateral - mapeamento linfatico comprometido, considerar esvaziamento"</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"ASCO/SSO Guidelines 2017 - BLS repetida tem menor acuracia"</text></outputEntry>
      <outputEntry id="OE_Reprovado_BLSPrevia_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_BLSPrevia_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRAS DE APROVACAO ========== -->

      <rule id="Rule_Aprovado_cN0Invasivo">
        <description>Aprovado: Carcinoma invasivo cN0</description>
        <inputEntry id="IE_Apr1_1"><text>"cN0"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"CarcinomaInvasivo"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"T1","T2"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Carcinoma invasivo T1-T2 clinicamente N0 - BLS indicada como padrao"</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"NCCN 2024 - BLS e padrao-ouro para estadiamento axilar em cN0"</text></outputEntry>
      <outputEntry id="OE_Aprovado_cN0Invasivo_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_cN0Invasivo_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_CDISMastectomia">
        <description>Aprovado: CDIS extenso com mastectomia</description>
        <inputEntry id="IE_Apr2_1"><text>"cN0"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"CDIS"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"CDIS com indicacao de mastectomia - BLS indicada pelo risco de componente invasivo oculto"</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"ASCO/SSO Guidelines 2017 - CDIS extenso com mastectomia deve ter BLS"</text></outputEntry>
      <outputEntry id="OE_Aprovado_CDISMastectomia_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_CDISMastectomia_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_PosNeoN0Inicial">
        <description>Aprovado: Pos-neoadjuvancia com cN0 inicial</description>
        <inputEntry id="IE_Apr3_1"><text>"cN0"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"CarcinomaInvasivo"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>"cN0_Inicial"</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Pos-neoadjuvancia com cN0 inicial - BLS acurada e indicada"</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"NCCN 2024 - BLS pos-neoadjuvancia em cN0 inicial e padrao"</text></outputEntry>
      <outputEntry id="OE_Aprovado_PosNeoN0Inicial_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_PosNeoN0Inicial_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_T3cN0">
        <description>Aprovado: T3 clinicamente N0</description>
        <inputEntry id="IE_Apr4_1"><text>"cN0"</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>"CarcinomaInvasivo"</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>"T3"</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"T3 clinicamente N0 - BLS indicada, alto risco de positividade"</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"ASCO/SSO Guidelines 2017 - BLS valida mesmo em tumores maiores se cN0"</text></outputEntry>
      <outputEntry id="OE_Aprovado_T3cN0_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_T3cN0_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRA FALLBACK ========== -->

      <rule id="Rule_Fallback_GEN_BRE_002">
        <description>Pendente: Avaliacao adicional necessaria</description>
        <inputEntry id="IE_FB_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_5"><text>-</text></inputEntry>
        <outputEntry id="OE_FB_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FB_2"><text>"Avaliacao adicional necessaria - considerar US axilar e biopsia se linfonodo suspeito"</text></outputEntry>
        <outputEntry id="OE_FB_3"><text>"NCCN 2024 - US axilar pre-operatorio recomendado"</text></outputEntry>
      <outputEntry id="OE_Fallback_GEN_BRE_002_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_GEN_BRE_002_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
