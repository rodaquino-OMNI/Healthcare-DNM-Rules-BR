<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_COL_009"
             name="Reversao de Colostomia - Criterios de Timing"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-COL-009 - Reversao de Colostomia/Ileostomia - Criterios de Timing
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Coloproctologia
    Categoria: Procedimentos Cirurgicos

    Timing Recomendado (ASCRS):
    - Ileostomia de protecao (pos-TME): 8-12 semanas
    - Hartmann (diverticulite): 3-6 meses
    - Trauma: Variavel conforme gravidade

    Pre-requisitos para Reversao:
    - Anastomose integra (contraste)
    - Estado nutricional adequado
    - Ausencia de infeccao ativa
    - Conclusao de quimioterapia (se oncologico)

    Exames Pre-operatorios:
    - Enema opaco ou TC com contraste retal
    - Colonoscopia (excluir recidiva/nova lesao)
    - Exames laboratoriais

    Contraindicacoes Relativas:
    - Desnutricao grave
    - Estenose de anastomose
    - Doenca metastatica ativa
    - Incontinencia pre-existente

    Referencias Normativas:
    - ASCRS Clinical Practice Guidelines
    - ESCP Stoma Reversal Guidelines
  -->

  <decision id="Decision_GEN_COL_009" name="Criterios de Autorizacao - Reversao Colostomia">
    <decisionTable id="DecisionTable_GEN_COL_009" hitPolicy="FIRST">

      <!-- Input 1: Tipo de Ostomia -->
      <input id="Input_tipoOstomia" label="Tipo de Ostomia">
        <inputExpression id="InputExpr_tipoOstomia" typeRef="string">
          <text>tipoOstomia</text>
        </inputExpression>
        <inputValues id="InputValues_tipoOstomia">
          <text>"Ileostomia_Alca","Colostomia_Hartmann","Colostomia_Alca","Ileostomia_Terminal"</text>
        </inputValues>
      </input>

      <!-- Input 2: Tempo desde Cirurgia Primaria -->
      <input id="Input_tempoCircurgia" label="Tempo desde Cirurgia Primaria">
        <inputExpression id="InputExpr_tempoCircurgia" typeRef="string">
          <text>tempoDesdeCircurgia</text>
        </inputExpression>
        <inputValues id="InputValues_tempoCircurgia">
          <text>"Menos_8_Semanas","8_12_Semanas","3_6_Meses","Mais_6_Meses"</text>
        </inputValues>
      </input>

      <!-- Input 3: Estudo Contrastado -->
      <input id="Input_estudoContrastado" label="Estudo Contrastado (Enema/TC)">
        <inputExpression id="InputExpr_estudoContrastado" typeRef="string">
          <text>estudoContrastado</text>
        </inputExpression>
        <inputValues id="InputValues_estudoContrastado">
          <text>"Anastomose_Integra","Estenose","Fistula","Nao_Realizado"</text>
        </inputValues>
      </input>

      <!-- Input 4: Estado Nutricional -->
      <input id="Input_nutricional" label="Estado Nutricional">
        <inputExpression id="InputExpr_nutricional" typeRef="string">
          <text>estadoNutricional</text>
        </inputExpression>
        <inputValues id="InputValues_nutricional">
          <text>"Adequado","Desnutricao_Leve","Desnutricao_Grave","Nao_Avaliado"</text>
        </inputValues>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_COL_009_Reprovado_SemEstudo">
        <description>Reprovado - Sem estudo contrastado</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>"Nao_Realizado"</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Estudo contrastado (enema opaco ou TC) obrigatorio para confirmar integridade da anastomose antes de reversao."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ASCRS - Contrast Study Required"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Reprovado_SemEstudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Reprovado_SemEstudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_009_Reprovado_Fistula">
        <description>Reprovado - Fistula na anastomose</description>
        <inputEntry id="IE_Rep2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>"Fistula"</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Fistula anastomotica detectada - reversao contraindicada ate resolucao. Tratar fistula antes de nova tentativa."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"ASCRS - Anastomotic Fistula Contraindication"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Reprovado_Fistula_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Reprovado_Fistula_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_009_Reprovado_Desnutricao">
        <description>Reprovado - Desnutricao grave</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>"Desnutricao_Grave"</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Desnutricao grave aumenta significativamente risco de deiscencia. Otimizar estado nutricional (albumina >3.0) antes de reversao."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"ASCRS - Nutritional Optimization Required"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Reprovado_Desnutricao_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Reprovado_Desnutricao_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_009_Reprovado_SemLaudo">
        <description>Reprovado - Sem laudo de indicacao</description>
        <inputEntry id="IE_Rep4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep4_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep4_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep4_2"><text>"Laudo de indicacao obrigatorio com tipo de ostomia, motivo da cirurgia primaria e resultado do estudo contrastado."</text></outputEntry>
        <outputEntry id="OE_Rep4_3"><text>"RN 465/2021 - Documentacao Obrigatoria"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Reprovado_SemLaudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Reprovado_SemLaudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_COL_009_Aprovado_Ileostomia_Timing">
        <description>Aprovado - Ileostomia de protecao no timing adequado</description>
        <inputEntry id="IE_Apr1_1"><text>"Ileostomia_Alca"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"8_12_Semanas","3_6_Meses","Mais_6_Meses"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>"Anastomose_Integra"</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>"Adequado","Desnutricao_Leve"</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Reversao de ileostomia de protecao aprovada. Timing adequado (>8 semanas), anastomose integra, estado nutricional satisfatorio."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"ASCRS - Ileostomy Reversal Timing"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Aprovado_Ileostomia_Timing_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Aprovado_Ileostomia_Timing_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_009_Aprovado_Hartmann">
        <description>Aprovado - Reversao de Hartmann no timing adequado</description>
        <inputEntry id="IE_Apr2_1"><text>"Colostomia_Hartmann"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>"3_6_Meses","Mais_6_Meses"</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>"Anastomose_Integra"</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>"Adequado","Desnutricao_Leve"</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Reversao de Hartmann aprovada. Coto retal patente, estado nutricional adequado. Procedimento de maior porte - laparoscopia quando possivel."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"ASCRS - Hartmann Reversal"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Aprovado_Hartmann_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Aprovado_Hartmann_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_009_Aprovado_Colostomia_Alca">
        <description>Aprovado - Reversao de colostomia em alca</description>
        <inputEntry id="IE_Apr3_1"><text>"Colostomia_Alca"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"8_12_Semanas","3_6_Meses","Mais_6_Meses"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>"Anastomose_Integra"</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>"Adequado"</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Reversao de colostomia em alca aprovada. Procedimento relativamente simples, pode ser realizado por incisao periostomia."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"ASCRS - Loop Colostomy Reversal"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Aprovado_Colostomia_Alca_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Aprovado_Colostomia_Alca_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_COL_009_Pendente_TimingPrecoce">
        <description>Pendente - Timing muito precoce</description>
        <inputEntry id="IE_Pend1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>"Menos_8_Semanas"</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Reversao antes de 8 semanas aumenta risco de complicacoes. Justificar se houver indicacao para reversao precoce."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"ASCRS - Minimum 8 Week Wait"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Pendente_TimingPrecoce_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Pendente_TimingPrecoce_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_009_Pendente_Estenose">
        <description>Pendente - Estenose anastomotica</description>
        <inputEntry id="IE_Pend2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>"Estenose"</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"Estenose anastomotica detectada - avaliar dilatacao endoscopica antes de reversao. Se estenose nao dilatavel, considerar revisao cirurgica."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"ASCRS - Stricture Management"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Pendente_Estenose_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Pendente_Estenose_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_009_Pendente_NutricaoNaoAvaliada">
        <description>Pendente - Estado nutricional nao avaliado</description>
        <inputEntry id="IE_Pend3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend3_4"><text>"Nao_Avaliado"</text></inputEntry>
        <inputEntry id="IE_Pend3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend3_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend3_2"><text>"Avaliacao nutricional (albumina, pre-albumina, perda ponderal) obrigatoria antes de reversao de ostomia."</text></outputEntry>
        <outputEntry id="OE_Pend3_3"><text>"ASCRS - Nutritional Assessment Required"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Pendente_NutricaoNaoAvaliada_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Pendente_NutricaoNaoAvaliada_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_COL_009_Fallback">
        <description>Fallback - Analise especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso de reversao de ostomia requer analise por auditor medico coloproctologista."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria cirurgica - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_009_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_009_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
