<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC/"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI/"
             id="Definitions_GEN_COL_002"
             name="Cancer Retal - TME e Neoadjuvancia"
             namespace="http://camunda.org/schema/1.0/dmn"
             exporter="Camunda Modeler"
             exporterVersion="5.0.0">
  <!--
    GEN-COL-002 - Cancer Retal - Excisao Total do Mesorreto e Neoadjuvancia
    Versao: 1.0.0 (2026-02-07)
    Especialidade: Cirurgia Geral - Coloproctologia Oncologica
    Categoria: Procedimentos Cirurgicos Oncologicos

    Principios (NCCN Rectal Cancer 2024):
    - TME (Total Mesorectal Excision) e padrao ouro
    - Neoadjuvancia para T3/T4 ou N+ (quimiorradioterapia)
    - Avaliacao por RNM pelve obrigatoria
    - Margem radial livre (CRM) e fator prognostico

    Indicacoes de Neoadjuvancia:
    - cT3-T4 qualquer N
    - Qualquer T com N+
    - Tumor a menos de 5cm da margem anal

    Abordagens Cirurgicas:
    - RAB (Resseccao Anterior Baixa): Tumores medio/alto reto
    - RAP (Resseccao Abdominoperineal): Invasao esfincter
    - TaTME: Abordagem transanal para tumores baixos

    Documentacao Obrigatoria:
    - RNM pelve com estadiamento local
    - TC torax/abdome para metastases
    - Distancia do tumor a margem anal
    - Avaliacao funcional esfincter

    Referencias Normativas:
    - NCCN Rectal Cancer Guidelines 2024
    - ESMO Rectal Cancer Guidelines 2023
    - MERCURY Study Group Criteria
  -->

  <decision id="Decision_GEN_COL_002" name="Criterios de Autorizacao - Cancer Retal TME">
    <decisionTable id="DecisionTable_GEN_COL_002" hitPolicy="FIRST">

      <!-- Input 1: Estadiamento Local (cT) -->
      <input id="Input_estadioT" label="Estadiamento T (cT)">
        <inputExpression id="InputExpr_estadioT" typeRef="string">
          <text>estadioT</text>
        </inputExpression>
        <inputValues id="InputValues_estadioT">
          <text>"cT1","cT2","cT3","cT4","cTx"</text>
        </inputValues>
      </input>

      <!-- Input 2: Status Linfonodal -->
      <input id="Input_statusN" label="Status Linfonodal (cN)">
        <inputExpression id="InputExpr_statusN" typeRef="string">
          <text>statusN</text>
        </inputExpression>
        <inputValues id="InputValues_statusN">
          <text>"cN0","cN1","cN2","cNx"</text>
        </inputValues>
      </input>

      <!-- Input 3: RNM Pelve -->
      <input id="Input_rnmPelve" label="RNM Pelve Realizada">
        <inputExpression id="InputExpr_rnmPelve" typeRef="boolean">
          <text>rnmPelveRealizada</text>
        </inputExpression>
      </input>

      <!-- Input 4: Neoadjuvancia Realizada -->
      <input id="Input_neoadjuvancia" label="Neoadjuvancia Realizada">
        <inputExpression id="InputExpr_neoadjuvancia" typeRef="string">
          <text>neoadjuvanciaRealizada</text>
        </inputExpression>
        <inputValues id="InputValues_neoadjuvancia">
          <text>"Sim_Completa","Sim_Parcial","Nao","Nao_Indicada"</text>
        </inputValues>
      </input>

      <!-- Input 5: Laudo de Indicacao -->
      <input id="Input_laudoIndicacao" label="Laudo de Indicacao">
        <inputExpression id="InputExpr_laudoIndicacao" typeRef="boolean">
          <text>laudoIndicacao</text>
        </inputExpression>
      </input>

      <!-- Output 1: Resultado -->
      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <!-- Output 2: Observacao -->
      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <!-- Output 3: Fundamentacao -->
      <output id="Output_fundamentacao" label="Fundamentacao" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- REGRAS DE REPROVACAO -->

      <rule id="Rule_GEN_COL_002_Reprovado_SemRNM">
        <description>Reprovado - Sem RNM pelve para estadiamento local</description>
        <inputEntry id="IE_Rep1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"RNM de pelve obrigatoria para estadiamento local de cancer retal. Avalia invasao mesorreto, CRM e relacao com esfincters."</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"NCCN 2024 / MERCURY Study - MRI Staging Required"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Reprovado_SemRNM_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Reprovado_SemRNM_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_002_Reprovado_SemNeoadjuvanciaIndicada">
        <description>Reprovado - Neoadjuvancia indicada mas nao realizada</description>
        <inputEntry id="IE_Rep2_1"><text>"cT3","cT4"</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>"Nao"</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Cancer retal cT3/T4 requer quimiorradioterapia neoadjuvante antes de cirurgia. Melhora ressecabilidade e reduz recidiva local."</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"NCCN 2024 - Neoadjuvant CRT for cT3/T4"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Reprovado_SemNeoadjuvanciaIndicada_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Reprovado_SemNeoadjuvanciaIndicada_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_002_Reprovado_SemLaudo">
        <description>Reprovado - Sem laudo de indicacao</description>
        <inputEntry id="IE_Rep3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep3_5"><text>false</text></inputEntry>
        <outputEntry id="OE_Rep3_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep3_2"><text>"Laudo de indicacao obrigatorio com estadiamento local, distancia da margem anal e planejamento cirurgico (RAB vs RAP)."</text></outputEntry>
        <outputEntry id="OE_Rep3_3"><text>"RN 465/2021 - Documentacao Obrigatoria"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Reprovado_SemLaudo_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Reprovado_SemLaudo_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE APROVACAO -->

      <rule id="Rule_GEN_COL_002_Aprovado_T1T2_N0">
        <description>Aprovado - Cancer retal inicial sem neoadjuvancia</description>
        <inputEntry id="IE_Apr1_1"><text>"cT1","cT2"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>"cN0"</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>"Nao_Indicada"</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Cancer retal cT1-2 N0 - TME primaria aprovada sem neoadjuvancia. Considerar excisao local transanal para T1sm1 selecionados."</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"NCCN 2024 - Early Rectal Cancer Surgery"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Aprovado_T1T2_N0_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Aprovado_T1T2_N0_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_002_Aprovado_PosNeoadjuvancia">
        <description>Aprovado - TME pos neoadjuvancia completa</description>
        <inputEntry id="IE_Apr2_1"><text>"cT3","cT4"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>"Sim_Completa"</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"TME pos quimiorradioterapia neoadjuvante aprovada. Cirurgia 8-12 semanas apos termino da radioterapia. Reestadiamento com RNM recomendado."</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"NCCN 2024 - Post-Neoadjuvant TME"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Aprovado_PosNeoadjuvancia_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Aprovado_PosNeoadjuvancia_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_002_Aprovado_N_Positivo_PosNeo">
        <description>Aprovado - N positivo apos neoadjuvancia</description>
        <inputEntry id="IE_Apr3_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>"cN1","cN2"</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>"Sim_Completa"</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>true</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"TME aprovada para cancer retal N+ apos neoadjuvancia completa. Linfadenectomia mesoretal completa obrigatoria."</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"NCCN 2024 - Node Positive Rectal Cancer"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Aprovado_N_Positivo_PosNeo_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Aprovado_N_Positivo_PosNeo_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- REGRAS DE PENDENCIA -->

      <rule id="Rule_GEN_COL_002_Pendente_NeoadjuvanciaParcial">
        <description>Pendente - Neoadjuvancia incompleta</description>
        <inputEntry id="IE_Pend1_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend1_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Pend1_4"><text>"Sim_Parcial"</text></inputEntry>
        <inputEntry id="IE_Pend1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend1_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend1_2"><text>"Neoadjuvancia incompleta - avaliar motivo da interrupcao. Completar tratamento se possivel ou justificar indicacao cirurgica precoce."</text></outputEntry>
        <outputEntry id="OE_Pend1_3"><text>"NCCN 2024 - Complete Neoadjuvant Treatment"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Pendente_NeoadjuvanciaParcial_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Pendente_NeoadjuvanciaParcial_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <rule id="Rule_GEN_COL_002_Pendente_N_Positivo_SemNeo">
        <description>Pendente - N positivo sem neoadjuvancia</description>
        <inputEntry id="IE_Pend2_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Pend2_2"><text>"cN1","cN2"</text></inputEntry>
        <inputEntry id="IE_Pend2_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Pend2_4"><text>"Nao"</text></inputEntry>
        <inputEntry id="IE_Pend2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Pend2_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Pend2_2"><text>"Cancer retal N+ requer quimiorradioterapia neoadjuvante. Justificar se houver contraindicacao ao tratamento."</text></outputEntry>
        <outputEntry id="OE_Pend2_3"><text>"NCCN 2024 - Neoadjuvant for N+"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Pendente_N_Positivo_SemNeo_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Pendente_N_Positivo_SemNeo_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

      <!-- REGRA FALLBACK -->

      <rule id="Rule_GEN_COL_002_Fallback">
        <description>Fallback - Analise especializada</description>
        <inputEntry id="IE_Fallback_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Fallback_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Fallback_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_Fallback_2"><text>"Caso de cancer retal requer analise por auditor medico oncologico colorretal."</text></outputEntry>
        <outputEntry id="OE_Fallback_3"><text>"Auditoria oncologica - RN 428/2017"</text></outputEntry>
      <outputEntry id="OE_GEN_COL_002_Fallback_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_GEN_COL_002_Fallback_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
