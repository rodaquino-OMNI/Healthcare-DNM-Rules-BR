<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:camunda="http://camunda.org/schema/1.0/dmn"
             id="Definitions_GEN_END_001"
             name="Tireoidectomia - Criterios Nodulo (Bethesda)"
             namespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ===============================================================================
    CODIGO: GEN-END-001
    Procedimento: Tireoidectomia por Nodulo Tireoidiano - Sistema Bethesda
    Especialidade: Cirurgia Geral - Cirurgia Endocrina
    Versao: 3.0.0-TIER1
    Data: 2026-02-07
    ===============================================================================

    INDICACOES CIRURGICAS:
    - Bethesda V (Suspeito para Malignidade) - Risco 50-75%
    - Bethesda VI (Maligno) - Risco 97-99%
    - Bethesda IV (Neoplasia Folicular) - Risco 15-30%
    - Bethesda III (FLUS/AUS) recorrente
    - Sintomas compressivos independente de citologia
    - Nodulo > 4 cm

    CONTRAINDICACOES RELATIVAS:
    - Bethesda I repetido (insuficiente - repetir PAAF)
    - Bethesda II (benigno) assintomatico < 4 cm

    REFERENCIAS TECNICAS:
    - Bethesda System 2017
    - ATA Thyroid Guidelines 2015
    - SBEM Guidelines 2023

    ===============================================================================
  -->

  <decision id="Decision_GEN_END_001" name="Regra Clinica - Tireoidectomia Bethesda">
    <decisionTable id="DecisionTable_GEN_END_001" hitPolicy="FIRST">

      <!-- ========== INPUTS (5) ========== -->

      <input id="Input_categoriaBethesda" label="Categoria Bethesda" camunda:inputVariable="categoriaBethesda">
        <inputExpression id="InputExpression_categoriaBethesda" typeRef="string">
          <text>categoriaBethesda</text>
        </inputExpression>
        <inputValues id="InputValues_categoriaBethesda">
          <text>"I_Insuficiente","II_Benigno","III_FLUS","IV_Folicular","V_Suspeito","VI_Maligno"</text>
        </inputValues>
      </input>

      <input id="Input_tamanhoNodulo" label="Tamanho do Nodulo (cm)" camunda:inputVariable="tamanhoNodulo">
        <inputExpression id="InputExpression_tamanhoNodulo" typeRef="number">
          <text>tamanhoNodulo</text>
        </inputExpression>
      </input>

      <input id="Input_sintomasCompressivos" label="Sintomas Compressivos" camunda:inputVariable="sintomasCompressivos">
        <inputExpression id="InputExpression_sintomasCompressivos" typeRef="boolean">
          <text>sintomasCompressivos</text>
        </inputExpression>
      </input>

      <input id="Input_caracteristicasUS" label="Caracteristicas Ultrassonograficas" camunda:inputVariable="caracteristicasUS">
        <inputExpression id="InputExpression_caracteristicasUS" typeRef="string">
          <text>caracteristicasUS</text>
        </inputExpression>
        <inputValues id="InputValues_caracteristicasUS">
          <text>"TIRADS5","TIRADS4","TIRADS3","TIRADS2","TIRADS1"</text>
        </inputValues>
      </input>

      <input id="Input_testeMolecular" label="Teste Molecular (se disponivel)" camunda:inputVariable="testeMolecular">
        <inputExpression id="InputExpression_testeMolecular" typeRef="string">
          <text>testeMolecular</text>
        </inputExpression>
        <inputValues id="InputValues_testeMolecular">
          <text>"Suspeito","Benigno","NaoRealizado"</text>
        </inputValues>
      </input>

      <!-- ========== OUTPUTS (3) ========== -->

      <output id="Output_resultado" label="Resultado" name="resultado" typeRef="string">
        <outputValues id="OutputValues_resultado">
          <text>"Aprovado","Reprovado","Pendente"</text>
        </outputValues>
      </output>

      <output id="Output_observacao" label="Observacao Clinica" name="observacao" typeRef="string" />

      <output id="Output_fundamentacao" label="Fundamentacao Tecnica" name="fundamentacao" typeRef="string" />

      <!-- Output 4: Alertas Desperdicio -->
      <output id="Output_alertasDesperdicio" label="Alertas de Desperdicio" name="alertasDesperdicio" typeRef="string">
        <outputValues id="OutputValues_alertasDesperdicio">
          <text>"NENHUM","DUP","FREQ","ESC","DOC","PROT","MULTI"</text>
        </outputValues>
      </output>

      <!-- Output 5: Acao Recomendada -->
      <output id="Output_acaoRecomendada" label="Acao Recomendada" name="acaoRecomendada" typeRef="string">
        <outputValues id="OutputValues_acaoRecomendada">
          <text>"APROVAR","NEGAR","SOLICITAR_INFO","AGUARDAR_PRAZO","SUGERIR_ALTERNATIVA"</text>
        </outputValues>
      </output>

      <!-- ========== REGRAS DE REPROVACAO ========== -->

      <rule id="Rule_Reprovado_Benigno">
        <description>Reprovado: Bethesda II benigno pequeno</description>
        <inputEntry id="IE_Rep1_1"><text>"II_Benigno"</text></inputEntry>
        <inputEntry id="IE_Rep1_2"><text>&lt; 4</text></inputEntry>
        <inputEntry id="IE_Rep1_3"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep1_4"><text>"TIRADS1","TIRADS2","TIRADS3"</text></inputEntry>
        <inputEntry id="IE_Rep1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep1_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep1_2"><text>"Nodulo benigno (Bethesda II) pequeno e assintomatico - seguimento ultrassonografico"</text></outputEntry>
        <outputEntry id="OE_Rep1_3"><text>"ATA 2015 - Bethesda II tem risco de malignidade 0-3%, cirurgia nao indicada"</text></outputEntry>
      <outputEntry id="OE_Reprovado_Benigno_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_Benigno_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Reprovado_Insuficiente">
        <description>Reprovado: Amostra insuficiente - repetir PAAF</description>
        <inputEntry id="IE_Rep2_1"><text>"I_Insuficiente"</text></inputEntry>
        <inputEntry id="IE_Rep2_2"><text>&lt; 4</text></inputEntry>
        <inputEntry id="IE_Rep2_3"><text>false</text></inputEntry>
        <inputEntry id="IE_Rep2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Rep2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Rep2_1"><text>"Reprovado"</text></outputEntry>
        <outputEntry id="OE_Rep2_2"><text>"Amostra citologica insuficiente - repetir PAAF guiada por US antes de indicar cirurgia"</text></outputEntry>
        <outputEntry id="OE_Rep2_3"><text>"Bethesda 2017 - Repetir PAAF em 3-6 meses para Bethesda I"</text></outputEntry>
      <outputEntry id="OE_Reprovado_Insuficiente_4"><text>"PROT"</text></outputEntry>
        <outputEntry id="OE_Reprovado_Insuficiente_5"><text>"NEGAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRAS DE APROVACAO ========== -->

      <rule id="Rule_Aprovado_BethesdaVI">
        <description>Aprovado: Bethesda VI - Maligno</description>
        <inputEntry id="IE_Apr1_1"><text>"VI_Maligno"</text></inputEntry>
        <inputEntry id="IE_Apr1_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr1_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr1_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr1_2"><text>"Bethesda VI (Maligno) - tireoidectomia total indicada"</text></outputEntry>
        <outputEntry id="OE_Apr1_3"><text>"ATA 2015 - Bethesda VI tem 97-99% de risco de malignidade"</text></outputEntry>
      <outputEntry id="OE_Aprovado_BethesdaVI_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_BethesdaVI_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_BethesdaV">
        <description>Aprovado: Bethesda V - Suspeito</description>
        <inputEntry id="IE_Apr2_1"><text>"V_Suspeito"</text></inputEntry>
        <inputEntry id="IE_Apr2_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr2_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr2_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr2_2"><text>"Bethesda V (Suspeito) - tireoidectomia ou lobectomia diagnostica indicada"</text></outputEntry>
        <outputEntry id="OE_Apr2_3"><text>"ATA 2015 - Bethesda V tem 50-75% de risco de malignidade"</text></outputEntry>
      <outputEntry id="OE_Aprovado_BethesdaV_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_BethesdaV_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_BethesdaIV">
        <description>Aprovado: Bethesda IV - Neoplasia Folicular</description>
        <inputEntry id="IE_Apr3_1"><text>"IV_Folicular"</text></inputEntry>
        <inputEntry id="IE_Apr3_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr3_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr3_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr3_2"><text>"Bethesda IV - lobectomia diagnostica indicada para diferenciacao histologica"</text></outputEntry>
        <outputEntry id="OE_Apr3_3"><text>"ATA 2015 - Bethesda IV requer analise histopatologica (15-30% malignidade)"</text></outputEntry>
      <outputEntry id="OE_Aprovado_BethesdaIV_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_BethesdaIV_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_SintomasCompressivos">
        <description>Aprovado: Sintomas compressivos</description>
        <inputEntry id="IE_Apr4_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_2"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_3"><text>true</text></inputEntry>
        <inputEntry id="IE_Apr4_4"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr4_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr4_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr4_2"><text>"Sintomas compressivos por bocio - tireoidectomia indicada independente de citologia"</text></outputEntry>
        <outputEntry id="OE_Apr4_3"><text>"ATA 2015 - Sintomas obstrutivos sao indicacao cirurgica"</text></outputEntry>
      <outputEntry id="OE_Aprovado_SintomasCompressivos_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_SintomasCompressivos_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <rule id="Rule_Aprovado_NoduloGrande">
        <description>Aprovado: Nodulo > 4 cm</description>
        <inputEntry id="IE_Apr5_1"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr5_2"><text>&gt; 4</text></inputEntry>
        <inputEntry id="IE_Apr5_3"><text>-</text></inputEntry>
        <inputEntry id="IE_Apr5_4"><text>"TIRADS4","TIRADS5"</text></inputEntry>
        <inputEntry id="IE_Apr5_5"><text>-</text></inputEntry>
        <outputEntry id="OE_Apr5_1"><text>"Aprovado"</text></outputEntry>
        <outputEntry id="OE_Apr5_2"><text>"Nodulo &gt; 4cm com caracteristicas suspeitas - considerar cirurgia devido a amostragem limitada da PAAF"</text></outputEntry>
        <outputEntry id="OE_Apr5_3"><text>"SBEM 2023 - Nodulos grandes podem ter amostragem inadequada por PAAF"</text></outputEntry>
      <outputEntry id="OE_Aprovado_NoduloGrande_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Aprovado_NoduloGrande_5"><text>"APROVAR"</text></outputEntry>
      </rule>

      <!-- ========== REGRA FALLBACK ========== -->

      <rule id="Rule_Fallback_GEN_END_001">
        <description>Pendente: Discussao em junta de tireoide</description>
        <inputEntry id="IE_FB_1"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_2"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_3"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_4"><text>-</text></inputEntry>
        <inputEntry id="IE_FB_5"><text>-</text></inputEntry>
        <outputEntry id="OE_FB_1"><text>"Pendente"</text></outputEntry>
        <outputEntry id="OE_FB_2"><text>"Considerar teste molecular ou repetir PAAF - discussao multidisciplinar recomendada"</text></outputEntry>
        <outputEntry id="OE_FB_3"><text>"ATA 2015 - Teste molecular pode auxiliar em casos intermediarios"</text></outputEntry>
      <outputEntry id="OE_Fallback_GEN_END_001_4"><text>"NENHUM"</text></outputEntry>
        <outputEntry id="OE_Fallback_GEN_END_001_5"><text>"SOLICITAR_INFO"</text></outputEntry>
      </rule>

    </decisionTable>
  </decision>
</definitions>
