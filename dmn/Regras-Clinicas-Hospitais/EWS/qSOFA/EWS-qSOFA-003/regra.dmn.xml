<?xml version="1.0" encoding="UTF-8"?>
<!--
  ============================================================================
  EWS-qSOFA-003: qSOFA Components Individual Assessment
  ============================================================================

  Individual qSOFA component evaluation for early detection.
  Tracks each criterion separately for trend analysis.

  Evidence Base: Sepsis-3 (Singer et al., JAMA 2016)
  Components:
  - Respiratory Rate >= 22/min
  - Altered mentation (GCS < 15)
  - Systolic BP <= 100 mmHg

  ============================================================================
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/"
             id="Definitions_EWS_qSOFA_003"
             name="qSOFA Component Assessment"
             targetNamespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ═══════════════════════════════════════════════════════════════════════════
    EWS-qSOFA-003: qSOFA Individual Component Assessment
    Version: 1.0.0 (2026-02-06)
    Clinical Domain: Emergency Medicine / Critical Care
    ═══════════════════════════════════════════════════════════════════════════

    COMPONENT ANALYSIS:
    - Tachypnea (RR >=22): Most sensitive component
    - Hypotension (SBP <=100): Most specific component
    - Altered mentation (GCS <15): Strongest mortality predictor

    EARLY DETECTION:
    - Single component abnormality warrants increased vigilance
    - New abnormality in previously normal patient is significant
    ═══════════════════════════════════════════════════════════════════════════
  -->

  <decision id="Decision_EWS_qSOFA_003" name="qSOFA Component Assessment Evaluation">
    <decisionTable id="DecisionTable_EWS_qSOFA_003" hitPolicy="FIRST">

      <!-- INPUT 1: Respiratory Rate -->
      <input id="Input_1" label="Frequencia Respiratoria">
        <inputExpression id="InputExpression_1" typeRef="number">
          <text>frequenciaRespiratoria</text>
        </inputExpression>
      </input>

      <!-- INPUT 2: GCS Score -->
      <input id="Input_2" label="Glasgow">
        <inputExpression id="InputExpression_2" typeRef="number">
          <text>glasgowScore</text>
        </inputExpression>
      </input>

      <!-- INPUT 3: Systolic BP -->
      <input id="Input_3" label="PA Sistolica">
        <inputExpression id="InputExpression_3" typeRef="number">
          <text>paSistolica</text>
        </inputExpression>
      </input>

      <!-- INPUT 4: Suspected Infection -->
      <input id="Input_4" label="Suspeita Infeccao">
        <inputExpression id="InputExpression_4" typeRef="boolean">
          <text>suspeitaInfeccao</text>
        </inputExpression>
      </input>

      <!-- OUTPUT 1: Alert Level -->
      <output id="Output_1" label="Nivel Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="OutputValues_1">
          <text>"Alerta", "Atencao", "Informativo", "OK", "Revisar"</text>
        </outputValues>
      </output>

      <!-- OUTPUT 2: Urgency -->
      <output id="Output_2" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="OutputValues_2">
          <text>"IMEDIATA", "URGENTE", "ROTINA", "INFORMATIVA"</text>
        </outputValues>
      </output>

      <!-- OUTPUT 3: Required Action -->
      <output id="Output_3" label="Acao Requerida" name="acaoRequerida" typeRef="string"/>

      <!-- OUTPUT 4: Clinical Justification -->
      <output id="Output_4" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string"/>

      <!-- RULE 1: CRITICAL - All 3 components abnormal -->
      <rule id="Rule_Critical_All3Components">
        <description>All qSOFA components present - maximum risk</description>
        <inputEntry id="InputEntry_1_1">
          <text>&gt;= 22</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_2">
          <text>&lt; 15</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_3">
          <text>&lt;= 100</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_1_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_3">
          <text>"qSOFA MAXIMO (3/3). Todos os componentes anormais: taquipneia + hipotensao + alteracao consciencia. Alto risco de sepse grave/choque. Protocolo sepse IMEDIATO. UTI necessaria. Antibiotico hora-1. Ressuscitacao agressiva."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_4">
          <text>"qSOFA 3/3 representa falencia multi-sistemica: respiratoria, circulatoria e neurologica. Mortalidade >40%. A combinacao dos tres componentes tem o maior valor preditivo para desfecho adverso."</text>
        </outputEntry>
      </rule>

      <!-- RULE 2: HIGH RISK - GCS < 15 (altered mentation) with infection -->
      <rule id="Rule_HighRisk_AlteredMentation_Infection">
        <description>Altered mental status with suspected infection - encephalopathy</description>
        <inputEntry id="InputEntry_2_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_2">
          <text>&lt; 15</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_4">
          <text>true</text>
        </inputEntry>
        <outputEntry id="OutputEntry_2_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_3">
          <text>"ENCEFALOPATIA SEPTICA provavel. Alteracao de consciencia (GCS&lt;15) em paciente com infeccao. Descartar outras causas: hipoglicemia, AVC, medicamentos. Colher hemoculturas. Iniciar antibiotico. Considerar neuroimagem se indicado."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_4">
          <text>"Alteracao de consciencia e o componente qSOFA com maior associacao com mortalidade (OR 3.8). Encefalopatia septica afeta 70% dos pacientes com sepse grave. GCS &lt;15 isolado ja indica qSOFA 1/3."</text>
        </outputEntry>
      </rule>

      <!-- RULE 3: HIGH RISK - Hypotension with infection -->
      <rule id="Rule_HighRisk_Hypotension_Infection">
        <description>Hypotension with suspected infection - early shock</description>
        <inputEntry id="InputEntry_3_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_3">
          <text>&lt;= 100</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_4">
          <text>true</text>
        </inputEntry>
        <outputEntry id="OutputEntry_3_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_3">
          <text>"HIPOTENSAO em contexto de infeccao - choque septico inicial. Acesso venoso calibroso. Bolus cristaloide 500ml-1L imediato. Colher lactato. Hemoculturas antes de antibiotico. Antibiotico em 1 hora. Monitorar resposta a volume."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_4">
          <text>"PAS &lt;=100 mmHg e o componente mais especifico do qSOFA (especificidade 96%). Em contexto de infeccao indica vasodilatacao e/ou hipovolemia por sepse. Ressuscitacao precoce com fluidos melhora prognostico."</text>
        </outputEntry>
      </rule>

      <!-- RULE 4: ATTENTION - Tachypnea with infection -->
      <rule id="Rule_Attention_Tachypnea_Infection">
        <description>Tachypnea with suspected infection - early sepsis sign</description>
        <inputEntry id="InputEntry_4_1">
          <text>&gt;= 22</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_4">
          <text>true</text>
        </inputEntry>
        <outputEntry id="OutputEntry_4_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_3">
          <text>"Taquipneia (FR>=22) em paciente com infeccao - sinal precoce de sepse. Componente mais sensivel do qSOFA. Monitorar outros parametros (consciencia, PA). Colher lactato. Considerar inicio precoce de antibiotico se outros sinais presentes."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_4">
          <text>"FR >=22 e o componente mais sensivel do qSOFA (sensibilidade 70%). Taquipneia pode ser compensacao respiratoria para acidose metabolica (lactato) ou resposta inflamatoria pulmonar. Frequentemente primeiro sinal de sepse."</text>
        </outputEntry>
      </rule>

      <!-- RULE 5: FALLBACK - No qSOFA components or data incomplete -->
      <rule id="Rule_Fallback_EWS_qSOFA_003">
        <description>Nenhum componente qSOFA presente ou dados incompletos</description>
        <inputEntry id="InputEntry_F_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_F_1">
          <text>"Revisar"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_2">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_3">
          <text>"Componentes qSOFA normais (FR&lt;22, GCS=15, PAS>100) ou dados incompletos. Se suspeita de infeccao, nao excluir sepse apenas por qSOFA negativo. Manter vigilancia clinica."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_4">
          <text>"qSOFA tem sensibilidade limitada (30%). Parametros normais reduzem probabilidade de sepse grave mas nao a excluem. Avaliacao clinica e contexto sao fundamentais. Considerar outros marcadores (PCR, procalcitonina)."</text>
        </outputEntry>
      </rule>

    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram id="DMNDiagram_EWS_qSOFA_003">
      <dmndi:DMNShape id="DMNShape_Decision_EWS_qSOFA_003" dmnElementRef="Decision_EWS_qSOFA_003">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>

</definitions>
