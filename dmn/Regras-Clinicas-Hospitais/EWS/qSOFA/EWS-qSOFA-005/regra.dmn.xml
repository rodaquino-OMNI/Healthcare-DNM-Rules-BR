<?xml version="1.0" encoding="UTF-8"?>
<!--
  ============================================================================
  EWS-qSOFA-005: qSOFA with SIRS Criteria Integration
  ============================================================================

  Integration of qSOFA with SIRS criteria for comprehensive sepsis screening.
  SIRS remains useful as a sensitivity supplement to qSOFA specificity.

  Evidence Base: ACCP/SCCM 1992 (SIRS), Sepsis-3 2016 (qSOFA)
  SIRS Criteria (2 or more):
  - Temperature >38°C or <36°C
  - Heart Rate >90 bpm
  - Respiratory Rate >20/min
  - WBC >12,000 or <4,000 or >10% bands

  ============================================================================
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/"
             id="Definitions_EWS_qSOFA_005"
             name="qSOFA SIRS Integration"
             targetNamespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ═══════════════════════════════════════════════════════════════════════════
    EWS-qSOFA-005: qSOFA with SIRS Integration
    Version: 1.0.0 (2026-02-06)
    Clinical Domain: Emergency Medicine / Infectious Disease
    ═══════════════════════════════════════════════════════════════════════════

    COMPLEMENTARY USE:
    - SIRS: High sensitivity (97%), low specificity (35%)
    - qSOFA: Low sensitivity (30%), high specificity (98%)
    - Combined: Better overall detection

    CLINICAL APPLICATION:
    - SIRS positive triggers sepsis workup
    - qSOFA positive escalates urgency
    - Both positive = highest risk
    ═══════════════════════════════════════════════════════════════════════════
  -->

  <decision id="Decision_EWS_qSOFA_005" name="qSOFA SIRS Integration Evaluation">
    <decisionTable id="DecisionTable_EWS_qSOFA_005" hitPolicy="FIRST">

      <!-- INPUT 1: qSOFA Score -->
      <input id="Input_1" label="qSOFA Score">
        <inputExpression id="InputExpression_1" typeRef="number">
          <text>qsofaScore</text>
        </inputExpression>
      </input>

      <!-- INPUT 2: SIRS Criteria Met -->
      <input id="Input_2" label="Criterios SIRS">
        <inputExpression id="InputExpression_2" typeRef="number">
          <text>criteriosSIRS</text>
        </inputExpression>
      </input>

      <!-- INPUT 3: Suspected Infection -->
      <input id="Input_3" label="Suspeita Infeccao">
        <inputExpression id="InputExpression_3" typeRef="boolean">
          <text>suspeitaInfeccao</text>
        </inputExpression>
      </input>

      <!-- INPUT 4: White Blood Cell Count -->
      <input id="Input_4" label="Leucocitos">
        <inputExpression id="InputExpression_4" typeRef="number">
          <text>leucocitos</text>
        </inputExpression>
      </input>

      <!-- OUTPUT 1: Alert Level -->
      <output id="Output_1" label="Nivel Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="OutputValues_1">
          <text>"Alerta", "Atencao", "Informativo", "OK", "Revisar"</text>
        </outputValues>
      </output>

      <!-- OUTPUT 2: Urgency -->
      <output id="Output_2" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="OutputValues_2">
          <text>"IMEDIATA", "URGENTE", "ROTINA", "INFORMATIVA"</text>
        </outputValues>
      </output>

      <!-- OUTPUT 3: Required Action -->
      <output id="Output_3" label="Acao Requerida" name="acaoRequerida" typeRef="string"/>

      <!-- OUTPUT 4: Clinical Justification -->
      <output id="Output_4" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string"/>

      <!-- RULE 1: CRITICAL - qSOFA >=2 AND SIRS >=2 with infection -->
      <rule id="Rule_Critical_Both_Positive">
        <description>Both qSOFA and SIRS positive with infection - high certainty sepsis</description>
        <inputEntry id="InputEntry_1_1">
          <text>&gt;= 2</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_2">
          <text>&gt;= 2</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_1_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_3">
          <text>"SEPSE DE ALTA CERTEZA. qSOFA E SIRS positivos com infeccao. Maxima prioridade. Bundle sepse hora-1 OBRIGATORIO. Hemoculturas + antibiotico + ressuscitacao volemica. Lactato. Avaliacao UTI imediata."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_4">
          <text>"Combinacao de qSOFA >=2 (alta especificidade) com SIRS >=2 (alta sensibilidade) em contexto de infeccao tem valor preditivo positivo >85% para sepse. Mortalidade sem tratamento: 30-40%."</text>
        </outputEntry>
      </rule>

      <!-- RULE 2: HIGH RISK - qSOFA >=2, SIRS <2 (organ dysfunction without systemic inflammation) -->
      <rule id="Rule_HighRisk_qSOFA_NoSIRS">
        <description>qSOFA positive without SIRS - immunosuppressed or cryptic sepsis</description>
        <inputEntry id="InputEntry_2_1">
          <text>&gt;= 2</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_2">
          <text>&lt; 2</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_2_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_3">
          <text>"qSOFA positivo sem SIRS - considerar sepse criptica ou paciente imunossuprimido. Investigar infeccao mesmo sem febre. Pacientes idosos, diabeticos, em corticoides podem nao montar resposta SIRS. Tratar como sepse se suspeita clinica."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_4">
          <text>"qSOFA pode ser positivo sem SIRS em pacientes com resposta inflamatoria deprimida. 20% dos pacientes com sepse nao preenchem SIRS. qSOFA detecta disfuncao organica independente de inflamacao sistemica."</text>
        </outputEntry>
      </rule>

      <!-- RULE 3: ATTENTION - SIRS positive, qSOFA negative with infection -->
      <rule id="Rule_Attention_SIRS_NoqSOFA">
        <description>SIRS without qSOFA criteria - early sepsis or non-infectious SIRS</description>
        <inputEntry id="InputEntry_3_1">
          <text>&lt; 2</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_2">
          <text>&gt;= 2</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_3_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_3">
          <text>"SIRS positivo com infeccao suspeita mas qSOFA negativo. Pode ser sepse inicial antes de disfuncao organica. Monitorar de perto. Colher lactato. Considerar inicio precoce de antibiotico. Reavaliar qSOFA em 2-4 horas."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_4">
          <text>"SIRS tem sensibilidade 97% para detectar infeccao/inflamacao. qSOFA negativo reduz probabilidade de evolucao para sepse grave mas nao a exclui. SIRS pode preceder disfuncao organica em horas."</text>
        </outputEntry>
      </rule>

      <!-- RULE 4: ATTENTION - Leukocytosis/Leukopenia with infection -->
      <rule id="Rule_Attention_WBC_Abnormal">
        <description>Abnormal WBC with suspected infection - immune response active</description>
        <inputEntry id="InputEntry_4_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_3">
          <text>true</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_4">
          <text>&gt; 12000</text>
        </inputEntry>
        <outputEntry id="OutputEntry_4_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_2">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_3">
          <text>"Leucocitose com suspeita de infeccao - resposta imune ativa. Criterio SIRS presente. Investigar foco. Se outros criterios SIRS, considerar sepse. Monitorar evolucao clinica e laboratorial."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_4">
          <text>"Leucocitose >12.000/mm3 e criterio SIRS indicando resposta inflamatoria. Especificidade baixa (pode ser qualquer inflamacao). Leucopenia (&lt;4.000) em infeccao indica sepse grave com pior prognostico."</text>
        </outputEntry>
      </rule>

      <!-- RULE 5: FALLBACK -->
      <rule id="Rule_Fallback_EWS_qSOFA_005">
        <description>Dados incompletos ou ambos scores negativos</description>
        <inputEntry id="InputEntry_F_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_F_1">
          <text>"Revisar"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_2">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_3">
          <text>"qSOFA e SIRS negativos ou dados incompletos. Baixa probabilidade de sepse mas nao excluida. Se suspeita clinica persistir, reavaliar em 4-6 horas ou se mudanca clinica."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_4">
          <text>"qSOFA &lt;2 E SIRS &lt;2 em conjunto tem alto valor preditivo negativo para sepse grave. Porem, avaliacao clinica permanece fundamental. 5-10% dos casos de sepse podem ter ambos os scores negativos inicialmente."</text>
        </outputEntry>
      </rule>

    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram id="DMNDiagram_EWS_qSOFA_005">
      <dmndi:DMNShape id="DMNShape_Decision_EWS_qSOFA_005" dmnElementRef="Decision_EWS_qSOFA_005">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>

</definitions>
