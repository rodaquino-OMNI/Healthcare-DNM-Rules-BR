<?xml version="1.0" encoding="UTF-8"?>
<!--
  ============================================================================
  EWS-MEWS-004: MEWS Respiratory Component Alert
  ============================================================================

  Modified Early Warning Score - Respiratory Parameter Focus.
  This rule triggers alerts for respiratory distress indicators.

  Evidence Base: Subbe et al. (2001)
  Respiratory Scoring:
  - RR <9: 2 points (hypoventilation)
  - RR 9-14: 0 points (normal)
  - RR 15-20: 1 point (mild tachypnea)
  - RR 21-29: 2 points (moderate tachypnea)
  - RR >=30: 3 points (severe tachypnea)

  ============================================================================
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/"
             id="Definitions_EWS_MEWS_004"
             name="MEWS Respiratory Alert"
             targetNamespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ═══════════════════════════════════════════════════════════════════════════
    EWS-MEWS-004: MEWS Respiratory Component Alert
    Version: 1.0.0 (2026-02-06)
    Clinical Domain: Pulmonology / Respiratory Care
    ═══════════════════════════════════════════════════════════════════════════

    TRIGGER CONDITIONS:
    - Respiratory rate scoring 2-3 points (RR <9 or >=21)
    - Respiratory distress signs

    CLINICAL ACTIONS:
    - Assess for respiratory failure
    - Oxygen therapy if indicated
    - Consider blood gas analysis
    - Monitor for need for ventilatory support

    EVIDENCE BASE:
    - Respiratory rate most predictive MEWS component
    - RR >=25 associated with 3x mortality increase
    ═══════════════════════════════════════════════════════════════════════════
  -->

  <decision id="Decision_EWS_MEWS_004" name="MEWS Respiratory Component Evaluation">
    <decisionTable id="DecisionTable_EWS_MEWS_004" hitPolicy="FIRST">

      <!-- INPUT 1: Respiratory Rate -->
      <input id="Input_1" label="Frequencia Respiratoria">
        <inputExpression id="InputExpression_1" typeRef="number">
          <text>frequenciaRespiratoria</text>
        </inputExpression>
      </input>

      <!-- INPUT 2: Oxygen Saturation -->
      <input id="Input_2" label="Saturacao O2">
        <inputExpression id="InputExpression_2" typeRef="number">
          <text>saturacaoO2</text>
        </inputExpression>
      </input>

      <!-- INPUT 3: Supplemental Oxygen -->
      <input id="Input_3" label="O2 Suplementar">
        <inputExpression id="InputExpression_3" typeRef="boolean">
          <text>o2Suplementar</text>
        </inputExpression>
      </input>

      <!-- INPUT 4: DPOC/Asthma History -->
      <input id="Input_4" label="Doenca Respiratoria Cronica">
        <inputExpression id="InputExpression_4" typeRef="boolean">
          <text>doencaRespiratoriaCronica</text>
        </inputExpression>
      </input>

      <!-- OUTPUT 1: Alert Level -->
      <output id="Output_1" label="Nivel Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="OutputValues_1">
          <text>"Alerta", "Atencao", "Informativo", "OK", "Revisar"</text>
        </outputValues>
      </output>

      <!-- OUTPUT 2: Urgency -->
      <output id="Output_2" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="OutputValues_2">
          <text>"IMEDIATA", "URGENTE", "ROTINA", "INFORMATIVA"</text>
        </outputValues>
      </output>

      <!-- OUTPUT 3: Required Action -->
      <output id="Output_3" label="Acao Requerida" name="acaoRequerida" typeRef="string"/>

      <!-- OUTPUT 4: Clinical Justification -->
      <output id="Output_4" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string"/>

      <!-- RULE 1: CRITICAL - Severe Tachypnea (RR >=30) -->
      <rule id="Rule_Critical_SevereTachypnea">
        <description>RR  &gt; =30 indicates severe respiratory distress</description>
        <inputEntry id="InputEntry_1_1">
          <text>&gt;= 30</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_1_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_3">
          <text>"EMERGENCIA RESPIRATORIA. Avaliacao medica IMEDIATA. Gasometria arterial urgente. Preparar para suporte ventilatorio. Avaliar causa: pneumonia, TEP, edema pulmonar, acidose. Monitorar continuamente."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_4">
          <text>"FR&gt; =30 indica insuficiencia respiratoria iminente ou estabelecida (score MEWS = 3). Mortalidade 3x maior. Fadiga muscular respiratoria pode progredir para parada respiratoria sem intervencao."</text>
        </outputEntry>
      </rule>

      <!-- RULE 2: CRITICAL - Bradypnea (RR <9) -->
      <rule id="Rule_Critical_Bradypnea">
        <description>RR  &lt; 9 indicates hypoventilation - risk of CO2 retention</description>
        <inputEntry id="InputEntry_2_1">
          <text>&lt; 9</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_2_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_3">
          <text>"ALERTA: Bradipneia. Avaliar nivel de consciencia. Verificar medicacoes (opioides, sedativos). Gasometria para avaliar retencao de CO2. Preparar naloxone se suspeita de overdose opioide. Considerar VNI ou IOT."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_4">
          <text>"FR&lt; 9 indica hipoventilacao grave (score MEWS = 2). Causas: depressao SNC, fadiga muscular terminal, overdose de opioides. Risco de hipercapnia e parada respiratoria."</text>
        </outputEntry>
      </rule>

      <!-- RULE 3: HIGH RISK - Moderate Tachypnea + Hypoxia -->
      <rule id="Rule_HighRisk_TachypneaHypoxia">
        <description>RR 21-29 with low oxygen saturation</description>
        <inputEntry id="InputEntry_3_1">
          <text>[21..29]</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_2">
          <text>&lt; 92</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_3_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_3">
          <text>"Taquipneia com hipoxemia. Iniciar O2 suplementar imediatamente. Solicitar avaliacao medica urgente. Raio-X de torax. Considerar gasometria. Monitorar resposta a oxigenoterapia."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_4">
          <text>"Combinacao de FR elevada (21-29) e SpO2&lt; 92% indica comprometimento respiratorio significativo. Necessita intervencao imediata para prevenir deterioracao para insuficiencia respiratoria franca."</text>
        </outputEntry>
      </rule>

      <!-- RULE 4: ATTENTION - DPOC with Moderate Tachypnea -->
      <rule id="Rule_Attention_DPOC_Tachypnea">
        <description>DPOC patient with tachypnea - risk of exacerbation</description>
        <inputEntry id="InputEntry_4_1">
          <text>[21..29]</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_4">
          <text>true</text>
        </inputEntry>
        <outputEntry id="OutputEntry_4_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_3">
          <text>"Paciente com doenca respiratoria cronica e taquipneia. Avaliar sinais de exacerbacao. Considerar nebulizacao com broncodilatador. Gasometria se piorando. Cuidado com O2 em excesso em DPOC retentores."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_4">
          <text>"Pacientes com DPOC/asma tem menor reserva respiratoria. Taquipneia pode indicar exacerbacao precoce. Intervencao rapida pode prevenir necessidade de UTI. Meta SpO2 88-92% em retentores cronicos de CO2."</text>
        </outputEntry>
      </rule>

      <!-- RULE 5: FALLBACK -->
      <rule id="Rule_Fallback_EWS_MEWS_004">
        <description>Frequencia respiratoria normal ou dados incompletos</description>
        <inputEntry id="InputEntry_F_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_F_1">
          <text>"Revisar"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_2">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_3">
          <text>"Verificar frequencia respiratoria. Se FR 9-20 com SpO2 normal, componente respiratorio do MEWS esta adequado. Monitorar de rotina."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_4">
          <text>"Frequencia respiratoria e o parametro mais sensivel do MEWS para deterioracao clinica. Valores normais (9-14 irpm) indicam adequada ventilacao."</text>
        </outputEntry>
      </rule>

    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram id="DMNDiagram_EWS_MEWS_004">
      <dmndi:DMNShape id="DMNShape_Decision_EWS_MEWS_004" dmnElementRef="Decision_EWS_MEWS_004">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>

</definitions>
