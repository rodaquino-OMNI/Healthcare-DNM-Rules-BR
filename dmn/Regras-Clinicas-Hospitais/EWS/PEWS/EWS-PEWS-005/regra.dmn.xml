<?xml version="1.0" encoding="UTF-8"?>
<!--
  ============================================================================
  EWS-PEWS-005: PEWS Cardiovascular Component - Age-Adjusted Thresholds
  ============================================================================

  Pediatric Early Warning Score - Cardiovascular Assessment.
  This rule uses age-adjusted heart rate and perfusion assessment.

  Evidence Base: Pediatric vital sign references
  Age-Adjusted Heart Rate (Normal):
  - 0-3 months: 100-160 bpm
  - 3-6 months: 90-120 bpm
  - 6-12 months: 80-120 bpm
  - 1-3 years: 80-110 bpm
  - 3-6 years: 70-110 bpm
  - 6-12 years: 60-95 bpm
  - >12 years: 60-100 bpm

  ============================================================================
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/"
             id="Definitions_EWS_PEWS_005"
             name="PEWS Cardiovascular Component"
             targetNamespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ═══════════════════════════════════════════════════════════════════════════
    EWS-PEWS-005: PEWS Cardiovascular Component Assessment
    Version: 1.0.0 (2026-02-06)
    Clinical Domain: Pediatric Cardiology / Emergency Medicine
    ═══════════════════════════════════════════════════════════════════════════

    CARDIOVASCULAR ASSESSMENT:
    - Heart rate (age-adjusted)
    - Capillary refill time
    - Skin color (pink, pale, mottled, gray)
    - Blood pressure (age-adjusted)

    CLINICAL SIGNIFICANCE:
    - Children maintain BP until late in shock
    - Tachycardia and poor perfusion are earlier signs
    - Color and CRT are more sensitive than BP
    ═══════════════════════════════════════════════════════════════════════════
  -->

  <decision id="Decision_EWS_PEWS_005" name="PEWS Cardiovascular Component Evaluation">
    <decisionTable id="DecisionTable_EWS_PEWS_005" hitPolicy="FIRST">

      <!-- INPUT 1: Age in Months -->
      <input id="Input_1" label="Idade Meses">
        <inputExpression id="InputExpression_1" typeRef="number">
          <text>idadeMeses</text>
        </inputExpression>
      </input>

      <!-- INPUT 2: Heart Rate -->
      <input id="Input_2" label="Frequencia Cardiaca">
        <inputExpression id="InputExpression_2" typeRef="number">
          <text>frequenciaCardiaca</text>
        </inputExpression>
      </input>

      <!-- INPUT 3: Capillary Refill Time (seconds) -->
      <input id="Input_3" label="Tempo Enchimento Capilar">
        <inputExpression id="InputExpression_3" typeRef="number">
          <text>tempoEnchimentoCapilar</text>
        </inputExpression>
      </input>

      <!-- INPUT 4: Skin Color Score (0-3) -->
      <input id="Input_4" label="Coloracao Pele">
        <inputExpression id="InputExpression_4" typeRef="number">
          <text>coloracaoPele</text>
        </inputExpression>
      </input>

      <!-- OUTPUT 1: Alert Level -->
      <output id="Output_1" label="Nivel Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="OutputValues_1">
          <text>"Alerta", "Atencao", "Informativo", "OK", "Revisar"</text>
        </outputValues>
      </output>

      <!-- OUTPUT 2: Urgency -->
      <output id="Output_2" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="OutputValues_2">
          <text>"IMEDIATA", "URGENTE", "ROTINA", "INFORMATIVA"</text>
        </outputValues>
      </output>

      <!-- OUTPUT 3: Required Action -->
      <output id="Output_3" label="Acao Requerida" name="acaoRequerida" typeRef="string"/>

      <!-- OUTPUT 4: Clinical Justification -->
      <output id="Output_4" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string"/>

      <!-- RULE 1: CRITICAL - Gray/mottled skin (color score 3) -->
      <rule id="Rule_Critical_GrayMottled">
        <description>Gray or mottled skin indicates severe shock</description>
        <inputEntry id="InputEntry_1_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_4">
          <text>3</text>
        </inputEntry>
        <outputEntry id="OutputEntry_1_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_3">
          <text>"CHOQUE GRAVE - pele cinzenta/moteada. Acessos venosos URGENTES (2 se possivel, ou intraosseo). Bolus cristaloide 20ml/kg em 5-10 min. Preparar segunda expansao. Identificar causa: sepse, hemorragia, cardiogenico. UTIP imediato."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_4">
          <text>"Coloracao cinzenta ou moteamento indica vasoconstrição periferica severa por choque descompensado. Em criancas, quando a cor muda para cinza, choque ja esta avancado. Ressuscitacao agressiva imediata necessaria."</text>
        </outputEntry>
      </rule>

      <!-- RULE 2: CRITICAL - Prolonged CRT (>=5 seconds) -->
      <rule id="Rule_Critical_CRT5">
        <description>CRT >=5 seconds indicates severe hypoperfusion</description>
        <inputEntry id="InputEntry_2_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_3">
          <text>&gt;= 5</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_2_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_3">
          <text>"HIPOPERFUSAO GRAVE (TEC >=5s). Iniciar ressuscitacao volemica IMEDIATA. Acesso venoso calibroso. Cristaloide 20ml/kg bolus rapido. Repetir se necessario ate 60ml/kg na 1a hora. Avaliar resposta (FC, TEC, diurese)."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_4">
          <text>"TEC >=5 segundos indica perfusao periferica severamente comprometida. Em criancas, TEC e mais sensivel que PA para detectar choque. PA so cai quando crianca perdeu 25-30% do volume circulante."</text>
        </outputEntry>
      </rule>

      <!-- RULE 3: HIGH RISK - Infant tachycardia (>180 bpm) -->
      <rule id="Rule_HighRisk_InfantTachycardia">
        <description>Infant with HR >180 - significant stress</description>
        <inputEntry id="InputEntry_3_1">
          <text>&lt; 12</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_2">
          <text>&gt; 180</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_3_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_3">
          <text>"LACTENTE com taquicardia grave (FC>180). Avaliar causa: febre, desidratacao, dor, choque, taquiarritmia. ECG se possivel para avaliar ritmo. Tratar causa base. Se SVT confirmada, manobras vagais ou adenosina."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_4">
          <text>"FC >180 bpm em lactente excede compensacao normal e pode indicar SVT ou choque. SVT infantil tipicamente 220-280 bpm. Se ritmo regular e estreito com FC fixa, provavel SVT. Se variavel com febre/agitacao, provavelmente sinusal."</text>
        </outputEntry>
      </rule>

      <!-- RULE 4: ATTENTION - Bradycardia in child -->
      <rule id="Rule_Attention_Bradycardia">
        <description>Bradycardia in children is usually pre-arrest</description>
        <inputEntry id="InputEntry_4_1">
          <text>&gt;= 12</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_2">
          <text>&lt; 60</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_4_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_3">
          <text>"BRADICARDIA em crianca - sinal PRE-PARADA. Avaliar ABC. Oxigenar com O2 100%. Se FC&lt;60 com sinais de ma perfusao, iniciar RCP. Preparar adrenalina. Equipe de emergencia. Em criancas bradicardia SEMPRE e seria."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_4">
          <text>"Em criancas (exceto atletas), bradicardia e sinal TARDIO de hipoxia/choque e indica parada iminente. Diferente de adultos, criancas raramente tem bradicardia primaria. PALS: FC&lt;60 + ma perfusao = iniciar RCP."</text>
        </outputEntry>
      </rule>

      <!-- RULE 5: ATTENTION - CRT 3-4 seconds -->
      <rule id="Rule_Attention_CRT34">
        <description>CRT 3-4 seconds indicates early hypoperfusion</description>
        <inputEntry id="InputEntry_5_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_5_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_5_3">
          <text>[3..4]</text>
        </inputEntry>
        <inputEntry id="InputEntry_5_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_5_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_5_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_5_3">
          <text>"TEC prolongado (3-4s) - hipoperfusao precoce. Avaliar hidratacao. Considerar expansao volemica 10-20ml/kg. Monitorar FC, diurese. Investigar causa (sepse, desidratacao, sangramento). Acesso venoso se ausente."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_5_4">
          <text>"TEC 3-4 segundos (normal &lt;2s em criancas) indica vasoconstrição compensatoria. Pode representar desidratacao leve-moderada ou inicio de choque. Intervencao precoce previne progressao."</text>
        </outputEntry>
      </rule>

      <!-- RULE 6: FALLBACK -->
      <rule id="Rule_Fallback_EWS_PEWS_005">
        <description>Parametros cardiovasculares normais ou dados incompletos</description>
        <inputEntry id="InputEntry_F_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_4">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_F_1">
          <text>"Revisar"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_2">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_3">
          <text>"Verificar parametros cardiovasculares. Usar tabela de referencia por idade para FC. TEC normal &lt;2 segundos. Coloracao rosada. Se normais, componente cardiovascular PEWS = 0."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_4">
          <text>"Avaliacao cardiovascular pediatrica prioriza TEC e cor sobre PA. Criancas compensam bem e PA e mantida ate choque tardio. Taquicardia pode ser multifatorial (febre, dor, medo) - interpretar no contexto."</text>
        </outputEntry>
      </rule>

    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram id="DMNDiagram_EWS_PEWS_005">
      <dmndi:DMNShape id="DMNShape_Decision_EWS_PEWS_005" dmnElementRef="Decision_EWS_PEWS_005">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>

</definitions>
