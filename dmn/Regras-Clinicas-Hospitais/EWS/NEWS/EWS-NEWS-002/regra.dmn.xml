<?xml version="1.0" encoding="UTF-8"?>
<!--
  ============================================================================
  EWS-NEWS-002: NEWS2 Single Parameter Score 3 (Red Flag)
  ============================================================================
-->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/"
             id="Definitions_EWS_NEWS_002"
             name="NEWS2 Red Flag Parameter"
             targetNamespace="http://camunda.org/schema/1.0/dmn">

  <decision id="Decision_EWS_NEWS_002" name="NEWS2 Single Parameter Extremes">
    <decisionTable id="DecisionTable_EWS_NEWS_002" hitPolicy="FIRST">

      <input id="Input_1" label="Frequencia Respiratoria">
        <inputExpression id="InputExpression_1" typeRef="number">
          <text>frequenciaRespiratoria</text>
        </inputExpression>
      </input>

      <input id="Input_2" label="Saturacao O2 (%)">
        <inputExpression id="InputExpression_2" typeRef="number">
          <text>saturacaoO2</text>
        </inputExpression>
      </input>

      <input id="Input_3" label="Pressao Sistolica (mmHg)">
        <inputExpression id="InputExpression_3" typeRef="number">
          <text>pressaoSistolica</text>
        </inputExpression>
      </input>

      <input id="Input_4" label="Frequencia Cardiaca (bpm)">
        <inputExpression id="InputExpression_4" typeRef="number">
          <text>frequenciaCardiaca</text>
        </inputExpression>
      </input>

      <input id="Input_5" label="Nivel Consciencia">
        <inputExpression id="InputExpression_5" typeRef="string">
          <text>nivelConsciencia</text>
        </inputExpression>
        <inputValues id="InputValues_5">
          <text>"Alert", "V", "P", "U"</text>
        </inputValues>
      </input>

      <output id="Output_1" label="Nivel Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="OutputValues_1">
          <text>"Alerta", "Atencao", "Informativo", "OK", "Revisar"</text>
        </outputValues>
      </output>

      <output id="Output_2" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="OutputValues_2">
          <text>"IMEDIATA", "URGENTE", "ROTINA", "INFORMATIVA"</text>
        </outputValues>
      </output>

      <output id="Output_3" label="Acao Requerida" name="acaoRequerida" typeRef="string"/>

      <output id="Output_4" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string"/>

      <!-- CRITICAL: Respiratory Rate ≤8 or ≥25 -->
      <rule id="Rule_RR_Critical">
        <description>Extreme respiratory rate (3 points)</description>
        <inputEntry id="InputEntry_1_1">
          <text>&lt;= 8</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_1_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_1_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_3">
          <text>"FR ≤8 rpm indica BRADIPNEIA CRITICA. Avaliacao imediata. Verificar nivel consciencia, overdose opioide, lesao neurologica. Considerar suporte ventilatario. Gasometria arterial urgente."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_1_4">
          <text>"Bradipneia severa (≤8 rpm) associada a hipoventilacao alveolar, hipercapnia, risco de parada respiratoria. Mortalidade 24h aumentada em 4.2x (RCP 2017)."</text>
        </outputEntry>
      </rule>

      <rule id="Rule_RR_Tachypnea">
        <description>Severe tachypnea (3 points)</description>
        <inputEntry id="InputEntry_2_1">
          <text>&gt;= 25</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_2_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_2_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_3">
          <text>"FR ≥25 rpm indica TAQUIPNEIA SEVERA. Investigar sepse, insuficiencia respiratoria, acidose metabolica, dor, ansiedade. RX torax + gasometria. Considerar O2 suplementar."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_2_4">
          <text>"Taquipneia ≥25 rpm e preditor independente de desfecho adverso (OR 2.8). Indica compensacao de hipoxemia, acidose ou aumento de demanda metabolica."</text>
        </outputEntry>
      </rule>

      <!-- CRITICAL: SpO2 ≤91% -->
      <rule id="Rule_SpO2_Critical">
        <description>Severe hypoxemia (3 points)</description>
        <inputEntry id="InputEntry_3_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_2">
          <text>&lt;= 91</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_3_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_3_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_3">
          <text>"SpO2 ≤91% indica HIPOXEMIA GRAVE. Elevar FiO2 imediatamente. Gasometria arterial urgente. Investigar pneumonia, TEP, edema pulmonar, exacerbacao DPOC. Considerar suporte ventilatario."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_3_4">
          <text>"SpO2 ≤91% corresponde a PaO2 &lt;60 mmHg (insuficiencia respiratoria tipo 1). Risco de hipoxemia tecidual, arritmias, lesao orgao-alvo. Requer correcao urgente."</text>
        </outputEntry>
      </rule>

      <!-- CRITICAL: BP ≤90 or ≥220 mmHg -->
      <rule id="Rule_BP_Hypotension">
        <description>Severe hypotension (3 points)</description>
        <inputEntry id="InputEntry_4_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_3">
          <text>&lt;= 90</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_4_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_4_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_3">
          <text>"PAS ≤90 mmHg indica CHOQUE. Avaliar perfusao (enchimento capilar, diurese, lactato). Bolus cristaloide 500ml. Investigar sepse, hemorragia, IAM, TEP. Considerar vasopressores/UTI."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_4_4">
          <text>"Hipotensao ≤90 mmHg associada a hipoperfusao tecidual, disfuncao orgao, mortalidade 24h 12.4%. Requer identificacao rapida da causa e reposicao volemica/vasopressor."</text>
        </outputEntry>
      </rule>

      <rule id="Rule_BP_Hypertension">
        <description>Severe hypertension (3 points)</description>
        <inputEntry id="InputEntry_5_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_5_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_5_3">
          <text>&gt;= 220</text>
        </inputEntry>
        <inputEntry id="InputEntry_5_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_5_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_5_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_5_2">
          <text>"URGENTE"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_5_3">
          <text>"PAS ≥220 mmHg indica HIPERTENSAO SEVERA. Avaliar sinais lesao orgao-alvo (cefaleia, deficit neuro, dor toracica). ECG + RX torax. Considerar anti-hipertensivo IV se emergencia hipertensiva."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_5_4">
          <text>"Hipertensao severa (≥220 mmHg) pode indicar emergencia hipertensiva com risco AVC, disseccao aortica, encefalopatia, IAM. Requer avaliacao de lesao orgao-alvo para guiar tratamento."</text>
        </outputEntry>
      </rule>

      <!-- CRITICAL: HR ≤40 or ≥131 bpm -->
      <rule id="Rule_HR_Bradycardia">
        <description>Severe bradycardia (3 points)</description>
        <inputEntry id="InputEntry_6_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_6_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_6_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_6_4">
          <text>&lt;= 40</text>
        </inputEntry>
        <inputEntry id="InputEntry_6_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_6_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_6_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_6_3">
          <text>"FC ≤40 bpm indica BRADICARDIA SEVERA. Avaliar sinais instabilidade (hipotensao, alteracao consciencia, dor toracica). ECG 12D. Considerar atropina, marca-passo temporario. Revisar medicacoes (beta-bloqueador, amiodarona)."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_6_4">
          <text>"Bradicardia ≤40 bpm pode causar debito cardiaco inadequado, sincope, choque cardiogenico. Causas: BAV avancado, IAM inferior, intoxicacao medicamentosa, hipotireoidismo."</text>
        </outputEntry>
      </rule>

      <rule id="Rule_HR_Tachycardia">
        <description>Severe tachycardia (3 points)</description>
        <inputEntry id="InputEntry_7_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_7_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_7_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_7_4">
          <text>&gt;= 131</text>
        </inputEntry>
        <inputEntry id="InputEntry_7_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_7_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_7_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_7_3">
          <text>"FC ≥131 bpm indica TAQUICARDIA SEVERA. ECG 12D urgente para classificar ritmo (FA rapida, TSV, TV). Avaliar instabilidade hemodinamica. Investigar sepse, TEP, hipovolemia, dor. Controle de frequencia/cardioversao conforme indicacao."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_7_4">
          <text>"Taquicardia ≥131 bpm aumenta consumo miocardico O2, reduz tempo diastole (enchimento coronariano), pode precipitar isquemia/IC. Mortalidade 24h 6.8% se associada a hipotensao."</text>
        </outputEntry>
      </rule>

      <!-- CRITICAL: Altered consciousness (V/P/U) -->
      <rule id="Rule_Consciousness_Altered">
        <description>New confusion or reduced consciousness (3 points)</description>
        <inputEntry id="InputEntry_8_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_8_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_8_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_8_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_8_5">
          <text>"V", "P", "U"</text>
        </inputEntry>
        <outputEntry id="OutputEntry_8_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_8_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_8_3">
          <text>"Rebaixamento nivel consciencia detectado (V/P/U). Avaliacao neurologica urgente. Proteger via aerea. Glicemia capilar imediata. Investigar AVC, hipoglicemia, encefalopatia septica, intoxicacao, TCE. TC cranio se indicado."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_8_4">
          <text>"Alteracao aguda consciencia (Glasgow &lt;15 ou novo V/P/U) e marcador critico deterioracao. Associado a mortalidade 24h 15.3%. Indica disfuncao cerebral por hipoxia, hipotensao, sepse ou lesao SNC primaria."</text>
        </outputEntry>
      </rule>

      <!-- FALLBACK -->
      <rule id="Rule_Fallback_EWS_NEWS_002">
        <description>All parameters within non-critical ranges</description>
        <inputEntry id="InputEntry_F_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_3">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_4">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_5">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_F_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_2">
          <text>"INFORMATIVA"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_3">
          <text>"Nenhum parametro em nivel critico (score 3). Continuar monitoramento de rotina conforme protocolo NEWS2 estabelecido."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_4">
          <text>"Ausencia de parametros extremos reduz risco iminente de deterioracao. Manter vigilancia conforme score total NEWS2 e contexto clinico."</text>
        </outputEntry>
      </rule>

    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram id="DMNDiagram_EWS_NEWS_002">
      <dmndi:DMNShape id="DMNShape_Decision_EWS_NEWS_002" dmnElementRef="Decision_EWS_NEWS_002">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>

</definitions>
