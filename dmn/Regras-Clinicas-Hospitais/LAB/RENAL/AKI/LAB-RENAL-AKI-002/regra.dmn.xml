<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-RENAL-AKI-002" name="LAB-RENAL-AKI-002" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_RENAL_AKI_002" name="Progressao de IRA - Estagiamento KDIGO">
    <decisionTable id="decisionTable_LAB_RENAL_AKI_002" hitPolicy="FIRST">
      <input id="input_cr_variacao" label="Variacao Creatinina vs Basal">
        <inputExpression id="inputExpression_variacao" typeRef="number">
          <text>variacaoCrVsBasal</text>
        </inputExpression>
      </input>
      <input id="input_diurese_classe" label="Classificacao Diurese (KDIGO)">
        <inputExpression id="inputExpression_diurese" typeRef="string">
          <text>classificacaoDiureseKDIGO</text>
        </inputExpression>
      </input>
      <input id="input_necessita_trs" label="Necessita TRS">
        <inputExpression id="inputExpression_trs" typeRef="boolean">
          <text>necessitaTRS</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- AKI Stage 3 requiring RRT -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_3">
          <text>true</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"AKI_KDIGO_3_TRS"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"FALENCIA_RENAL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"IRA KDIGO estagio 3 com necessidade de TRS. Acesso para dialise. Definir modalidade: hemodialise intermitente vs CRRT (se instabilidade hemodinamica). Monitorar complicacoes: hipercalemia, acidose, sobrecarga. Nefrologista/intensivista para manejo conjunto."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"Necessidade de TRS define automaticamente AKI KDIGO estagio 3 independente de outros criterios. CRRT preferida em pacientes hemodinamicamente instaveis. Timing ideal de inicio ainda controverso, mas indicacoes absolutas nao devem ser postergadas."</text>
        </outputEntry>
      </rule>

      <!-- AKI Stage 3 by creatinine (>3x baseline or >4 mg/dL) -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>&gt;= 3.0</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_3">
          <text>false</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"AKI_KDIGO_3_CR"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"CRITICO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"IRA KDIGO estagio 3 por creatinina (>=3x basal). Avaliar indicacoes de TRS (AEIOU). Nefrologista URGENTE. Monitorar potassio, bicarbonato, volume. Investigar causa se nao conhecida. Preparar acesso para dialise preventivamente."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"AKI estagio 3 tem mortalidade hospitalar de 30-50% e alto risco de DRC residual. Intervencao intensiva pode melhorar desfechos, mas muitos pacientes ainda progridem para TRS."</text>
        </outputEntry>
      </rule>

      <!-- AKI Stage 3 by urine output (anuria/severe oliguria) -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>"ESTAGIO_3"</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_3">
          <text>false</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"AKI_KDIGO_3_DIURESE"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"ANURICO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"IRA KDIGO estagio 3 por diurese (anuria &gt;12h ou oliguria severa &gt;24h). Excluir obstrucao URGENTE (cateter, USG). Se pos-renal descartado, preparar para TRS. Anuria prolongada tem prognostico ruim para recuperacao."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"Anuria (&lt;50 ml/12h) ou oliguria &lt;0.3 ml/kg/h por &gt;24h define AKI KDIGO 3 por diurese. Obstrucao urinaria deve ser excluida pois e causa reversivel. Anuria por NTA tem recuperacao mais lenta e incerta."</text>
        </outputEntry>
      </rule>

      <!-- AKI Stage 2 -->
      <rule id="rule_004">
        <inputEntry id="inputEntry_004_1">
          <text>[2.0..3.0)</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_004_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_3">
          <text>"AKI_KDIGO_2"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_4">
          <text>"MODERADO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_5">
          <text>"IRA KDIGO estagio 2 (creatinina 2-3x basal). Risco de progressao para estagio 3. Otimizar volemia e perfusao. Suspender nefrotoxicos. Ajustar doses renais. Monitorar de perto para intervencao precoce se piorar."</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_6">
          <text>"AKI estagio 2 tem mortalidade significativa (15-25%) e risco substancial de progressao. Manejo agressivo neste estagio pode prevenir evolucao para estagio 3 e necessidade de TRS."</text>
        </outputEntry>
      </rule>

      <!-- AKI Stage 1 -->
      <rule id="rule_005">
        <inputEntry id="inputEntry_005_1">
          <text>[1.5..2.0)</text>
        </inputEntry>
        <inputEntry id="inputEntry_005_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_005_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_005_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="outputEntry_005_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_005_3">
          <text>"AKI_KDIGO_1"</text>
        </outputEntry>
        <outputEntry id="outputEntry_005_4">
          <text>"LEVE"</text>
        </outputEntry>
        <outputEntry id="outputEntry_005_5">
          <text>"IRA KDIGO estagio 1 (creatinina 1.5-2x basal ou aumento &gt;0.3 mg/dL). Identificar e remover causa. Otimizar manejo clinico. Muitos casos revertem com tratamento apropriado. Monitorar para progressao."</text>
        </outputEntry>
        <outputEntry id="outputEntry_005_6">
          <text>"AKI estagio 1 e frequentemente reversivel se causa identificada e tratada. Entretanto, mesmo AKI leve aumenta mortalidade hospitalar e risco de DRC a longo prazo."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"Parametros nao atendem criterio de IRA KDIGO desta regra."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra classifica IRA conforme criterios KDIGO (creatinina, diurese, TRS)."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
