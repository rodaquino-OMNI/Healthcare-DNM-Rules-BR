<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-ELECTRO-MG-002" name="LAB-ELECTRO-MG-002" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_ELECTRO_MG_002" name="Hipermagnesemia Critica">
    <decisionTable id="decisionTable_LAB_ELECTRO_MG_002" hitPolicy="FIRST">
      <input id="input_magnesio" label="Magnesio (mg/dL)">
        <inputExpression id="inputExpression_magnesio" typeRef="number">
          <text>magnesio</text>
        </inputExpression>
      </input>
      <input id="input_funcao_renal" label="TFG Estimada (mL/min/1.73m2)">
        <inputExpression id="inputExpression_tfg" typeRef="number">
          <text>tfgEstimada</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- Critical hypermagnesemia: Mg >4.0 mg/dL - Risk of cardiac arrest -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>&gt; 4.0</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"CRITICO_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"PERIGOSAMENTE_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"EMERGENCIA: Hipermagnesemia severa. SUSPENDER todas fontes de magnesio (anti√°cidos, laxativos, suplementos). Gluconato de calcio 1g IV em 5-10min como antagonista (estabilizador de membrana). Hidratacao + furosemida se funcao renal preservada. Considerar dialise URGENTE se DRC/IRA ou Mg &gt;6 mg/dL. Monitoramento cardiaco continuo. Suporte ventilatorio pode ser necessario."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"Hipermagnesemia severa (&gt;4 mg/dL) causa hipotensao, bradicardia, bloqueio AV, paralisia muscular incluindo respiratoria, e parada cardiaca. Calcio IV antagoniza efeitos cardiacos. Dialise e tratamento definitivo em DRC."</text>
        </outputEntry>
      </rule>

      <!-- Severe hypermagnesemia with renal failure: 3.0-4.0 mg/dL with low GFR -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>[3.0..4.0]</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>&lt; 30</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"SEVERO_DRC"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"ALTO_PROGRESSIVO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"Hipermagnesemia em paciente com DRC. SUSPENDER imediatamente todas fontes de magnesio. Alto risco de progressao. ECG. Avaliar necessidade de dialise. Calcio IV disponivel se deterioracao clinica."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"Pacientes com DRC nao excretam magnesio adequadamente. Fontes comuns: antiacidos com Mg (Mylanta), laxativos (leite de magnesia, citrato de Mg), suplementos. Suspensao da fonte e frequentemente suficiente se rim ainda funcional."</text>
        </outputEntry>
      </rule>

      <!-- Moderate hypermagnesemia: 3.0-4.0 mg/dL with preserved GFR -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>[3.0..4.0]</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>&gt;= 30</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"MODERADO_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"Hipermagnesemia moderada. SUSPENDER fontes de magnesio. Hidratacao + furosemida para aumentar excrecao renal. Monitorar reflexos (hiporreflexia e sinal precoce). ECG. Repetir magnesio em 4-6h."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"Hipermagnesemia com funcao renal preservada geralmente responde a suspensao da fonte e diurese forcada. Sintomas incluem hiporreflexia, nauseas, fraqueza. Monitorar para progressao."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"Magnesio nao atende criterio de hipermagnesemia critica desta regra."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra monitora hipermagnesemia critica com magnesio &gt;3.0 mg/dL."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
