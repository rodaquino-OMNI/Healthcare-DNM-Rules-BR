<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-ELECTRO-CA-001" name="LAB-ELECTRO-CA-001" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_ELECTRO_CA_001" name="Hipocalcemia Critica">
    <decisionTable id="decisionTable_LAB_ELECTRO_CA_001" hitPolicy="FIRST">
      <input id="input_calcio_ionizado" label="Calcio Ionizado (mmol/L)">
        <inputExpression id="inputExpression_calcio_ionizado" typeRef="number">
          <text>calcioIonizado</text>
        </inputExpression>
      </input>
      <input id="input_sintomas_neuromusculares" label="Sintomas Neuromusculares">
        <inputExpression id="inputExpression_sintomas" typeRef="boolean">
          <text>sintomasNeuromusculares</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- Critical hypocalcemia: iCa <0.8 mmol/L - High risk of tetany, seizures, arrhythmias -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>&lt; 0.8</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"CRITICO_BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"PERIGOSAMENTE_BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"EMERGENCIA: Hipocalcemia severa. Risco de tetania, convulsoes e arritmias. Gluconato de calcio 10% 10-20ml IV em 10min (1-2g). Monitoramento cardiaco continuo (QT prolongado). Verificar magnesio (hipomagnesemia impede correcao). Dosar PTH. Avaliar causa: pos-tireoidectomia, pancreatite, sindrome do osso faminto."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"Hipocalcemia severa (iCa &lt;0.8 mmol/L) causa tetania (espasmo carpopedal, Chvostek, Trousseau), laringoespasmo, convulsoes e arritmias (QT prolongado, torsades de pointes). Reposicao IV imediata e mandatoria. Magnesio deve ser corrigido concomitantemente."</text>
        </outputEntry>
      </rule>

      <!-- Severe hypocalcemia with symptoms: iCa 0.8-0.9 with neuromuscular symptoms -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>[0.8..0.9]</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>true</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"SEVERO_SINTOMATICO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"BAIXO_SINTOMATICO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"Hipocalcemia sintomatica requer tratamento IV. Gluconato de calcio 10% IV. ECG para avaliar QT. Verificar magnesio. Sinais de Chvostek/Trousseau positivos indicam irritabilidade neuromuscular significativa."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"Hipocalcemia moderada com sintomas (parestesias, espasmos, sinais de Chvostek/Trousseau) requer tratamento IV mesmo com calcio ionizado &gt;0.8. Sintomas indicam calcio funcionalmente insuficiente."</text>
        </outputEntry>
      </rule>

      <!-- Moderate hypocalcemia without symptoms: iCa 0.8-0.9 asymptomatic -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>[0.8..0.9]</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>false</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"MODERADO_BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"Hipocalcemia moderada assintomatica. Suplementacao oral pode ser suficiente. Verificar magnesio, vitamina D, PTH. ECG para avaliar intervalo QT. Monitorar para desenvolvimento de sintomas."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"Hipocalcemia moderada assintomatica pode ser tratada com suplementacao oral se paciente estavel. Investigar etiologia e corrigir deficiencias associadas (Mg, vit D)."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"Calcio ionizado nao atende criterio de hipocalcemia critica desta regra."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra monitora hipocalcemia critica com calcio ionizado &lt;0.9 mmol/L."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
