<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-ELECTRO-CA-002" name="LAB-ELECTRO-CA-002" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_ELECTRO_CA_002" name="Hipercalcemia Critica">
    <decisionTable id="decisionTable_LAB_ELECTRO_CA_002" hitPolicy="FIRST">
      <input id="input_calcio_ionizado" label="Calcio Ionizado (mmol/L)">
        <inputExpression id="inputExpression_calcio_ionizado" typeRef="number">
          <text>calcioIonizado</text>
        </inputExpression>
      </input>
      <input id="input_calcio_total" label="Calcio Total Corrigido (mg/dL)">
        <inputExpression id="inputExpression_calcio_total" typeRef="number">
          <text>calcioTotalCorrigido</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- Critical hypercalcemia: iCa >1.5 mmol/L - Hypercalcemic crisis -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>&gt; 1.5</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"CRITICO_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"PERIGOSAMENTE_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"EMERGENCIA: Crise hipercalcemica. SF 0.9% 200-300ml/h (avaliar funcao cardiaca). Furosemida apos hidratacao adequada. Calcitonina 4UI/kg SC/IM a cada 12h para efeito rapido. Bifosfonato IV (zoledronato 4mg ou pamidronato 60-90mg). ECG urgente. Investigar causa: malignidade (PTHrP), hiperparatireoidismo primario. Considerar dialise se refratario."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"Crise hipercalcemica (iCa &gt;1.5 ou Ca total &gt;14 mg/dL) causa alteracao de consciencia, arritmias (QT curto), IRA, pancreatite. Mortalidade alta sem tratamento. Hidratacao agressiva + calciurese forcada sao primeira linha. Bifosfonatos para efeito sustentado em 2-4 dias."</text>
        </outputEntry>
      </rule>

      <!-- Severe hypercalcemia by total calcium: >14 mg/dL -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>&gt; 14</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"CRITICO_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"PERIGOSAMENTE_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"EMERGENCIA: Hipercalcemia severa. Mesmo protocolo de crise hipercalcemica. Verificar se calcio esta corrigido para albumina. Dosar PTH, PTHrP, vitamina D. Investigar malignidade se PTH suprimido."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"Calcio total corrigido &gt;14 mg/dL indica hipercalcemia severa. Causas principais: malignidade (metastases osseas, PTHrP), hiperparatireoidismo primario severo, intoxicacao por vitamina D."</text>
        </outputEntry>
      </rule>

      <!-- Moderate-severe hypercalcemia: iCa 1.4-1.5 or total 12-14 -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>[1.4..1.5]</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"SEVERO_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"MUITO_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"Hipercalcemia severa. Hidratacao IV vigorosa. Monitorar funcao renal e debito urinario. ECG. Dosar PTH, fosforo. Considerar bifosfonato se nao houver resposta a hidratacao em 24-48h."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"Hipercalcemia 12-14 mg/dL frequentemente sintomatica (poliuria, constipacao, confusao). Tratamento com hidratacao geralmente eficaz, mas pode progredir para crise se causa nao tratada."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"Calcio nao atende criterio de hipercalcemia critica desta regra."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra monitora hipercalcemia critica com calcio ionizado &gt;1.4 mmol/L ou total &gt;12 mg/dL."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
