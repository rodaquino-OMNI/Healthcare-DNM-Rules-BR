<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-HEME-ANC-001" name="LAB-HEME-ANC-001" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_HEME_ANC_001" name="Neutropenia - Contagem Absoluta de Neutrofilos">
    <decisionTable id="decisionTable_LAB_HEME_ANC_001" hitPolicy="FIRST">
      <input id="input_anc" label="Contagem Absoluta de Neutrofilos (/uL)">
        <inputExpression id="inputExpression_anc" typeRef="number">
          <text>contagemAbsolutaNeutrofilos</text>
        </inputExpression>
      </input>
      <input id="input_quimioterapia" label="Em Quimioterapia">
        <inputExpression id="inputExpression_qt" typeRef="boolean">
          <text>emQuimioterapia</text>
        </inputExpression>
      </input>
      <input id="input_febre" label="Temperatura (C)">
        <inputExpression id="inputExpression_febre" typeRef="number">
          <text>temperatura</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- Profound neutropenia with fever: IDSA high-risk febrile neutropenia -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>&lt; 100</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_3">
          <text>&gt;= 38.0</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"NEUTROPENIA_PROFUNDA_FEBRIL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"CRITICO_SEPSE"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"EMERGENCIA ABSOLUTA: Neutropenia profunda febril. ATB de amplo espectro IV EM 30 MINUTOS (cefepime ou meropenem + vancomicina se mucosite/cateter/hipotensao). ALTO RISCO por escore MASCC. Internacao em isolamento. Considerar antifungico empirico se febre persistir &gt;4-7 dias. G-CSF. Culturas antes de ATB se possivel. Mortalidade &gt;10% se atraso no tratamento."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"Neutropenia profunda (ANC &lt;100/uL) com febre e alto risco MASCC. Mortalidade de 15-20% sem tratamento adequado. Janela de 30-60 minutos para ATB e critica. Cobertura para Gram-negativos incluindo Pseudomonas e mandatoria."</text>
        </outputEntry>
      </rule>

      <!-- Severe neutropenia with fever: Standard febrile neutropenia -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>[100..500]</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_3">
          <text>&gt;= 38.0</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"NEUTROPENIA_FEBRIL_QT"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"CRITICO_INFECCAO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"EMERGENCIA: Neutropenia febril pos-quimioterapia. Protocolo IDSA: ATB de amplo espectro EM 1 HORA. Estratificar risco MASCC. Se baixo risco (MASCC &gt;=21), pode considerar tratamento ambulatorial com fluoroquinolona + amoxicilina-clavulanato. Alto risco: internacao + ATB IV. G-CSF se esperada duracao prolongada."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"Neutropenia febril (ANC &lt;500 ou &lt;1000 com queda esperada) pos-quimioterapia requer ATB em 1 hora. Escore MASCC estratifica risco e define local de tratamento. Mortalidade varia de 5% (baixo risco) a 20% (alto risco)."</text>
        </outputEntry>
      </rule>

      <!-- Severe neutropenia without fever on chemotherapy -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>&lt; 500</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_3">
          <text>&lt; 38.0</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"NEUTROPENIA_SEVERA_QT"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"MUITO_BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"Neutropenia severa pos-QT sem febre. Profilaxia com fluoroquinolona se alto risco e esperada neutropenia prolongada (&gt;7 dias). Evitar procedimentos invasivos. Higiene de maos rigorosa. Orientar sinais de alarme. Monitorar temperatura a cada 4h. Qualquer febre e emergencia."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"ANC &lt;500/uL confere alto risco de infeccao bacteriana e fungica. Profilaxia antimicrobiana reduz risco de neutropenia febril em pacientes de alto risco. Educacao do paciente sobre febre e mandatoria."</text>
        </outputEntry>
      </rule>

      <!-- Moderate neutropenia: ANC 500-1000 -->
      <rule id="rule_004">
        <inputEntry id="inputEntry_004_1">
          <text>[500..1000]</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_004_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_3">
          <text>"NEUTROPENIA_MODERADA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_4">
          <text>"BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_5">
          <text>"Neutropenia moderada. Investigar causa: medicamentos, infeccoes virais, autoimune, congenita. Se em QT, monitorar para queda adicional. Evitar AINEs que mascaram febre. Precaucoes para neutropenia. Repetir hemograma em 24-48h."</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_6">
          <text>"ANC 500-1000/uL ainda confere risco aumentado de infeccao, porem menor que neutropenia severa. Vigilancia para queda adicional e mandatoria, especialmente em pacientes em tratamento mielossupressor."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"ANC nao atende criterio de neutropenia desta regra."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra monitora neutropenia com ANC &lt;1000/uL."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
