<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-HEME-HGB-001" name="LAB-HEME-HGB-001" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_HEME_HGB_001" name="Anemia Critica - Gatilho Transfusional">
    <decisionTable id="decisionTable_LAB_HEME_HGB_001" hitPolicy="FIRST">
      <input id="input_hemoglobina" label="Hemoglobina (g/dL)">
        <inputExpression id="inputExpression_hemoglobina" typeRef="number">
          <text>hemoglobina</text>
        </inputExpression>
      </input>
      <input id="input_doenca_cardiaca" label="Doenca Cardiovascular">
        <inputExpression id="inputExpression_dvc" typeRef="boolean">
          <text>doencaCardiovascular</text>
        </inputExpression>
      </input>
      <input id="input_sintomas" label="Sintomas de Anemia">
        <inputExpression id="inputExpression_sintomas" typeRef="boolean">
          <text>sintomasAnemia</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- Critical anemia: Hgb <5 g/dL - Life threatening -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>&lt; 5.0</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"CRITICO_TRANSFUSAO_URGENTE"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"RISCO_VITAL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"EMERGENCIA: Anemia severa com risco de vida. Transfusao de concentrado de hemacias IMEDIATA. Acesso venoso calibroso. Tipagem sanguinea e prova cruzada URGENTE - se instavel, liberar O negativo sem cruzar. Monitorar sinais de choque. Investigar causa: sangramento agudo, hemolise, aplasia. Se Testemunha de Jeova, discutir alternativas urgentemente."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"Hemoglobina &lt;5 g/dL e emergencia medica. Capacidade de transporte de oxigenio criticamente comprometida. Risco de insuficiencia cardiaca de alto debito, isquemia miocardica e cerebral. Mortalidade alta sem tratamento imediato."</text>
        </outputEntry>
      </rule>

      <!-- Severe anemia with cardiac disease: Hgb <7 + DCV -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>&lt; 7.0</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>true</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"GATILHO_TRANSFUSIONAL_DCV"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"MUITO_BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"Anemia severa em paciente cardiaco. GATILHO TRANSFUSIONAL. Meta Hgb &gt;8 g/dL em cardiopatas. Transfundir 1 concentrado por vez e reavaliar. Cuidado com sobrecarga volemica - considerar furosemida se IC. ECG para isquemia. Monitorar para SCA."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"Pacientes com doenca cardiovascular tem maior morbimortalidade com anemia. TRICC trial e estudos subsequentes recomendam gatilho de 8 g/dL em cardiopatas vs 7 g/dL em pacientes sem comorbidades. Anemia exacerba isquemia miocardica."</text>
        </outputEntry>
      </rule>

      <!-- Severe anemia with symptoms: Hgb <7 + symptomatic -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>&lt; 7.0</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>false</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_3">
          <text>true</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"GATILHO_TRANSFUSIONAL_SINTOMATICO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"MUITO_BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"Anemia severa sintomatica. Considerar transfusao baseada em sintomas (dispneia, taquicardia, hipotensao, fadiga incapacitante). Investigar causa. Reticulocitos para avaliar resposta medular. Se hemolise: Coombs, LDH, haptoglobina, bilirrubinas."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"Estrategia transfusional restritiva (Hgb &lt;7 g/dL) e segura na maioria dos pacientes. Porem, sintomas de anemia (dispneia, pre-sincope, angina) indicam transfusao independente do nivel de hemoglobina."</text>
        </outputEntry>
      </rule>

      <!-- Transfusion trigger: Hgb <7 without symptoms or cardiac disease -->
      <rule id="rule_004">
        <inputEntry id="inputEntry_004_1">
          <text>&lt; 7.0</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_2">
          <text>false</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_3">
          <text>false</text>
        </inputEntry>
        <outputEntry id="outputEntry_004_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_3">
          <text>"GATILHO_TRANSFUSIONAL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_4">
          <text>"BAIXO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_5">
          <text>"Atingido gatilho transfusional. Hgb &lt;7 g/dL em paciente estavel sem cardiopatia. Avaliar necessidade de transfusao caso a caso. Se sangramento agudo, transfundir. Se cronico assintomatico, pode observar e investigar causa. Ferro, B12, folato, reticulocitos."</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_6">
          <text>"TRICC trial estabeleceu que estrategia restritiva (Hgb 7 g/dL) e tao segura quanto liberal (10 g/dL) em pacientes criticos estaveis. Evitar transfusoes desnecessarias reduz riscos (infeccao, TRALI, sobrecarga)."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"Hemoglobina nao atende criterio de gatilho transfusional desta regra."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra monitora anemia critica com gatilho transfusional Hgb &lt;7 g/dL."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
