<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-HEME-HGB-002" name="LAB-HEME-HGB-002" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_HEME_HGB_002" name="Policitemia Critica">
    <decisionTable id="decisionTable_LAB_HEME_HGB_002" hitPolicy="FIRST">
      <input id="input_hemoglobina" label="Hemoglobina (g/dL)">
        <inputExpression id="inputExpression_hemoglobina" typeRef="number">
          <text>hemoglobina</text>
        </inputExpression>
      </input>
      <input id="input_hematocrito" label="Hematocrito (%)">
        <inputExpression id="inputExpression_hematocrito" typeRef="number">
          <text>hematocrito</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- Critical polycythemia: Hct >60% - Hyperviscosity emergency -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>&gt; 60</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"HIPERVISCOSIDADE"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"CRITICO_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"EMERGENCIA: Policitemia severa com risco de hiperviscosidade. FLEBOTOMIA URGENTE (remover 250-500ml sangue). Hidratacao IV concomitante. Avaliar sintomas neurologicos (cefaleia, confusao, visual) e cardiacos. Se policitemia vera conhecida: manter Hct &lt;45%. Investigar causa se desconhecida: JAK2, EPO, hipoxemia."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"Hematocrito &gt;60% causa sindrome de hiperviscosidade com alto risco de trombose arterial e venosa (AVC, IAM, TVP). Viscosidade aumenta exponencialmente acima de Hct 55%. Flebotomia e tratamento emergencial eficaz."</text>
        </outputEntry>
      </rule>

      <!-- Severe polycythemia: Hgb >18.5 (men) or Hct >52% -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>&gt; 18.5</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"POLICITEMIA_SEVERA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"MUITO_ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"Policitemia severa. Investigar causa: primaria (policitemia vera - JAK2 V617F em &gt;95%) vs secundaria (hipoxia cronica, DPOC, apneia sono, tumores produtores EPO). Flebotomia se Hct &gt;45% em PV. AAS baixa dose se PV confirmada. Hematologista para avaliacao."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"Policitemia vera e neoplasia mieloproliferativa com mutacao JAK2 em &gt;95% dos casos. Risco aumentado de eventos tromboticos. Meta de Hct &lt;45% reduz eventos cardiovasculares em 4x (estudo CYTO-PV)."</text>
        </outputEntry>
      </rule>

      <!-- Moderate polycythemia: Hct 52-60% -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>[52..60]</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"POLICITEMIA_MODERADA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"ALTO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"Policitemia moderada. Descartar desidratacao (hemoconcentracao). Se persistente, investigar causa. Dosar EPO: suprimida sugere PV; elevada sugere secundaria. Oximetria/gasometria para hipoxemia. Se tabagista, pode ser policitemia do fumante."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"Hematocrito 52-60% requer investigacao para diferenciar policitemia primaria de secundaria. Hemoconcentracao por desidratacao e causa comum e reversivel. EPO serica ajuda na diferenciacao."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"Hemoglobina/hematocrito nao atendem criterio de policitemia desta regra."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra monitora policitemia critica com Hct &gt;52% ou Hgb &gt;18.5 g/dL."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
