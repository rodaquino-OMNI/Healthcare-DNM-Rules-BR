<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-CARDIAC-TNI-002" name="LAB-CARDIAC-TNI-002" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_CARDIAC_TNI_002" name="Troponina - Variacao Dinamica">
    <decisionTable id="decisionTable_LAB_CARDIAC_TNI_002" hitPolicy="FIRST">
      <input id="input_troponina_atual" label="Troponina Atual (ng/mL)">
        <inputExpression id="inputExpression_troponina_atual" typeRef="number">
          <text>troponinaAtual</text>
        </inputExpression>
      </input>
      <input id="input_troponina_anterior" label="Troponina Anterior (ng/mL)">
        <inputExpression id="inputExpression_troponina_anterior" typeRef="number">
          <text>troponinaAnterior</text>
        </inputExpression>
      </input>
      <input id="input_intervalo_horas" label="Intervalo Entre Dosagens (h)">
        <inputExpression id="inputExpression_intervalo" typeRef="number">
          <text>intervaloHoras</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- Rapid significant rise: >50% increase in 1-3h (high sensitivity protocol) -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>&gt; 0.05</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>&lt; 0.03</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_3">
          <text>[1..3]</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"CURVA_ASCENDENTE_RAPIDA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"IAM_AGUDO_PROVAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"PADRAO RULE-IN: Variacao dinamica positiva em curto intervalo indica IAM agudo. Tratar como SCA. ECG urgente. Cardiologista IMEDIATO. Iniciar protocolo de SCA completo: antiagregacao + anticoagulacao. Estratificar para cinecoronariografia."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"Algoritmo de rule-in rapido (0/1h ou 0/3h): variacao absoluta significativa (depende do ensaio, tipicamente delta &gt;3-5 ng/L para hs-TnT ou &gt;6 ng/L para hs-TnI) em curto intervalo indica IAM com VPP &gt;95%."</text>
        </outputEntry>
      </rule>

      <!-- Significant delta in 3-6h (standard protocol) -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>&gt; 0.04</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>&lt; 0.02</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_3">
          <text>[3..6]</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"CURVA_ASCENDENTE"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"IAM_AGUDO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"Curva de troponina ascendente &gt;20% em 3-6h indica evento agudo. Alta probabilidade de IAM. Protocolo completo de SCA. Estratificacao de risco. Cinecoronariografia conforme risco (GRACE score)."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"Variacao &gt;20% entre troponinas seriadas (3-6h) e criterio diagnostico de IAM agudo quando pelo menos um valor esta acima do percentil 99. Curva ascendente diferencia evento agudo de elevacao cronica."</text>
        </outputEntry>
      </rule>

      <!-- Stable elevated troponin: Chronic elevation -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>&gt; 0.04</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>&gt; 0.03</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"TROPONINA_CRONICAMENTE_ELEVADA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"ESTAVEL_ELEVADO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"Troponina elevada mas estavel (variacao &lt;20%). Provavel elevacao cronica: DRC, IC cronica, cardiopatia estrutural. Nao exclui evento agudo sobreposto. Correlacionar com clinica. Se duvida, continuar seriando."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"Troponina cronicamente elevada ocorre em DRC (clearance reduzido), IC cronica (stress parietal), fibrilacao atrial. Variacao &lt;20% sugere estabilidade, mas contexto clinico pode indicar evento agudo sobreposto."</text>
        </outputEntry>
      </rule>

      <!-- Falling troponin: Post-peak -->
      <rule id="rule_004">
        <inputEntry id="inputEntry_004_1">
          <text>&gt; 0.01</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_2">
          <text>&gt; 0.05</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_004_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_2">
          <text>"MEDIA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_3">
          <text>"CURVA_DESCENDENTE"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_4">
          <text>"POS_PICO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_5">
          <text>"Troponina em queda - fase pos-pico de IAM. Confirma evento agudo previa. Continuar tratamento de SCA. Monitorar para re-elevacao (extensao de infarto ou reinfarto). Planejar estratificacao invasiva se nao realizada."</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_6">
          <text>"Curva descendente de troponina confirma evento agudo com pico ja atingido. Meia-vida da troponina e 2-4h, porem clearance completo pode levar 1-2 semanas. Re-elevacao sugere novo evento ou extensao."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"Variacao de troponina nao atende criterio desta regra."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra analisa a dinamica da curva de troponina para diferenciacao de eventos agudos."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
