<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:biodi="http://bpmn.io/schema/dmn/biodi/2.0" id="definitions_LAB-CARDIAC-DDIMER-001" name="LAB-CARDIAC-DDIMER-001" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="decision_LAB_CARDIAC_DDIMER_001" name="D-Dimero Elevado - Tromboembolismo">
    <decisionTable id="decisionTable_LAB_CARDIAC_DDIMER_001" hitPolicy="FIRST">
      <input id="input_ddimero" label="D-Dimero (ng/mL FEU)">
        <inputExpression id="inputExpression_ddimero" typeRef="number">
          <text>dDimero</text>
        </inputExpression>
      </input>
      <input id="input_idade" label="Idade (anos)">
        <inputExpression id="inputExpression_idade" typeRef="number">
          <text>idade</text>
        </inputExpression>
      </input>
      <input id="input_probabilidade_pre_teste" label="Probabilidade Pre-Teste (Wells/Geneva)">
        <inputExpression id="inputExpression_probabilidade" typeRef="string">
          <text>probabilidadePreTeste</text>
        </inputExpression>
      </input>

      <output id="output_nivelAlerta" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="outputValues_nivelAlerta">
          <text>"Alerta","Atencao","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" label="Urgencia" name="urgencia" typeRef="string">
        <outputValues id="outputValues_urgencia">
          <text>"IMEDIATA","ALTA","MEDIA","BAIXA"</text>
        </outputValues>
      </output>
      <output id="output_classificacao" label="Classificacao" name="classificacao" typeRef="string" />
      <output id="output_tendencia" label="Tendencia" name="tendencia" typeRef="string" />
      <output id="output_acaoRequerida" label="Acao Requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" label="Justificativa Cientifica" name="justificativaCientifica" typeRef="string" />

      <!-- Very high D-dimer with high probability: TEP/TVP very likely -->
      <rule id="rule_001">
        <inputEntry id="inputEntry_001_1">
          <text>&gt; 4000</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_001_3">
          <text>"ALTA"</text>
        </inputEntry>
        <outputEntry id="outputEntry_001_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_2">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_3">
          <text>"TEP_TVP_MUITO_PROVAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_4">
          <text>"CRITICO_TROMBOTICO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_5">
          <text>"EMERGENCIA: D-dimero muito elevado + alta probabilidade clinica. Iniciar anticoagulacao ANTES de exame de imagem se nao contraindicado. AngioTC de torax URGENTE para TEP. Se suspeita de TVP: doppler venoso. Se TEP macico/instavel: considerar trombolise. Se contraindicado imagem, tratar empiricamente."</text>
        </outputEntry>
        <outputEntry id="outputEntry_001_6">
          <text>"D-dimero &gt;4000 ng/mL em contexto de alta probabilidade pre-teste (Wells &gt;6 ou Geneva &gt;11) tem VPP &gt;90% para TEP/TVP. Anticoagulacao empirica enquanto aguarda imagem e segura e recomendada."</text>
        </outputEntry>
      </rule>

      <!-- Elevated D-dimer with intermediate probability: Imaging required -->
      <rule id="rule_002">
        <inputEntry id="inputEntry_002_1">
          <text>&gt; 500</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_002_3">
          <text>"INTERMEDIARIA"</text>
        </inputEntry>
        <outputEntry id="outputEntry_002_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_3">
          <text>"IMAGEM_NECESSARIA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_4">
          <text>"SUSPEITA_TEP"</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_5">
          <text>"D-dimero positivo com probabilidade intermediaria. AngioTC de torax indicada para exclusao de TEP. Se contraindicada (alergia, DRC, gestante): cintilografia V/Q ou doppler MMII. Considerar anticoagulacao empirica se atraso no exame."</text>
        </outputEntry>
        <outputEntry id="outputEntry_002_6">
          <text>"D-dimero positivo em probabilidade intermediaria requer exame de imagem para confirmar/excluir TEP. VPN do D-dimero negativo e excelente, mas VPP de D-dimero positivo e moderado."</text>
        </outputEntry>
      </rule>

      <!-- Age-adjusted D-dimer: Using age x 10 cutoff for >50 years -->
      <rule id="rule_003">
        <inputEntry id="inputEntry_003_1">
          <text>&gt; 500</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_2">
          <text>&gt; 50</text>
        </inputEntry>
        <inputEntry id="inputEntry_003_3">
          <text>"BAIXA"</text>
        </inputEntry>
        <outputEntry id="outputEntry_003_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_2">
          <text>"MEDIA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_3">
          <text>"AVALIAR_AJUSTE_IDADE"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_4">
          <text>"FALSO_POSITIVO_POSSIVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_5">
          <text>"D-dimero positivo mas probabilidade baixa + idade &gt;50. Aplicar corte ajustado para idade (idade x 10 ng/mL). Se abaixo do corte ajustado: TEP improvavel, considerar outras causas. Se acima: prosseguir com imagem."</text>
        </outputEntry>
        <outputEntry id="outputEntry_003_6">
          <text>"Corte ajustado para idade (idade x 10 ng/mL para &gt;50 anos) aumenta especificidade sem perder sensibilidade. Ex: paciente 70 anos, corte = 700 ng/mL. Reduz exames de imagem desnecessarios em idosos."</text>
        </outputEntry>
      </rule>

      <!-- Very high D-dimer, any context: Investigate -->
      <rule id="rule_004">
        <inputEntry id="inputEntry_004_1">
          <text>&gt; 2000</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_004_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_004_1">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_2">
          <text>"ALTA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_3">
          <text>"DDIMERO_MUITO_ELEVADO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_4">
          <text>"INVESTIGAR"</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_5">
          <text>"D-dimero muito elevado. Considerar: TEP/TVP, CIVD, disseccao aortica, pos-operatorio, cancer, sepse, trauma. Se contexto clinico sugere TEP: imagem. Se contexto sugere CIVD: coagulograma completo, fibrinogenio, plaquetas."</text>
        </outputEntry>
        <outputEntry id="outputEntry_004_6">
          <text>"D-dimero &gt;2000 ng/mL e altamente inespecifico mas indica ativacao significativa da coagulacao/fibrinolise. Correlacao clinica essencial. Em CIVD, valores podem exceder 10.000."</text>
        </outputEntry>
      </rule>

      <!-- Fallback -->
      <rule id="rule_fallback">
        <inputEntry id="inputEntry_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="inputEntry_fallback_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="outputEntry_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_2">
          <text>"BAIXA"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_3">
          <text>"FORA_CRITERIO"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_4">
          <text>"NAO_APLICAVEL"</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_5">
          <text>"D-dimero nao atende criterio desta regra ou foi excluido por probabilidade baixa."</text>
        </outputEntry>
        <outputEntry id="outputEntry_fallback_6">
          <text>"Esta regra avalia D-dimero no contexto de suspeita de TEP/TVP usando escores de probabilidade."</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
