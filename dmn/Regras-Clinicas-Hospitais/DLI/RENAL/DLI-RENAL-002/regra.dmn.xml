<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/"
             xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/"
             xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/"
             id="Definitions_DLI_RENAL_002"
             name="Alerta: Metformina em Insuficiencia Renal Moderada"
             targetNamespace="http://camunda.org/schema/1.0/dmn">

  <!--
    ═══════════════════════════════════════════════════════════════════════════
    DLI-RENAL-002 - Metformina + CrCl 30-45 mL/min
    Versao: 1.0.0 (2026-02-06)
    Categoria: Alerta Drug-Lab Interaction
    ═══════════════════════════════════════════════════════════════════════════

    AJUSTE DE DOSE NECESSARIO:
    - CrCl 30-45: Reduzir dose para maximo 1000 mg/dia
    - Monitorar funcao renal a cada 3 meses
    - Considerar suspensao se declinio progressivo

    REFERENCIAS:
    - FDA Metformin Label 2016
    - UpToDate: Metformin dosing in renal impairment
    ═══════════════════════════════════════════════════════════════════════════
  -->

  <decision id="Decision_DLI_RENAL_002" name="Ajustar Metformina em DRC Moderada">
    <decisionTable id="DecisionTable_DLI_RENAL_002" hitPolicy="FIRST">

      <input id="Input_1" label="Medicamento Atual">
        <inputExpression id="InputExpression_1" typeRef="string">
          <text>medicamentoAtual</text>
        </inputExpression>
      </input>

      <input id="Input_2" label="Clearance Creatinina (mL/min)">
        <inputExpression id="InputExpression_2" typeRef="number">
          <text>clearanceCreatinina</text>
        </inputExpression>
      </input>

      <input id="Input_3" label="Funcao Renal">
        <inputExpression id="InputExpression_3" typeRef="string">
          <text>funcaoRenal</text>
        </inputExpression>
      </input>

      <output id="Output_1" label="Nivel de Alerta" name="nivelAlerta" typeRef="string">
        <outputValues id="OutputValues_1">
          <text>"Informativo", "Atencao", "Alerta", "Alerta"</text>
        </outputValues>
      </output>

      <output id="Output_2" label="Ajuste Recomendado" name="ajusteDoseRecomendado" typeRef="string"/>
      <output id="Output_3" label="Dose Maxima Segura (mg/dia)" name="doseMaximaSegura" typeRef="number"/>
      <output id="Output_4" label="Frequencia Recomendada" name="frequenciaRecomendada" typeRef="string"/>
      <output id="Output_5" label="Monitoramento Requerido" name="monitoramentoRequerido" typeRef="string"/>

      <!-- ALERTA: CrCl 30-45 requer reducao de dose -->
      <rule id="Rule_Alerta_1">
        <description>Metformina em CrCl 30-45: Reduzir dose para maximo 1000 mg/dia</description>
        <inputEntry id="InputEntry_A1_1">
          <text>"METFORMINA", "CLORIDRATO_METFORMINA", "GLIFAGE", "GLUCOFORMIN"</text>
        </inputEntry>
        <inputEntry id="InputEntry_A1_2">
          <text>[30..45]</text>
        </inputEntry>
        <inputEntry id="InputEntry_A1_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_A1_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A1_2">
          <text>"REDUZIR DOSE METFORMINA - Maximo 1000 mg/dia em DRC Moderada (CrCl 30-45). Dividir em 2 tomadas. Monitorar funcao renal a cada 3 meses."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A1_3">
          <text>1000</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A1_4">
          <text>"500 mg 12/12h (maximo 1000 mg/dia)"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A1_5">
          <text>"Creatinina, CrCl a cada 3 meses. Suspender se CrCl &lt;30."</text>
        </outputEntry>
      </rule>

      <rule id="Rule_Alerta_2">
        <description>Metformina em funcao renal MODERADA</description>
        <inputEntry id="InputEntry_A2_1">
          <text>"METFORMINA", "CLORIDRATO_METFORMINA", "GLIFAGE", "GLUCOFORMIN"</text>
        </inputEntry>
        <inputEntry id="InputEntry_A2_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_A2_3">
          <text>"MODERADA"</text>
        </inputEntry>
        <outputEntry id="OutputEntry_A2_1">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A2_2">
          <text>"AJUSTAR DOSE METFORMINA - DRC Moderada requer maximo 1000 mg/dia. Monitorar funcao renal trimestralmente."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A2_3">
          <text>1000</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A2_4">
          <text>"500 mg 12/12h"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_A2_5">
          <text>"Funcao renal a cada 3 meses"</text>
        </outputEntry>
      </rule>

      <!-- FALLBACK -->
      <rule id="Rule_Fallback_DLI_RENAL_002">
        <description>Sem ajuste necessario</description>
        <inputEntry id="InputEntry_F_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="InputEntry_F_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="OutputEntry_F_1">
          <text>"Informativo"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_2">
          <text>"Sem ajuste necessario."</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_3">
          <text>null</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_4">
          <text>"Conforme prescricao"</text>
        </outputEntry>
        <outputEntry id="OutputEntry_F_5">
          <text>"Rotina"</text>
        </outputEntry>
      </rule>

    </decisionTable>
  </decision>

  <dmndi:DMNDI>
    <dmndi:DMNDiagram id="DMNDiagram_DLI_RENAL_002">
      <dmndi:DMNShape id="DMNShape_Decision_DLI_RENAL_002" dmnElementRef="Decision_DLI_RENAL_002">
        <dc:Bounds height="80" width="180" x="160" y="100"/>
      </dmndi:DMNShape>
    </dmndi:DMNDiagram>
  </dmndi:DMNDI>

</definitions>
