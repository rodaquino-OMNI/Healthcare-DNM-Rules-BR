<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="DDI_BLEED_018" name="DDI-BLEED-018: Ginkgo + Antiplaquetários" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="ddi_bleed_018_decision" name="Ginkgo + Antiplatelets Bleeding Risk">
    <decisionTable id="ddi_bleed_018_table" hitPolicy="FIRST">
      <input id="input_medicamentos_ativos" label="Medicamentos Ativos">
        <inputExpression id="input_expr_medicamentos_ativos" typeRef="string">
          <text>medicamentosAtivos</text>
        </inputExpression>
      </input>
      <input id="input_suplemento_novo" label="Suplemento Novo">
        <inputExpression id="input_expr_suplemento" typeRef="string">
          <text>suplementoNovo</text>
        </inputExpression>
      </input>
      <input id="input_idade" label="Idade (anos)">
        <inputExpression id="input_expr_idade" typeRef="number">
          <text>idade</text>
        </inputExpression>
      </input>

      <output id="output_nivel_alerta" name="nivelAlerta" typeRef="string">
        <outputValues>
          <text>"Alerta","Atencao","Informativo","OK"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" name="urgencia" typeRef="string">
        <outputValues>
          <text>"IMEDIATA","URGENTE","ROTINA"</text>
        </outputValues>
      </output>
      <output id="output_medicamentos_conflitantes" name="medicamentosConflitantes" typeRef="string" />
      <output id="output_mecanismo_interacao" name="mecanismoInteracao" typeRef="string" />
      <output id="output_acao_requerida" name="acaoRequerida" typeRef="string" />

      <!-- Rule 1: Ginkgo + Antiplaquetário em idosos ≥65 anos -->
      <rule id="rule_ginkgo_antipl_idoso">
        <inputEntry id="input_medicamentos_antipl">
          <text>list contains(medicamentosAtivos, "ASPIRINA") or list contains(medicamentosAtivos, "AAS") or list contains(medicamentosAtivos, "CLOPIDOGREL") or list contains(medicamentosAtivos, "PRASUGREL") or list contains(medicamentosAtivos, "TICAGRELOR")</text>
        </inputEntry>
        <inputEntry id="input_novo_ginkgo">
          <text>"GINKGO BILOBA" or "GINKGO"</text>
        </inputEntry>
        <inputEntry id="input_idade_alta">
          <text>&gt;= 65</text>
        </inputEntry>
        <outputEntry id="output_alerta_idoso">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="output_urgencia_idoso">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="output_conflitantes_idoso">
          <text>"Ginkgo biloba + Antiplaquetário (idade ≥65 anos)"</text>
        </outputEntry>
        <outputEntry id="output_mecanismo_idoso">
          <text>"RISCO MODERADO: Ginkgo biloba inibe PAF (fator ativação plaquetária) via ginkgolídeos → disfunção agregação plaquetária LEVE-MODERADA. Relatos casos sangramento ESPONTÂNEO (hifema, hemorragia subdural, hemorragia intracraniana) em idosos ginkgo + antiplaquetários. Risco MAIOR em ≥65 anos (fragilidade vascular cerebral, múltiplos medicamentos). Evidência FRACA (relatos caso, sem trials randomizados), mas CAUTELA justificada dado gravidade potencial (sangramento intracraniano)."</text>
        </outputEntry>
        <outputEntry id="output_acao_idoso">
          <text>"EVITAR ginkgo em idosos com antiplaquetários: (1) DESCONTINUAR ginkgo (benefício cognitivo NÃO comprovado - GEM trial negativo), (2) Se paciente insiste: educar risco sangramento, monitorar sinais (cefaleia, alteração visão, hematomas), (3) CONTRAINDICAR se história sangramento intracraniano prévio, (4) Alternativas memória: estimulação cognitiva, exercício físico, controle fatores risco vascular (HAS, diabetes). Nota: ginkgo NÃO previne demência (evidência NÍVEL 1)."</text>
        </outputEntry>
      </rule>

      <!-- Rule 2: Ginkgo + Antiplaquetário em adultos <65 anos -->
      <rule id="rule_ginkgo_antipl_adulto">
        <inputEntry id="input_medicamentos_antipl_ad">
          <text>list contains(medicamentosAtivos, "ASPIRINA") or list contains(medicamentosAtivos, "AAS") or list contains(medicamentosAtivos, "CLOPIDOGREL") or list contains(medicamentosAtivos, "PRASUGREL") or list contains(medicamentosAtivos, "TICAGRELOR")</text>
        </inputEntry>
        <inputEntry id="input_novo_ginkgo_ad">
          <text>"GINKGO BILOBA" or "GINKGO"</text>
        </inputEntry>
        <inputEntry id="input_idade_normal">
          <text>&lt; 65</text>
        </inputEntry>
        <outputEntry id="output_alerta_adulto">
          <text>"Atencao"</text>
        </outputEntry>
        <outputEntry id="output_urgencia_adulto">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="output_conflitantes_adulto">
          <text>"Ginkgo biloba + Antiplaquetário"</text>
        </outputEntry>
        <outputEntry id="output_mecanismo_adulto">
          <text>"Risco sangramento BAIXO-MODERADO: Ginkgo inibe PAF (fator ativação plaquetária) → disfunção plaquetária discreta. Relatos casos sangramento ESPONTÂNEO raros mas GRAVES (hifema ocular, hemorragia subdural). Evidência limitada a relatos caso."</text>
        </outputEntry>
        <outputEntry id="output_acao_adulto">
          <text>"DESENCORAJAR uso ginkgo: (1) Benefício cognitivo NÃO comprovado (GEM, GuidAge trials negativos), (2) Risco sangramento espontâneo raro mas GRAVE (intracraniano), (3) Se paciente usa: educar sinais sangramento (cefaleia súbita, alteração visual, hematomas espontâneos), (4) Suspender 7-14 dias ANTES cirurgia/procedimento invasivo, (5) Alternativa: estimulação cognitiva, exercício aeróbico (benefício cognitivo COMPROVADO)."</text>
        </outputEntry>
      </rule>

      <!-- Fallback Rule -->
      <rule id="rule_fallback">
        <inputEntry id="input_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="input_fallback_2">
          <text>-</text>
        </inputEntry>
        <inputEntry id="input_fallback_3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="output_fallback_1">
          <text>"OK"</text>
        </outputEntry>
        <outputEntry id="output_fallback_2">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="output_fallback_3">
          <text>""</text>
        </outputEntry>
        <outputEntry id="output_fallback_4">
          <text>""</text>
        </outputEntry>
        <outputEntry id="output_fallback_5">
          <text>""</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
