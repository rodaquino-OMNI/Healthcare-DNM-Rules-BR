<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="DDI_CONTRAIND_004" name="DDI-CONTRAIND-004: Ergotamínicos + Macrolídeos" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="ddi_contraind_004_decision" name="Ergotamínicos + Macrolídeos Interaction">
    <decisionTable id="ddi_contraind_004_table" hitPolicy="FIRST">
      <input id="input_medicamentos_ativos" label="Medicamentos Ativos">
        <inputExpression id="input_expr_medicamentos_ativos" typeRef="string">
          <text>medicamentosAtivos</text>
        </inputExpression>
      </input>
      <input id="input_medicamento_novo" label="Medicamento Novo">
        <inputExpression id="input_expr_medicamento_novo" typeRef="string">
          <text>medicamentoNovo</text>
        </inputExpression>
      </input>

      <output id="output_nivel_alerta" name="nivelAlerta" typeRef="string">
        <outputValues>
          <text>"Alerta","Atencao","Informativo"</text>
        </outputValues>
      </output>
      <output id="output_urgencia" name="urgencia" typeRef="string">
        <outputValues>
          <text>"IMEDIATA","URGENTE","ROTINA"</text>
        </outputValues>
      </output>
      <output id="output_medicamentos_conflitantes" name="medicamentosConflitantes" typeRef="string" />
      <output id="output_mecanismo_interacao" name="mecanismoInteracao" typeRef="string" />
      <output id="output_acao_requerida" name="acaoRequerida" typeRef="string" />

      <!-- Rule 1: Ergotamínicos + Macrolídeos inibidores CYP3A4 -->
      <rule id="rule_ergot_macro">
        <inputEntry id="input_medicamentos_ergot">
          <text>list contains(medicamentosAtivos, "ERGOTAMINA") or list contains(medicamentosAtivos, "DIHIDROERGOTAMINA") or list contains(medicamentosAtivos, "ERGONOVINA") or list contains(medicamentosAtivos, "METILERGONOVINA")</text>
        </inputEntry>
        <inputEntry id="input_novo_macro">
          <text>"ERITROMICINA" or "CLARITROMICINA" or "AZITROMICINA"</text>
        </inputEntry>
        <outputEntry id="output_alerta_ergot">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="output_urgencia_ergot">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="output_conflitantes_ergot">
          <text>"Ergotaminico + Macrolideo"</text>
        </outputEntry>
        <outputEntry id="output_mecanismo_ergot">
          <text>"Macrolideos inibem CYP3A4 = acumulo MASSIVO ergot = VASOSPASMO SEVERO (ergotismo): isquemia extremidades, angina, AVC, isquemia mesenterica. RISCO AMPUTACAO."</text>
        </outputEntry>
        <outputEntry id="output_acao_ergot">
          <text>"CONTRAINDICADO ABSOLUTO: Suspender macrolideo IMEDIATAMENTE. Alternativas: doxiciclina, fluoroquinolona. Se sinais ergotismo (cianose, dor extremidades, parestesia), nitroglicerina IV + bloqueador canal calcio. Casos amputacao reportados."</text>
        </outputEntry>
      </rule>

      <!-- Rule 2: Macrolídeos em uso + prescrição ergotamínico -->
      <rule id="rule_macro_ergot">
        <inputEntry id="input_medicamentos_macro">
          <text>list contains(medicamentosAtivos, "ERITROMICINA") or list contains(medicamentosAtivos, "CLARITROMICINA") or list contains(medicamentosAtivos, "AZITROMICINA")</text>
        </inputEntry>
        <inputEntry id="input_novo_ergot">
          <text>"ERGOTAMINA" or "DIHIDROERGOTAMINA" or "ERGONOVINA" or "METILERGONOVINA"</text>
        </inputEntry>
        <outputEntry id="output_alerta_macro">
          <text>"Alerta"</text>
        </outputEntry>
        <outputEntry id="output_urgencia_macro">
          <text>"IMEDIATA"</text>
        </outputEntry>
        <outputEntry id="output_conflitantes_macro">
          <text>"Macrolideo ativo + Ergotaminico prescrito"</text>
        </outputEntry>
        <outputEntry id="output_mecanismo_macro">
          <text>"Inibicao CYP3A4 ja estabelecida = primeira dose ergot pode causar vasospasmo"</text>
        </outputEntry>
        <outputEntry id="output_acao_macro">
          <text>"CONTRAINDICADO: Substituir antibiotico (doxiciclina, quinolona) ANTES ergotaminico. Se enxaqueca aguda refrataria: triptanos (sumatriptano SC), AINES, dexametasona. Aguardar 72h washout macrolideo."</text>
        </outputEntry>
      </rule>

      <!-- Fallback Rule -->
      <rule id="rule_fallback">
        <inputEntry id="input_fallback_1">
          <text>-</text>
        </inputEntry>
        <inputEntry id="input_fallback_2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="output_fallback_1">
          <text>"Informativo"</text>
        </outputEntry>
        <outputEntry id="output_fallback_2">
          <text>"ROTINA"</text>
        </outputEntry>
        <outputEntry id="output_fallback_3">
          <text>""</text>
        </outputEntry>
        <outputEntry id="output_fallback_4">
          <text>""</text>
        </outputEntry>
        <outputEntry id="output_fallback_5">
          <text>""</text>
        </outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
