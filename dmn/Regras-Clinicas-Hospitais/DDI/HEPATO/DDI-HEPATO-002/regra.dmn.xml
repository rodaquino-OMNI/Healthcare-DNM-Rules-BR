<?xml version="1.0" encoding="UTF-8"?>
<!-- ============================================================================
     DDI-HEPATO-002: Metotrexato + Alcool/Hepatotoxicos - Fibrose Hepatica

     EVIDENCIA CLINICA:
     - ACR Guidelines for MTX in Rheumatoid Arthritis
     - Kremer JM et al. Arthritis Rheum. 1994;37:316-28
     - Whiting-O'Keefe QE et al. Arthritis Rheum. 1991;34:1121-31

     MECANISMO: MTX causa hepatotoxicidade dose-cumulativa (esteatose, fibrose,
     cirrose). Alcool potencializa via estresse oxidativo hepatico. Dose
     cumulativa >1.5g associada a fibrose significativa.

     INCIDENCIA: Fibrose hepatica em 15-30% com MTX cronico + alcool
     ============================================================================ -->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="DDI_HEPATO_002" name="DDI-HEPATO-002: Metotrexato + Alcool" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="ddi_hepato_002_decision" name="Metotrexato + Alcool/Hepatotoxicos - Fibrose Hepatica">
    <decisionTable id="ddi_hepato_002_table" hitPolicy="FIRST">
      <input id="input_medicamentos_ativos" label="Medicamentos Ativos">
        <inputExpression id="input_expr_medicamentos" typeRef="string">
          <text>medicamentosAtivos</text>
        </inputExpression>
      </input>
      <input id="input_consumo_alcool" label="Consumo Alcool Semanal">
        <inputExpression id="input_expr_alcool" typeRef="string">
          <text>consumoAlcoolSemanal</text>
        </inputExpression>
      </input>
      <input id="input_dose_cumulativa_mtx" label="Dose Cumulativa MTX (g)">
        <inputExpression id="input_expr_dose" typeRef="number">
          <text>doseCumulativaMTX</text>
        </inputExpression>
      </input>

      <output id="output_nivel_alerta" name="nivelAlerta" typeRef="string">
        <outputValues><text>"Alerta","Atencao","Informativo","OK"</text></outputValues>
      </output>
      <output id="output_acao_requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" name="justificativaCientifica" typeRef="string" />

      <!-- Rule 1: MTX + Alcool moderado/pesado + dose cumulativa alta -->
      <rule id="rule_mtx_alcool_alto">
        <inputEntry id="ie_mtx_ativo">
          <text>list contains(medicamentosAtivos, "METOTREXATO") or list contains(medicamentosAtivos, "MTX")</text>
        </inputEntry>
        <inputEntry id="ie_alcool_alto">
          <text>"MODERADO" or "PESADO" or "ABUSIVO"</text>
        </inputEntry>
        <inputEntry id="ie_dose_alta">
          <text>&gt; 1.5</text>
        </inputEntry>
        <outputEntry id="oe_alerta_alto"><text>"Alerta"</text></outputEntry>
        <outputEntry id="oe_acao_alto"><text>"CONTRAINDICADO uso concomitante. Dose cumulativa MTX >1.5g + alcool = alto risco fibrose/cirrose. SUSPENDER ALCOOL completamente. Considerar biopsia hepatica ou elastografia. Monitorar TGO/TGP, albumina, INR a cada 4-8 semanas."</text></outputEntry>
        <outputEntry id="oe_just_alto"><text>"MTX + alcool sinergismo hepatotoxico. Fibrose em 15-30%. ACR recomenda abstinencia. Kremer JM, Arthritis Rheum 1994."</text></outputEntry>
      </rule>

      <!-- Rule 2: MTX + Alcool leve -->
      <rule id="rule_mtx_alcool_leve">
        <inputEntry id="ie_mtx_ativo2">
          <text>list contains(medicamentosAtivos, "METOTREXATO") or list contains(medicamentosAtivos, "MTX")</text>
        </inputEntry>
        <inputEntry id="ie_alcool_leve">
          <text>"LEVE" or "OCASIONAL"</text>
        </inputEntry>
        <inputEntry id="ie_dose_any">
          <text>-</text>
        </inputEntry>
        <outputEntry id="oe_atencao_leve"><text>"Atencao"</text></outputEntry>
        <outputEntry id="oe_acao_leve"><text>"Orientar abstinencia ou reducao maxima de alcool. Alguns guidelines permitem ate 7 unidades/semana em baixo risco, mas abstinencia e preferivel. Monitorar funcao hepatica a cada 4-8 semanas."</text></outputEntry>
        <outputEntry id="oe_just_leve"><text>"Mesmo consumo leve aumenta risco hepatotoxicidade com MTX. ACR recomenda limitar ao minimo."</text></outputEntry>
      </rule>

      <!-- Rule 3: MTX + Outro hepatotoxico -->
      <rule id="rule_mtx_hepatotoxico">
        <inputEntry id="ie_mtx_ativo3">
          <text>list contains(medicamentosAtivos, "METOTREXATO") or list contains(medicamentosAtivos, "MTX")</text>
        </inputEntry>
        <inputEntry id="ie_outro_hepato">
          <text>"LEFLUNOMIDA" or "AZATIOPRINA" or "ISONIAZIDA" or "RIFAMPICINA"</text>
        </inputEntry>
        <inputEntry id="ie_dose_any2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="oe_atencao_hepato"><text>"Atencao"</text></outputEntry>
        <outputEntry id="oe_acao_hepato"><text>"Combinacao hepatotoxica. Monitorar TGO/TGP a cada 2-4 semanas no inicio. Se elevacao >2x LSN, suspender um dos agentes. Preferir monoterapia ou combinacoes menos hepatotóxicas."</text></outputEntry>
        <outputEntry id="oe_just_hepato"><text>"Combinacao de hepatotóxicos potencializa lesao. Requer monitorizacao intensificada."</text></outputEntry>
      </rule>

      <!-- Fallback Rule -->
      <rule id="Rule_Fallback">
        <inputEntry id="ie_fallback1"><text>-</text></inputEntry>
        <inputEntry id="ie_fallback2"><text>-</text></inputEntry>
        <inputEntry id="ie_fallback3"><text>-</text></inputEntry>
        <outputEntry id="oe_fallback1"><text>"OK"</text></outputEntry>
        <outputEntry id="oe_fallback2"><text>""</text></outputEntry>
        <outputEntry id="oe_fallback3"><text>""</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
