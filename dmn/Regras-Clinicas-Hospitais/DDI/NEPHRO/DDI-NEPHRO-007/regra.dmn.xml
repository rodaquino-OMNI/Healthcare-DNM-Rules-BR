<?xml version="1.0" encoding="UTF-8"?>
<!-- ============================================================================
     DDI-NEPHRO-007: Tacrolimus + Aminoglicosideos - Nefrotoxicidade Sinergica

     EVIDENCIA CLINICA:
     - KDIGO Clinical Practice Guideline for CKD
     - Naesens M et al. Kidney Int. 2009;75:1019-34
     - Staatz CE, Tett SE. Clin Pharmacokinet. 2004;43:623-53

     MECANISMO: Tacrolimus causa nefrotoxicidade por vasoconstriccao aferente,
     toxicidade tubular e fibrose intersticial cronica. Aminoglicosideos
     adicionam toxicidade tubular proximal direta. Combinacao potencializa IRA.

     INCIDENCIA: IRA aguda em 20-30% dos transplantados em uso de ambos
     ============================================================================ -->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="DDI_NEPHRO_007" name="DDI-NEPHRO-007: Tacrolimus + Aminoglicosideos" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="ddi_nephro_007_decision" name="Tacrolimus + Aminoglicosideos - Nefrotoxicidade Sinergica">
    <decisionTable id="ddi_nephro_007_table" hitPolicy="FIRST">
      <input id="input_medicamentos_ativos" label="Medicamentos Ativos">
        <inputExpression id="input_expr_medicamentos" typeRef="string">
          <text>medicamentosAtivos</text>
        </inputExpression>
      </input>
      <input id="input_medicamento_novo" label="Medicamento Novo">
        <inputExpression id="input_expr_novo" typeRef="string">
          <text>medicamentoNovo</text>
        </inputExpression>
      </input>
      <input id="input_nivel_tacrolimus" label="Nivel Serico Tacrolimus (ng/mL)">
        <inputExpression id="input_expr_nivel" typeRef="number">
          <text>nivelTacrolimus</text>
        </inputExpression>
      </input>

      <output id="output_nivel_alerta" name="nivelAlerta" typeRef="string">
        <outputValues><text>"Alerta","Atencao","Informativo","OK"</text></outputValues>
      </output>
      <output id="output_acao_requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" name="justificativaCientifica" typeRef="string" />

      <!-- Rule 1: Tacrolimus + Aminoglicosideo + nivel alto -->
      <rule id="rule_tacro_amino_alto">
        <inputEntry id="ie_tacrolimus_ativo">
          <text>list contains(medicamentosAtivos, "TACROLIMUS")</text>
        </inputEntry>
        <inputEntry id="ie_amino_novo">
          <text>"GENTAMICINA" or "AMICACINA" or "TOBRAMICINA" or "ESTREPTOMICINA"</text>
        </inputEntry>
        <inputEntry id="ie_nivel_alto">
          <text>&gt; 15</text>
        </inputEntry>
        <outputEntry id="oe_alerta_alto"><text>"Alerta"</text></outputEntry>
        <outputEntry id="oe_acao_alto"><text>"EVITAR AMINOGLICOSIDEO. Nivel tacrolimus >15ng/mL = nefrotoxicidade iminente. Usar antibiotico alternativo (cefepime, piperacilina-tazobactam, fluoroquinolona). Se aminoglicosideo vital, reduzir dose tacrolimus, hidratar intensivamente, monitorar creatinina diariamente."</text></outputEntry>
        <outputEntry id="oe_just_alto"><text>"Tacrolimus elevado + aminoglicosideo = risco IRA >40%. Naesens M, Kidney Int 2009."</text></outputEntry>
      </rule>

      <!-- Rule 2: Tacrolimus + Aminoglicosideo + nivel terapeutico -->
      <rule id="rule_tacro_amino_normal">
        <inputEntry id="ie_tacrolimus_ativo2">
          <text>list contains(medicamentosAtivos, "TACROLIMUS")</text>
        </inputEntry>
        <inputEntry id="ie_amino_novo2">
          <text>"GENTAMICINA" or "AMICACINA" or "TOBRAMICINA"</text>
        </inputEntry>
        <inputEntry id="ie_nivel_normal">
          <text>[5..15]</text>
        </inputEntry>
        <outputEntry id="oe_atencao_normal"><text>"Atencao"</text></outputEntry>
        <outputEntry id="oe_acao_normal"><text>"Preferir antibiotico alternativo. Se aminoglicosideo necessario: dose unica diaria, monitorar creatinina e nivel tacrolimus a cada 48h, hidratar com SF 1-2L/dia, repor K/Mg. Evitar uso >5 dias."</text></outputEntry>
        <outputEntry id="oe_just_normal"><text>"Risco nefrotoxicidade moderado (20-25%). Monitorizacao intensiva permite uso cauteloso. KDIGO Guidelines."</text></outputEntry>
      </rule>

      <!-- Rule 3: Aminoglicosideo em uso + Tacrolimus novo -->
      <rule id="rule_amino_tacrolimus">
        <inputEntry id="ie_amino_ativo">
          <text>list contains(medicamentosAtivos, "GENTAMICINA") or list contains(medicamentosAtivos, "AMICACINA") or list contains(medicamentosAtivos, "TOBRAMICINA")</text>
        </inputEntry>
        <inputEntry id="ie_tacrolimus_novo">
          <text>"TACROLIMUS"</text>
        </inputEntry>
        <inputEntry id="ie_nivel_any">
          <text>-</text>
        </inputEntry>
        <outputEntry id="oe_atencao_tacro"><text>"Atencao"</text></outputEntry>
        <outputEntry id="oe_acao_tacro"><text>"Aguardar clareamento aminoglicosideo (24-48h) antes de iniciar tacrolimus se possivel. Se urgente, iniciar tacrolimus com dose reduzida e monitorar niveis e funcao renal de perto."</text></outputEntry>
        <outputEntry id="oe_just_tacro"><text>"Iniciar imunossupressor nefrotoxicidade durante aminoglicosideo aumenta IRA precoce no pos-transplante."</text></outputEntry>
      </rule>

      <!-- Fallback Rule -->
      <rule id="Rule_Fallback">
        <inputEntry id="ie_fallback1"><text>-</text></inputEntry>
        <inputEntry id="ie_fallback2"><text>-</text></inputEntry>
        <inputEntry id="ie_fallback3"><text>-</text></inputEntry>
        <outputEntry id="oe_fallback1"><text>"OK"</text></outputEntry>
        <outputEntry id="oe_fallback2"><text>""</text></outputEntry>
        <outputEntry id="oe_fallback3"><text>""</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
