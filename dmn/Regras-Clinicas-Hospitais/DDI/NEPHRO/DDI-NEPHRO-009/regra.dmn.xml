<?xml version="1.0" encoding="UTF-8"?>
<!-- ============================================================================
     DDI-NEPHRO-009: Aciclovir + Nefrotoxicos - Cristaluria e IRA

     EVIDENCIA CLINICA:
     - Micromedex Drug Interactions
     - Perazella MA. Am J Kidney Dis. 2005;46:1095-9
     - Izzedine H et al. Kidney Int. 2005;67:2089-2100

     MECANISMO: Aciclovir/Valaciclovir precipitam em tubulos renais (cristaluria),
     especialmente com desidratacao ou infusao rapida. Combinacao com outros
     nefrotoxicos (AINEs, aminoglicosideos) aumenta risco de IRA obstrutiva/tubular.

     INCIDENCIA: IRA em 5-12% com aciclovir isolado; ate 25% com combinacao
     ============================================================================ -->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="DDI_NEPHRO_009" name="DDI-NEPHRO-009: Aciclovir + Nefrotoxicos" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="ddi_nephro_009_decision" name="Aciclovir + Nefrotoxicos - Cristaluria e IRA">
    <decisionTable id="ddi_nephro_009_table" hitPolicy="FIRST">
      <input id="input_medicamentos_ativos" label="Medicamentos Ativos">
        <inputExpression id="input_expr_medicamentos" typeRef="string">
          <text>medicamentosAtivos</text>
        </inputExpression>
      </input>
      <input id="input_medicamento_novo" label="Medicamento Novo">
        <inputExpression id="input_expr_novo" typeRef="string">
          <text>medicamentoNovo</text>
        </inputExpression>
      </input>
      <input id="input_via_administracao" label="Via de Administracao">
        <inputExpression id="input_expr_via" typeRef="string">
          <text>viaAdministracao</text>
        </inputExpression>
      </input>

      <output id="output_nivel_alerta" name="nivelAlerta" typeRef="string">
        <outputValues><text>"Alerta","Atencao","Informativo","OK"</text></outputValues>
      </output>
      <output id="output_acao_requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" name="justificativaCientifica" typeRef="string" />

      <!-- Rule 1: Aciclovir IV + Outro nefrotóxico -->
      <rule id="rule_aciclovir_iv_nefro">
        <inputEntry id="ie_aciclovir_ativo">
          <text>list contains(medicamentosAtivos, "ACICLOVIR") or list contains(medicamentosAtivos, "VALACICLOVIR")</text>
        </inputEntry>
        <inputEntry id="ie_nefro_novo">
          <text>"GENTAMICINA" or "AMICACINA" or "VANCOMICINA" or "ANFOTERICINA_B" or "CISPLATINA" or "CONTRASTE_IODADO"</text>
        </inputEntry>
        <inputEntry id="ie_via_iv">
          <text>"IV" or "INTRAVENOSA"</text>
        </inputEntry>
        <outputEntry id="oe_alerta_iv"><text>"Alerta"</text></outputEntry>
        <outputEntry id="oe_acao_iv"><text>"ALTO RISCO IRA. Aciclovir IV + nefrotóxico = cristaluria + toxicidade tubular. Hidratar vigorosamente (2-3L/dia), infundir aciclovir lentamente (>1h), ajustar dose para funcao renal, monitorar creatinina diariamente. Considerar alternativa se possivel."</text></outputEntry>
        <outputEntry id="oe_just_iv"><text>"Aciclovir IV precipita em tubulos. Com outro nefrotóxico, risco IRA 20-25%. Perazella MA, Am J Kidney Dis 2005."</text></outputEntry>
      </rule>

      <!-- Rule 2: Aciclovir VO + Nefrotóxico -->
      <rule id="rule_aciclovir_vo_nefro">
        <inputEntry id="ie_aciclovir_ativo2">
          <text>list contains(medicamentosAtivos, "ACICLOVIR") or list contains(medicamentosAtivos, "VALACICLOVIR")</text>
        </inputEntry>
        <inputEntry id="ie_nefro_novo2">
          <text>"GENTAMICINA" or "AMICACINA" or "VANCOMICINA" or "ANFOTERICINA_B" or "IBUPROFENO" or "DICLOFENACO"</text>
        </inputEntry>
        <inputEntry id="ie_via_vo">
          <text>"VO" or "ORAL"</text>
        </inputEntry>
        <outputEntry id="oe_atencao_vo"><text>"Atencao"</text></outputEntry>
        <outputEntry id="oe_acao_vo"><text>"Risco moderado IRA. Garantir hidratacao adequada (>2L/dia), ajustar dose aciclovir para TFG, monitorar creatinina em 48-72h. Evitar AINEs se possivel. Se ambos necessarios, usar por menor tempo."</text></outputEntry>
        <outputEntry id="oe_just_vo"><text>"Aciclovir oral tem menor risco cristaluria, mas combinacao com nefrotóxicos requer vigilância. Izzedine H, Kidney Int 2005."</text></outputEntry>
      </rule>

      <!-- Rule 3: Nefrotóxico ativo + Aciclovir novo -->
      <rule id="rule_nefro_aciclovir">
        <inputEntry id="ie_nefro_ativo">
          <text>list contains(medicamentosAtivos, "VANCOMICINA") or list contains(medicamentosAtivos, "GENTAMICINA") or list contains(medicamentosAtivos, "ANFOTERICINA_B")</text>
        </inputEntry>
        <inputEntry id="ie_aciclovir_novo">
          <text>"ACICLOVIR" or "VALACICLOVIR"</text>
        </inputEntry>
        <inputEntry id="ie_via_any">
          <text>-</text>
        </inputEntry>
        <outputEntry id="oe_atencao_aci"><text>"Atencao"</text></outputEntry>
        <outputEntry id="oe_acao_aci"><text>"Paciente ja em nefrotóxico. Iniciar aciclovir com hidratacao previa (SF 500mL), infundir lentamente se IV, ajustar dose para TFG atual. Monitorar funcao renal diariamente durante primeiros 5 dias."</text></outputEntry>
        <outputEntry id="oe_just_aci"><text>"Adicao de aciclovir a paciente em nefrotóxico aumenta carga renal. Prevencao com hidratacao e infusao lenta."</text></outputEntry>
      </rule>

      <!-- Fallback Rule -->
      <rule id="Rule_Fallback">
        <inputEntry id="ie_fallback1"><text>-</text></inputEntry>
        <inputEntry id="ie_fallback2"><text>-</text></inputEntry>
        <inputEntry id="ie_fallback3"><text>-</text></inputEntry>
        <outputEntry id="oe_fallback1"><text>"OK"</text></outputEntry>
        <outputEntry id="oe_fallback2"><text>""</text></outputEntry>
        <outputEntry id="oe_fallback3"><text>""</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
