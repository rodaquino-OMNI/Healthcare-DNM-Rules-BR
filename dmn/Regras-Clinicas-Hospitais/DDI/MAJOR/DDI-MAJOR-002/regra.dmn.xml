<?xml version="1.0" encoding="UTF-8"?>
<!-- ============================================================================
     DDI-MAJOR-002: Digoxina + Amiodarona/Verapamil - Toxicidade Digitalica

     EVIDENCIA CLINICA:
     - Micromedex: Major Interaction
     - Nademanee K et al. Ann Intern Med. 1984;101:676-80
     - Moysey JO et al. Br Med J. 1981;282:272

     MECANISMO: Amiodarona e verapamil inibem P-glicoproteina e reduzem clearance
     renal de digoxina, aumentando nivel serico 70-100%. Risco de arritmias
     (bradicardia, BAV, TV) e sintomas GI.

     INCIDENCIA: Toxicidade digitalica em 25-35% sem ajuste de dose
     ============================================================================ -->
<definitions xmlns="https://www.omg.org/spec/DMN/20191111/MODEL/" xmlns:dmndi="https://www.omg.org/spec/DMN/20191111/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" id="DDI_MAJOR_002" name="DDI-MAJOR-002: Digoxina + Amiodarona/Verapamil" namespace="http://camunda.org/schema/1.0/dmn">
  <decision id="ddi_major_002_decision" name="Digoxina + Amiodarona/Verapamil - Toxicidade Digitalica">
    <decisionTable id="ddi_major_002_table" hitPolicy="FIRST">
      <input id="input_medicamentos_ativos" label="Medicamentos Ativos">
        <inputExpression id="input_expr_medicamentos" typeRef="string">
          <text>medicamentosAtivos</text>
        </inputExpression>
      </input>
      <input id="input_medicamento_novo" label="Medicamento Novo">
        <inputExpression id="input_expr_novo" typeRef="string">
          <text>medicamentoNovo</text>
        </inputExpression>
      </input>
      <input id="input_nivel_digoxina" label="Nivel Serico Digoxina (ng/mL)">
        <inputExpression id="input_expr_nivel" typeRef="number">
          <text>nivelDigoxina</text>
        </inputExpression>
      </input>

      <output id="output_nivel_alerta" name="nivelAlerta" typeRef="string">
        <outputValues><text>"Alerta","Atencao","Informativo","OK"</text></outputValues>
      </output>
      <output id="output_acao_requerida" name="acaoRequerida" typeRef="string" />
      <output id="output_justificativa" name="justificativaCientifica" typeRef="string" />

      <!-- Rule 1: Digoxina + Amiodarona -->
      <rule id="rule_digoxina_amiodarona">
        <inputEntry id="ie_digoxina_ativa">
          <text>list contains(medicamentosAtivos, "DIGOXINA")</text>
        </inputEntry>
        <inputEntry id="ie_amiodarona_nova">
          <text>"AMIODARONA"</text>
        </inputEntry>
        <inputEntry id="ie_nivel_any">
          <text>-</text>
        </inputEntry>
        <outputEntry id="oe_alerta_amio"><text>"Alerta"</text></outputEntry>
        <outputEntry id="oe_acao_amio"><text>"REDUZIR DIGOXINA 50% imediatamente. Amiodarona aumenta nivel digoxina 70-100%. Dosar digoxinemia em 7 dias. Alvo&lt; 1.0 ng/mL em IC. Monitorar ECG (bradicardia, BAV). Vigiar nausea, visao amarelada."</text></outputEntry>
        <outputEntry id="oe_just_amio"><text>"Amiodarona inibe P-gp e clearance renal. Aumento digoxina consistente e significativo. Nademanee K, Ann Intern Med 1984."</text></outputEntry>
      </rule>

      <!-- Rule 2: Digoxina + Verapamil -->
      <rule id="rule_digoxina_verapamil">
        <inputEntry id="ie_digoxina_ativa2">
          <text>list contains(medicamentosAtivos, "DIGOXINA")</text>
        </inputEntry>
        <inputEntry id="ie_verapamil_novo">
          <text>"VERAPAMIL"</text>
        </inputEntry>
        <inputEntry id="ie_nivel_any2">
          <text>-</text>
        </inputEntry>
        <outputEntry id="oe_alerta_verap"><text>"Alerta"</text></outputEntry>
        <outputEntry id="oe_acao_verap"><text>"REDUZIR DIGOXINA 25-50%. Verapamil aumenta digoxina 50-75% e ambos deprimem conducao AV. ALTO RISCO bradicardia/BAV. Dosar digoxinemia em 5-7 dias. ECG basal e em 7 dias. Considerar diltiazem como alternativa (menor interacao)."</text></outputEntry>
        <outputEntry id="oe_just_verap"><text>"Verapamil inibe P-gp e tem efeito aditivo na conducao AV. Moysey JO, Br Med J 1981."</text></outputEntry>
      </rule>

      <!-- Rule 3: Digoxina + Quinidina -->
      <rule id="rule_digoxina_quinidina">
        <inputEntry id="ie_digoxina_ativa3">
          <text>list contains(medicamentosAtivos, "DIGOXINA")</text>
        </inputEntry>
        <inputEntry id="ie_quinidina_nova">
          <text>"QUINIDINA"</text>
        </inputEntry>
        <inputEntry id="ie_nivel_any3">
          <text>-</text>
        </inputEntry>
        <outputEntry id="oe_alerta_quin"><text>"Alerta"</text></outputEntry>
        <outputEntry id="oe_acao_quin"><text>"REDUZIR DIGOXINA 50%. Quinidina aumenta digoxina ~100% (dobra nivel). Dosar digoxinemia em 5-7 dias. ECG para monitorar QT e arritmias."</text></outputEntry>
        <outputEntry id="oe_just_quin"><text>"Interacao classica digoxina-quinidina. Deslocamento proteico + inibicao P-gp."</text></outputEntry>
      </rule>

      <!-- Rule 4: Amiodarona ativa + Digoxina nova -->
      <rule id="rule_amio_digoxina">
        <inputEntry id="ie_amio_ativa">
          <text>list contains(medicamentosAtivos, "AMIODARONA")</text>
        </inputEntry>
        <inputEntry id="ie_digoxina_nova">
          <text>"DIGOXINA"</text>
        </inputEntry>
        <inputEntry id="ie_nivel_na">
          <text>-</text>
        </inputEntry>
        <outputEntry id="oe_atencao_dig"><text>"Atencao"</text></outputEntry>
        <outputEntry id="oe_acao_dig"><text>"Iniciar digoxina com METADE da dose usual (ex: 0.125mg em vez de 0.25mg). Dosar nivel em 7 dias. Titular baseado em digoxinemia (&lt; 1.0 ng/mL) e resposta clinica."</text></outputEntry>
        <outputEntry id="oe_just_dig"><text>"Paciente em amiodarona requer dose inicial reduzida de digoxina."</text></outputEntry>
      </rule>

      <!-- Fallback Rule -->
      <rule id="Rule_Fallback">
        <inputEntry id="ie_fallback1"><text>-</text></inputEntry>
        <inputEntry id="ie_fallback2"><text>-</text></inputEntry>
        <inputEntry id="ie_fallback3"><text>-</text></inputEntry>
        <outputEntry id="oe_fallback1"><text>"OK"</text></outputEntry>
        <outputEntry id="oe_fallback2"><text>""</text></outputEntry>
        <outputEntry id="oe_fallback3"><text>""</text></outputEntry>
      </rule>
    </decisionTable>
  </decision>
</definitions>
